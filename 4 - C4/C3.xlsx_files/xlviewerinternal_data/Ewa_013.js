/*! Version=16.0.9321.5050 */
Type.registerNamespace("Common.App.CollabControls");Common.App.CollabControls.i=function(){};Common.App.CollabControls.i.registerInterface("Common.App.CollabControls.i");Common.App.CollabControls.a=function(){};Common.App.CollabControls.a.prototype={multipleBrowsersImageClassName:0,peopleImageClassName:1,peopleImageClusterPath:4,multipleBrowserImageClusterPath:5,imageDimension:6,rtl:8,pointerInputManager:9,clickInputManager:10,vertical:11,zIndex:12,contextMenuInputManager:13,imageDomElement:14};Common.App.CollabControls.a.registerEnum("Common.App.CollabControls.a",!1);Common.App.CollabControls.h=function(n){this.v=Function.createDelegate(this,this.Z);Common.App.CollabControls.h.initializeBase(this);this.o=n};Common.App.CollabControls.h.a=function(n,t){return n+(t?"Rtl":"")};Common.App.CollabControls.h.prototype={o:null,bg:function(){return this.o},F:function(){return this.o.style.visibility==="visible"},z:function(n){return this.o.style.visibility=n?"visible":"hidden",n},Y:function(n){return this.o.dir=n?"rtl":"ltr",n},dispose:function(){this.o&&this.o.parentNode&&this.o.parentNode.removeChild(this.o);this.o=null;Common.J.prototype.dispose.call(this)},G:function(n){return this.o.ownerDocument.createElement(n)},Z:function(){return!0}};Common.App.CollabControls.c=function(n,t){Common.App.CollabControls.c.initializeBase(this);this.a=n;this.b=t};Common.App.CollabControls.c.prototype={a:0,b:null};Common.App.CollabControls.b=function(n,t,i){var u,r;for(this.H=Function.createDelegate(this,this.bd),this.s=[],this.p=[],Common.App.CollabControls.b.resolveInheritance(),this.e=this.bg,Common.App.CollabControls.b.initializeBase(this,[n]),this.B={},this.J=i,this.y=i.a(Boolean,8),this.x=i.a(Boolean,11),u=i.a(Number,12),this.w=i.a(Number,6),this.K=t,this.o.id=Common.App.CollabControls.b.b(),this.o.className=Common.App.CollabControls.h.a("prControl",this.y),u&&(this.o.style.zIndex=u),this.Y(this.y),this.bf(t),this.t=this.G("div"),this.t.className=this.x?"prContainerV":"prContainerHr",this.o.appendChild(this.t),this.q=new Array(this.u),r=0;r<this.u;r++)this.q[r]=new Common.App.CollabControls.d(this.G("div"),this.J),this.q[r].l(this.H),this.o.appendChild(this.q[r].o)};Common.App.CollabControls.b.b=function(){return String.format("{0}-{1}","presencetooltip",Common.App.CollabControls.b.a++)};Common.App.CollabControls.b.c=function(n){var t=n.a.rawEvent,i=t.relatedTarget;return i||t.toElement};Common.App.CollabControls.b.prototype={t:null,u:0,y:!1,A:!1,x:!1,C:!1,K:0,J:null,B:null,f:function(){return Common.bI.c(this.s)},q:null,I:null,w:0,ba:function(){return this.x?this.w+2:this.K},U:function(){return this.x?this.K:this.w+2},c:function(n){this.n("InteractivityChanged",n)},b:function(n){this.r("InteractivityChanged",n)},dispose:function(){var t;if(this.q)for(var i=this.q,r=i.length,n=0;n<r;++n)t=i[n],t.u(this.H),System.a.a(t);System.a.b(this.p);this.q=null;this.p=null;Common.App.CollabControls.h.prototype.dispose.call(this)},k:function(){this.D();this.O();this.z(!0);this.A=!1},j:function(){!this.p||this.p.length<1||(this.D(),this.z(!0),this.O(),this.L(this.p[this.p.length-1],0),this.A=!0)},W:function(){var t,r;if(this.p&&!(this.p.length<1)){this.z(!0);this.O();t=0;for(var i=this.p,u=i.length,n=0;n<u;++n)r=i[n],this.L(r,t++);this.A=!1;this.C=!0}},g:function(){this.z(!1);this.D();for(var n=0;n<this.p.length;n++)this.p[n].q();this.A=!1},R:function(){var n,r;if(!this.C)return!1;n=0;for(var i=this.q,u=i.length,t=0;t<u;++t)r=i[t],r.F()&&n++;return this.C=n>0&&(this.s.length<=this.u?n===this.s.length:n===this.u),this.C},a:function(n){var r,u,f,t,i;if(!(this.u<=0)){if(n.i||(n.i=(Common.App.CollabControls.b.a++).toString()),n.i in this.B&&(r=this.T(n.i),r>=0)){if(u=this.s[r],u.l===n.l&&u.k===n.k)return;this.i(n.i)}f=this.R();i=0;this.s.length<this.u?(t=new Common.App.CollabControls.e(this.G("div"),this.J,n),t.t(this.H),this.y&&!this.x&&this.s.length>0?this.t.insertBefore(t.o,this.t.firstChild):(this.t.appendChild(t.o),i=this.p.length),Array.add(this.p,t)):(this.y&&!this.x?t=this.p[0]:(i=this.p.length-1,t=this.p[i]),t.l(n));t.s();this.B[n.i]=t;Array.add(this.s,n);this.X(t,i);f&&this.W()}},i:function(n){var t=this.R();t&&this.D();this.V(n);this.s.length>=this.u&&this.p.length<this.u&&this.be();this.s.length<=0?this.g():t&&this.W()},V:function(n){var r=this.T(n),i,t;r<0||(i=this.s[r],Array.removeAt(this.s,r),t=this.B[i.i],delete this.B[i.i],t.C(i.i),this.X(t,0),t.a.length<=0&&(this.t.removeChild(t.o),Array.remove(this.p,t),t.dispose()))},be:function(){var t=this.bb(),n,i,r;!t||t.a.length<=1||(n=Array.clone(this.s),i=this,Array.forEach(n,function(n){i.V(n.i)}),r=this,Array.forEach(n,function(n){r.a(n)}))},T:function(n){for(var t=0;t<this.s.length;t++)if(this.s[t].i===n)return t;return-1},bb:function(){return this.y&&!this.x?this.p[0]:this.p[this.p.length-1]},h:function(n,t){for(var u,f,i,e,r=0;r<this.p.length;r++)if(u=this.p[r],f=this.Q(Common.f.a(u.o),t,this.y),u.F()&&Common.f.b(f,n))return!0;for(i=0;i<this.u;i++)if(this.q[i]&&this.q[i].F()&&(e=this.Q(Common.f.a(this.q[i].o),t,!this.y),Common.f.b(e,n)))return!0;return!1},Q:function(n,t,i){var r=n.height+2*t,u=n.width+t,f=n.y-t,e=i?n.x:n.x-t;return new Sys.UI.Bounds(e,f,u,r)},l:function(n,t){this.o.style.top=t+"px";this.o.style.left=n+"px"},O:function(){for(var n=0;n<this.p.length;n++)this.p[n].s()},D:function(){for(var n=0;n<this.u;n++)this.q[n].c();this.C=!1},L:function(n,t){var r,u,i;if(n)if(this.I=n,this.x)if(r=this.w,n.a.length>1)this.q[t].j(n.a,r,this.U()-this.w);else for(u=this.t.children.length,i=0;i<this.t.children.length;i++)n.o===this.t.children[i]&&this.q[t].j(n.a,r,this.U()-(u-i)*(this.w+2)+2);else this.q[t].j(n.a,this.ba(),0)},bd:function(n,t){var i=$$as(Common.App.CollabControls.e,n),r=i?this.S(i):-1;if(t.a!==2&&(t.a!==1||r===-1||this.q[r].F())){if(t.a===1)this.D(),this.A=!1;else if(t.a===3){if(this.d(t.b))return;this.A||this.D()}}else this.L(n,0);this.m("InteractivityChanged",t,null)},d:function(n){for(var f,t=Common.App.CollabControls.b.c(n),r=!1,u=this.q,e=u.length,i=0;i<e;++i)if(f=u[i],Common.i.n(f.o,t)){r=!0;break}return this.t!==t&&Common.i.n(this.t,t)||r},X:function(n,t){var i=this.bc(n);i&&n.a.length<=0?this.q[t].c():i?this.L(n,0):this.q[t].c()},S:function(n){for(var u,i=0,r=this.p,f=r.length,t=0;t<f;++t){if(u=r[t],n===u)return i;i++}return-1},bc:function(n){var t=this.S(n);return!!this.I&&n===this.I&&t!==-1&&this.q[t].F()},bf:function(n){this.u=n===this.w?1:Math.floor(n/(this.w+2));this.x?(this.o.style.height=n+"px",this.o.style.width=this.w+"px"):(this.o.style.width=n+"px",this.o.style.height=this.w+"px")}};Common.App.CollabControls.f=function(n){this.a=n;this.a.d(10,Common.h.a());this.a.d(9,Common.e.a());this.a.d(6,16);this.a.d(13,Common.Q.a())};Common.App.CollabControls.f.prototype={a:null,b:function(n){return new Common.App.CollabControls.b(n,16,this.a)}};Common.App.CollabControls.d=function(n,t){this.h=Function.createDelegate(this,this.t);this.g=Function.createDelegate(this,this.s);Common.App.CollabControls.d.initializeBase(this,[n]);this.i=t.a(Boolean,8);this.f=t.a(Number,6);this.o=n;this.o.className=Common.App.CollabControls.d.a;this.b=this.G("ul");this.o.appendChild(this.b);this.d=t.a(Common.dM,10);this.d.a("click",this.o,this.g);this.a=t.a(Common.dO,9);this.a.a("msospPointerOut",this.o,this.h);this.a.a("msospPointerDown",this.o,this.v);this.e=t.a(Common.Q,13);this.e.a(this.o,this.v)};Common.App.CollabControls.d.prototype={d:null,a:null,e:null,b:null,f:0,i:!1,l:function(n){this.n("InteractivityChanged",n)},u:function(n){this.r("InteractivityChanged",n)},k:null,dispose:function(){this.o&&(this.d.b("click",this.o,this.g),this.a.b("msospPointerDown",this.o,this.v),this.a.b("msospPointerOut",this.o,this.h),this.e.c(this.o,this.v));Common.App.CollabControls.h.prototype.dispose.call(this)},c:function(){this.z(!1)},j:function(n,t,i){(this.c(),!n||n.length<=0)||(this.i?this.o.style.right=t+"px":this.o.style.left=t+"px",this.o.style.top=i+"px",this.q(n),this.z(!0))},q:function(n){this.k=n;Common.i.g(this.b);for(var t=n.length-1;t>=0;t--)this.p(n[t])},p:function(n){var t=document.createElement("li");t.style.backgroundColor=n.l;t.style.height=this.f+"px";t.id="fly_"+n.i;t.style.lineHeight=this.f+"px";Common.i.q(t,n.k);t.setAttribute("dir","auto");this.b.appendChild(t)},s:function(){return this.c(),!1},t:function(n){return this.m("InteractivityChanged",new Common.App.CollabControls.c(3,n),null),!1}};Common.App.CollabControls.e=function(n,t,i){this.i=Function.createDelegate(this,this.y);this.j=Function.createDelegate(this,this.A);this.k=Function.createDelegate(this,this.B);this.a=[];Common.App.CollabControls.e.initializeBase(this,[n]);this.o.className="prGlyph";this.b=t;this.c=this.b.a(Common.dO,9);this.d=this.b.a(Common.dM,10);this.h=this.b.a(Common.Q,13);this.x();this.l(i);this.g=!1};Common.App.CollabControls.e.prototype={e:null,b:null,g:!0,d:null,c:null,h:null,t:function(n){this.n("InteractivityChanged",n)},dispose:function(){this.D();Common.App.CollabControls.h.prototype.dispose.call(this)},l:function(n){Array.add(this.a,n);this.a.length===2?this.f(!0):this.a.length===1?this.f(!1):this.f(this.g)},C:function(n){var t=this.u(n);t&&(this.a.length>1&&this.f(!0),this.a.length===1?this.f(!1):this.a.length<1&&this.q())},s:function(){this.f(this.a.length>=2);this.z(!0)},q:function(){this.z(!1)},w:function(n){return n?this.p(0,5):this.p(1,4)},u:function(n){for(var i,t=0;t<this.a.length;t++)if(this.a[t].i===n)return i=this.a[t],Array.removeAt(this.a,t),i;return null},f:function(n){this.g!==n&&(this.e&&this.o.removeChild(this.e),this.e=this.w(n),this.o.appendChild(this.e),this.g=n);this.e.childNodes[0].style.backgroundColor=this.a[this.a.length-1].l},p:function(n,t){var i=this.b.a(Number,6),r=this.b.a(Object,14);return Common.A.c(i,i,this.b.a(String,n),this.b.a(String,t),"cui-img-cont-float cui-img-16by16","",!1,"",this.o.ownerDocument,r?r.cloneNode(!0):null)},B:function(n){return n.b!==3&&this.m("InteractivityChanged",new Common.App.CollabControls.c(2,n),null),!1},y:function(n){return this.m("InteractivityChanged",new Common.App.CollabControls.c(1,n),null),!0},A:function(n){return n.b!==3&&this.m("InteractivityChanged",new Common.App.CollabControls.c(3,n),null),!1},D:function(){this.o&&(this.c.b("msospPointerDown",this.o,this.v),this.c.b("msospPointerOver",this.o,this.k),this.c.b("msospPointerOut",this.o,this.j),this.d.b("dblclick",this.o,this.v),this.d.b("click",this.o,this.i),this.h.c(this.o,this.v))},x:function(){this.o&&(this.c.a("msospPointerDown",this.o,this.v),this.c.a("msospPointerOver",this.o,this.k),this.c.a("msospPointerOut",this.o,this.j),this.d.a("dblclick",this.o,this.v),this.d.a("click",this.o,this.i),this.h.a(this.o,this.v))}};Common.App.CollabControls.g=function(){this.c={}};Common.App.CollabControls.g.prototype={a:function(n,t){var r=Common.App.CollabControls.a.toString(t),i;return n===Number?(i=this.c[r],i?Number.parseInvariant(i.toString()):0):this.c[r]},b:function(n,t){this.c[Common.App.CollabControls.a.toString(n)]=t},d:function(n,t){Common.App.CollabControls.a.toString(n)in this.c||(this.c[Common.App.CollabControls.a.toString(n)]=t)}};Common.App.CollabControls.h.registerClass("Common.App.CollabControls.h",Common.J,Sys.IDisposable);Common.App.CollabControls.c.registerClass("Common.App.CollabControls.c",Sys.EventArgs);Common.App.CollabControls.b.registerClass("Common.App.CollabControls.b",Common.App.CollabControls.h,Common.App.CollabControls.i,Sys.IDisposable);Common.App.CollabControls.d.registerClass("Common.App.CollabControls.d",Common.App.CollabControls.h);Common.App.CollabControls.e.registerClass("Common.App.CollabControls.e",Common.App.CollabControls.h);Common.App.CollabControls.b.a=0;Common.App.CollabControls.d.a="prFlyout UIFont";Type.registerNamespace("Common");Common.ec=function(n,t,i,r){this.b=n;this.a=t;this.d=i;this.c=r};Common.ec.a=function(n,t){return t=t||"skypeproxy.ashx",new Common.ec(new($$sc.v.$$(Common.dl))(function(){return Common.a.d}),Common.a.h,n,t)};Common.ec.prototype={b:null,a:null,d:null,c:null,g:function(){return this.b.a()},e:function(n,t){var i=this.d.a("WebServiceCall","CreateSkypeChatThread"),r=this,u=this;this.f(new Common.App.SkypeChat.l(this.a),function(t){i.a();n(t)},function(n){i.a();t(n)})},f:function(n,t,i){var r={};r["Content-Type"]="application/json; charset=utf-8";this.g().a(this.c,2,n.b(),r,!1,2,t,i,null,null,!1,null,null,null,null,!1)}};Type.registerNamespace("Common.App.SkypeChat");Common.App.SkypeChat.c=function(n,t,i){this.Email=n;this.InChat=t;this.Capabilities=i};Common.App.SkypeChat.t=function(){};Common.App.SkypeChat.t.registerInterface("Common.App.SkypeChat.t");Common.App.SkypeChat.e=function(){};Common.App.SkypeChat.e.registerInterface("Common.App.SkypeChat.e");Common.App.SkypeChat.f=function(){};Common.App.SkypeChat.f.registerInterface("Common.App.SkypeChat.f");Common.App.SkypeChat.w=function(){};Common.App.SkypeChat.v=function(){};Common.App.SkypeChat.x=function(){};Common.App.SkypeChat.n=function(){this.h=new Common.J};Common.App.SkypeChat.n.prototype={h:null,o:!1,a:function(n){this.h.n("AVCEK",n)},b:function(n){this.h.n("MPUEK",n)},p:function(n){n!==this.o&&(this.h.m("AVCEK",new Common.App.SkypeChat.b(n,!1),null),this.o=n,Diag.a.a(6603939,333,50,"Chat availability changed to now be {0}",n))},x:function(){this.h.m("MPUEK",null,null)}};Common.App.SkypeChat.o=function(){this.i=new Common.J};Common.App.SkypeChat.o.prototype={w:function(n){this.i.m("NTID_EK",new Common.eL(n),null)},b:function(n){this.i.n("NTID_EK",n)},a:function(n){this.i.n("DCD_EK",n)},x:function(){this.i.m("DCD_EK",null,null)}};Common.App.SkypeChat.b=function(n,t){Common.App.SkypeChat.b.initializeBase(this);this.b=n;this.c=t};Common.App.SkypeChat.b.prototype={b:!1,a:function(){return this.b},c:!1};Common.App.SkypeChat.g=function(n,t,i){this.e=Function.createDelegate(this,this.h);this.d=n;this.b=t;this.a=i};Common.App.SkypeChat.g.prototype={a:null,d:null,b:null,c:!1,g:function(){if(this.c){Diag.a.a(9000738,333,15,"Init called multiple times");return}this.c=!0;var n=Common.a.b.a("DocChatIsEnabled");n&&this.b.a(this.e)},h:function(n){var t=this;n.a().CW(function(){var i=n.a().a();i.a?t.f(i):i.b&&(Common.a.bu&&n.b()!==3?Diag.a.a(18121750,333,50,"DocChatBootstrapper: Anonymous Doc Chat is not available because the user name is unknown."):t.f(i))})},f:function(n){Diag.a.a(9000739,333,50,"DocChatBootStrapper: Doc chat is enabled.");this.d.a().a(Common.a.n,n);this.a&&this.a()}};Common.App.SkypeChat.a=function(n,t){this.r=Function.createDelegate(this,this.s);this.j=new Common.J;this.o=n;this.q=t};Common.App.SkypeChat.a.prototype={p:null,o:null,k:null,i:null,q:null,n:null,m:!1,l:!1,b:function(n){this.j.n("ACE",n)},g:function(){if(this.k)return this.k.a;this.k=new($$sc.A.$$(Boolean));var n=this;return this.o.CW(function(){n.p=n.o.a();n.i=n.p.a(n.r);n.i.b();n.i.c(function(t,i){n.j.m("PSC",i,null)});n.i.d(function(t,i){n.j.m("UCC",i,null)})}),this.k.a},s:function(n,t){var i=t.a===2||t.a===4||t.a===5;this.k.a.b>3||!i||this.k.f(!0);this.l=this.m&&t.a!==2&&t.a!==5;this.m=this.m&&!this.l;this.j.m("ACE",new Common.App.SkypeChat.b(i,this.l),null)},d:function(n){this.j.n("UCC",n)},a:function(){return this.i.a()?1:0},f:function(n,t,i,r){if(!n){Diag.a.a(18200789,333,10,"Unexpected attempt to join doc chat without any chat thread info!");return}this.n=this.q.b("ServerNotification","JoinSkypeChatThreadClient");var u=this,e=function(){u.n.a();u.m=!0;u.l=!1;t()},f=this,o=function(){f.n.a();f.m=!1;f.l=!1;i()};this.n.c();this.i.k(n.a,e,o,r,n.b)},e:function(){this.i.g()},h:function(){this.i.h()},c:function(n){this.j.n("PSC",n)}};Common.App.SkypeChat.d=function(n){this.b=n};Common.App.SkypeChat.d.prototype={b:null,a:function(){return this.b.a()}};Common.App.SkypeChat.q=function(n,t){this.i=Function.createDelegate(this,this.l);this.e=n;this.f=t};Common.App.SkypeChat.q.prototype={e:null,f:null,b:null,d:null,a:function(){return this.b?this.b.a:(this.b=new($$sc.A.$$(String)),this.e.CW(this.i),this.b.a)},g:function(){return $$sc.a.a(String,"")},l:function(){var n=this.e.a(),t=this;n.a().CW(function(){n.b()===3?t.b.b(Common.a.l):n.a().a().a?t.k():t.j()})},k:function(){var n=this;this.f.CW(function(){n.d=n.f.a().a(null);n.d.b().CW(function(){n.d.f().CW(function(){n.b.b(n.d.f().a())})})})},j:function(){var n=this;this.g().CW(function(){n.b.b(n.g().a())})}};Common.App.SkypeChat.p=function(n){this.BaseDocQuerySignature=n};Common.App.SkypeChat.p.prototype={BaseDocQuerySignature:null,b:function(){return JSON.stringify([this.a(),this])}};Common.App.SkypeChat.l=function(n){Common.App.SkypeChat.l.initializeBase(this,[n])};Common.App.SkypeChat.l.prototype={a:function(){return 1}};Common.App.SkypeChat.m=function(){};Common.App.SkypeChat.m.a=function(n){if(!n)return Diag.a.a(5328905,333,10,"Response from SkypeProxy was null"),null;try{return JSON.parse(n)}catch(t){Diag.a.a(5328906,333,10,"could not parse the response of request: {0}",n.substr(0,Math.min(n.length,250)))}return null};Common.App.SkypeChat.i=function(n,t,i,r,u){this.v=Function.createDelegate(this,this.E);this.u=Function.createDelegate(this,this.D);this.w=Function.createDelegate(this,this.F);this.t=Function.createDelegate(this,this.C);this.s=Function.createDelegate(this,this.B);Common.App.SkypeChat.i.initializeBase(this);this.m=n;this.i=t;this.l=i;this.n=r;this.j=u};Common.App.SkypeChat.i.prototype={e:null,f:null,m:null,i:null,l:null,j:null,k:null,n:null,r:null,g:null,q:!1,d:function(){return Diag.a.a(9000769,333,50,"Init - RtcChatAvailabilityFinder"),$$sc.a.WAA(this.n.a(),this.m,this.l,this.j,this.i).CW(this.s)},B:function(){if(Diag.a.a(6603968,333,50,"All prerequisite ready for RtcChatAvailabilityFinder"),this.e=this.m.a(),this.k=this.l.a(),this.f=this.i.a(),this.g=this.n.a().a(),this.r=this.j.a(),this.e.g(this.t),this.e.d(this.w),this.e.s(this.u),this.e.h(this.v),!this.g&&!this.f.b()){Diag.a.a(6603969,333,10,"Email in presence context is null or undefined. This will cause Skype to not work");return}this.f.h(this.f.b()||this.g);this.G(!0);this.q=!0;this.c()},G:function(n){this.I(n);this.H(n)},I:function(n){this.f&&this.k&&(n?this.f.a().b|=4:this.f.a().b&=-5,this.k.a())},H:function(n){if(this.e){var t=this.y();t&&(t.Email=this.g,t.Capabilities=n?1:0,this.e.m(1,t))}},y:function(){var n=this.e.c(1);return n&&this.e.a()in n?n[this.e.a()]:new Common.App.SkypeChat.c("",!1,0)},C:function(){this.c()},F:function(){this.c()},D:function(){this.x()},E:function(n,t){t.a===1&&this.c()},c:function(){if(!this.q)return Diag.a.a(6603970,333,50,"Anyone to chat with was called before component was initialized"),this.p(!1),!1;if(this.e.b()!==2)return Diag.a.a(6649866,333,50,"Rtc Connection not yet established: state:{0}",this.e.b()),this.p(!1),!1;var t=this.e.i(),i=this.e.c(1),n=this.A(t)||this.z(i);return this.p(n),n},A:function(n){var i,r,u,t;if(!n)return!1;i=n;for(r in i)if(u={key:r,value:i[r]},t=this.r.a(u),t&&t.b()&&t.a()&&t.a().a(4)&&t.b()!==this.g)return!0;return!1},z:function(n){var i,r,u,t;if(!n)return!1;i=n;for(r in i)if(u={key:r,value:i[r]},t=u.value,t&&t.Email&&t.Capabilities&1&&t.Email!==this.g)return!0;return!1}};Common.App.SkypeChat.u=function(n,t,i,r,u){this.L=Function.createDelegate(this,this.bm);this.O=Function.createDelegate(this,this.bs);this.G=Function.createDelegate(this,this.ba);this.N=Function.createDelegate(this,this.br);this.M=Function.createDelegate(this,this.bn);this.K=Function.createDelegate(this,this.bk);this.Q=Function.createDelegate(this,this.bv);this.P=Function.createDelegate(this,this.bu);this.I=Function.createDelegate(this,this.bd);this.S=Function.createDelegate(this,this.bx);this.J=Function.createDelegate(this,this.bf);this.T=Function.createDelegate(this,this.bz);this.H=Function.createDelegate(this,this.bb);this.R=Function.createDelegate(this,this.bw);this.c=n;this.k=i;this.i=!1;this.B=r;this.h=u;this.r=t};Common.App.SkypeChat.u.prototype={s:0,v:!1,m:!1,u:!1,i:!1,p:!1,y:!1,A:!1,w:!1,x:!1,e:!1,j:!1,f:!1,V:function(){return Common.a.b.a("DocChatJoinInfoFromServerIsEnabled")},U:function(){return Common.a.b.a("DocChatDiscoveryViaPersistentStateChannelIsEnabled")},C:null,k:null,n:null,q:null,B:null,h:null,z:!1,g:null,c:null,r:null,b:null,d:null,W:function(){return this.p&&this.A},a:function(n,t){return(this.C=n,this.q=t,this.g)?this.g.a:(this.g=new($$sc.A.$$(Boolean)),!this.r)?(Diag.a.a(8730523,333,15,"docChatClient is null"),this.g.b(!1),this.g.a):(this.bc(),this.g.a)},by:function(){Diag.a.b(5269512,333,!!this.c,null);this.c.d(Common.X.a.b,2147483648,this.R,96);this.c.a(Common.X.a.c,2147483648,this.H);this.V()?this.c.a(Common.X.a.f,2147483648,this.T):this.c.a(Common.X.a.f,2147483648,this.J);this.c.d(Common.X.a.d,2147483648,this.S,96);this.c.a(3799468329,2147483648,this.I)},bc:function(){this.b=this.r.a();var n=this.b.g(),t=this;n.CW(function(){var i=n.a();t.bq(i);t.g.b(i)})},bv:function(n,t){this.s=t.a;this.l()},bu:function(){this.l();this.v=this.v||this.b.a()===1;this.bh()},bh:function(){this.y&&this.b.a()===1&&!this.z&&(Diag.a.a(6129288,333,50,"Group chat started and pane toggled"),this.z=!0)},ba:function(n,t){this.p=t.a();this.l()},bq:function(n){var t,i;if(!n){Diag.a.a(9000770,333,10,"Doc chat client not ready");return}this.by();this.i=!0;this.b.c(this.P);this.b.d(this.Q);this.b.b(this.K);this.k&&(t=this,this.k.CW(function(){t.bt()}));this.h&&(i=this,this.h.d().CW(function(){i.bj()}));this.Y(!0,!1)},bk:function(n,t){this.Y(t.b,t.c)},Y:function(n,t){this.A=n;this.f=this.e&&t;this.e=this.e&&!this.f;this.l()},bt:function(){this.n=this.k.a();this.n.b(this.M);this.U()&&this.n.a(this.N);this.n.c()},bj:function(){Diag.a.a(9000771,333,50,"AvailabilityFinder ready");this.h.a(this.G);this.h.b(this.O);this.p=this.h.c();this.l()},bw:function(n,t,i,r,u){var f=u,e=this.bB();return f[CommandUI.Controls.e.Visible]=e,this.bA(f),this.bg(e),32},bA:function(n){this.q.c()&&(n.On=this.b.a()===1,Common.a.a().a().a()?n[CommandUI.G.Icon]=this.s>0?"DocChatUnread_20":"DocChatGlyph_20":n[CommandUI.Controls.e.Image16by16Class]=Common.A.b(this.s>0?Common.X.a.g:Common.X.a.e))},bg:function(n){n&&!this.u&&(Diag.a.a(6350045,333,50,"Setting visibility of the chat button to true"),this.u=!0)},bB:function(){return this.W()||!!this.d},bn:function(n,t){this.c.b(2246375352,2,t.a)},br:function(){this.V()&&this.c.b(2246375352,2,null)},bf:function(n,t,i,r,u){if(i!==2)return 32;if(this.E(),!this.i)return Diag.a.a(16808076,333,15,"Join operation before client is ready"),this.o(),8;var f=u;return f?this.j||this.e?(Diag.a.a(18900674,333,50,String.format("Ignoring chat thread {0}. Already connecting or connected to it.",f.a)),32):((!this.d||this.f)&&(Diag.a.a(18900675,333,50,String.format("Co-authors sent chat thread {0} and we're not connected to it...attempt to connect.",f.a)),this.D(f,!1)),32):(Diag.a.a(18493662,333,10,"Invalid ChatThreadInfo."),this.o(),8)},bz:function(n,t,i){return i!==2?32:(this.E(),!this.i)?(Diag.a.a(21550145,333,15,"Join operation before client is ready"),this.o(),8):this.m||this.j?(Diag.a.a(22045828,333,50,"Ignoring coauthors' InChat flag. Already retrieving the chat info or connecting to doc chat."),1):this.e?(Diag.a.a(21550146,333,50,"Ignoring coauthors' InChat flag. Already connected to doc chat."),32):((!this.d||this.f)&&(Diag.a.a(21550147,333,50,"Co-authors sent InChat flag and we're not connected to the Doc Chat...attempt to connect."),this.X(!1)),32)},bs:function(){this.j||this.e||this.d&&this.f&&(Diag.a.a(18900676,333,50,String.format("User is active but disconnected from doc chat. Attempting to reconnect to chat thread {0}...",this.d.a)),this.c.b(2246375352,2,this.d))},be:function(n){this.j=!0;this.e=!1;this.f=!1;var t=this;this.b.f(this.d,this.L,function(){t.bl(n)},this.C)},bm:function(){this.j=!1;this.e=!0;Diag.a.a(5616863,333,50,"Join operation was successful")},bl:function(n){this.j=!1;n&&this.F();Diag.a.a(5616860,333,10,"Join operation failed")},bd:function(){return this.e&&!this.f?32:8},bi:function(){var n=this;this.k.CW(function(){var t=n.k.a();t.e(n.d);n.U()&&n.n.d()})},D:function(n,t){if(!n){Diag.a.a(18419974,333,10,"Unexpected attempt to get on the doc chat without any chat thread info!");return}this.d=n;t&&this.b.h();this.be(t);this.bi()},bb:function(n,t,i){if(i===2){if(this.E(),!this.i)return this.o(),8;if(this.m)return 1;this.y=!0;this.W()&&!this.d?this.X(!0):this.bC()?this.b.e():this.D(this.d,!0)}return this.i?32:8},X:function(n){Diag.a.a(5616864,333,50,"Trying to create a new thread");this.m=!0;var t=this,i=this;this.B.e(function(i){t.bp(i,n)},function(t){i.bo(t,n)})},bp:function(n,t){var r,u,i;Diag.a.a(5616865,333,50,"Thread created successfully");r=!1;n.b?(u=n.b.b,u?(i=Common.App.SkypeChat.m.a(u),i&&i.Success?(Diag.a.a(5328903,333,50,"Created ChatThreadId is :{0}",i.ThreadId),this.D(new Common.dH(i.ThreadId,i.DiscoveryUri),t),r=!0):Diag.a.a(5616866,333,10,"Could not parse the response, parsed response is null or create thread operation failed.")):Diag.a.a(5328902,333,10,"ResponseData is null")):Diag.a.a(5328901,333,10,"e.Data is null");t&&!r&&this.F();this.m=!1},F:function(){this.o();this.bD()},o:function(){this.w||(this.w=!0,Diag.a.a(36705359,333,15,"Bad user interaction with doc chat."))},E:function(){this.x||(this.x=!0,Diag.a.a(36705360,333,15,"Usage of doc chat"))},bD:function(){},bo:function(n,t){this.m=!1;t&&this.F();Diag.a.a(5328904,333,15,"Try to create thread for this user failed")},bx:function(){return this.l(),32},bC:function(){return this.q.c()&&this.b.a()===1}};Common.App.SkypeChat.k=function(n,t,i,r){this.s=Function.createDelegate(this,this.B);this.t=Function.createDelegate(this,this.C);this.q=Function.createDelegate(this,this.z);this.r=Function.createDelegate(this,this.A);this.p=Function.createDelegate(this,this.y);Common.App.SkypeChat.k.initializeBase(this);Diag.a.a(5895065,333,50,"Initializing chat notifier");this.f=n;this.g=i;this.j=t;this.l=r};Common.App.SkypeChat.k.prototype={f:null,h:null,j:null,g:null,k:null,o:!1,l:null,n:null,m:!1,c:function(){return $$sc.a.WAA.call(null,this.l,this.f,this.g).CW(this.p)},y:function(){Diag.a.a(6603971,333,50,"All prerequisite ready for SkypeChatNotifier");this.n=this.l.a();this.k=this.g.a();this.h=this.f.a();this.v(this.h.i());this.u(this.h.c(1));Diag.a.a(5898719,333,50,"Subscribing to presence updates");this.h.d(this.r);this.h.h(this.q)},A:function(n,t){this.k&&(this.o||(this.o=!0,Diag.a.a(6555618,333,50,"SkypeChat complemented recorded presence update")),this.v(t.b))},v:function(n){var u=n,r,f,t,i;for(r in u)if((f={key:r,value:u[r]},t=this.n.a(f),t)&&(i=t.d(),i&&t.e()!==this.k.e())){Diag.a.a(5895069,333,50,String.format("Chat thread id found : {0}",i));this.w(new Common.dH(i,t.c()));return}},z:function(n,t){t.a===1&&(this.m||(this.m=!0,Diag.a.a(21803734,333,50,"SkypeChat recorded persistent state update")),this.u(t.b))},u:function(n){var u=n,t,i,r;for(t in u)if((i={key:t,value:u[t]},r=i.value,r)&&r.InChat&&i.key!==this.h.a()){Diag.a.a(21803735,333,50,"User found in chat");this.x();return}},e:function(n){return this.j.CWO(this.t,n)},d:function(){return this.f.CW(this.s)},C:function(n,t){var i=this;$$sc.a.WAA(this.g,this.j).CW(function(){i.g.a().g(t.a);i.g.a().f(t.b);Diag.a.a(5898752,333,50,"Re-sending the latest presence with the chatThreadId:{0}, chatThreaddiscoveryUri:{1}",i.g.a().d(),i.g.a().c());i.j.a().a()})},B:function(){var n=this;$$sc.a.WAA(this.f).CW(function(){var t,i=n.f.a().c(1);t=i&&n.f.a().a()in i?i[n.f.a().a()]:new Common.App.SkypeChat.c("",!1,0);t.InChat=!0;Diag.a.a(21803737,333,50,"Re-sending the latest persistent state");n.f.a().m(1,t)})}};Common.App.SkypeChat.j=function(){};Common.App.SkypeChat.j.a=function(){Common.App.a.a().a(new Common.App.SkypeChat.j,0,!1)};Common.App.SkypeChat.j.prototype={a:function(){return"Common.App.SkypeChat"},c:function(n){var i=this,t;n.b(Common.App.SkypeChat.a).a().b(function(){return new Common.App.SkypeChat.a(Common.Utils.b.a(Common.App.BasicChat.b,n.c(Common.App.BasicChat.b)),Common.a.a().c())});t=this;n.b(Common.App.SkypeChat.d).c(Common.App.SkypeChat.e).a().b(function(){return new Common.App.SkypeChat.d(new($$sc.v.$$(Common.App.SkypeChat.a))(function(){return n.a(Common.App.SkypeChat.a)}))})},b:function(){}};Common.App.SkypeChat.c.registerClass("Common.App.SkypeChat.c");Common.App.SkypeChat.w.registerClass("Common.App.SkypeChat.w");Common.App.SkypeChat.n.registerClass("Common.App.SkypeChat.n",null,Common.App.SkypeChat.s);Common.App.SkypeChat.o.registerClass("Common.App.SkypeChat.o",null,Common.fg);Common.App.SkypeChat.b.registerClass("Common.App.SkypeChat.b",Sys.EventArgs,Common.App.SkypeChat.r);Common.App.SkypeChat.a.registerClass("Common.App.SkypeChat.a",null,Common.App.SkypeChat.t);Common.App.SkypeChat.d.registerClass("Common.App.SkypeChat.d",null,Common.App.SkypeChat.e);Common.App.SkypeChat.q.registerClass("Common.App.SkypeChat.q",null,Common.App.SkypeChat.f);Common.App.SkypeChat.p.registerClass("Common.App.SkypeChat.p");Common.App.SkypeChat.l.registerClass("Common.App.SkypeChat.l",Common.App.SkypeChat.p);Common.App.SkypeChat.i.registerClass("Common.App.SkypeChat.i",Common.App.SkypeChat.n);Common.App.SkypeChat.u.registerClass("Common.App.SkypeChat.u",null,Common.App.SkypeChat.h);Common.App.SkypeChat.k.registerClass("Common.App.SkypeChat.k",Common.App.SkypeChat.o);Common.App.SkypeChat.j.a();Type.registerNamespace("RealtimePresenceUI");RealtimePresenceUI.f=function(){};RealtimePresenceUI.f.registerInterface("RealtimePresenceUI.f");RealtimePresenceUI.b=function(n){this.b=n;this.n=new Common.cx(this.b.b,"Anonymous user","#cccccc",new Common.cm(7),null,null,null,null,!1,!1,!1);this.f=!0;this.e=!0;this.c=RealtimePresenceUI.e.a(this.b.b,this.b.d,n.e)};RealtimePresenceUI.b.a=function(n,t){var i=n,r=t;return i.j.a(1)&&r.j.a(1)||!i.j.a(1)&&!r.j.a(1)?Common.d.N(n.k,t.k):i.j.a(1)?-1:1};RealtimePresenceUI.b.prototype={n:null,f:!1,b:null,c:null,e:!1,H:function(){return Common.a.b?Common.a.b.a("ColorPresenceHashIsEnabled"):!1},J:function(n,t,i,r,u,f){var e,o,s,h,c=this.K();this.c.a()?this.c.a()===1?(e=!0,o=this.b.a.b.a,s=this.b.a.b.b,h=this.c.b()[0].l):(e=!0,o=this.b.a.h.a,s=this.b.a.h.b,h=""):(e=!1,o="",s="",h="");n.val=c[0];t.val=c.slice(1);i.val=e;r.val=o;u.val=s;f.val=h},K:function(){if(this.c.a()>=2)return[String.format($a.dU,this.c.a())];if(this.c.a()===1){var n=this.c.b()[0];return[n.p?$a.dW:$a.dV,n.k]}return[$a.dX]},O:function(n){return this.P(n)},G:function(n,t,i){return t?this.o(n,t)?!0:(i&&Diag.a.a(4482394,325,50,"User has presence data but app can't use it"),!1):(i&&Diag.a.a(4482393,325,50,"User does not have any presence data"),!1)},L:function(n){return n.p?$a.ea:$a.dY},P:function(n){if(!n.j.a(1))return this.L(n);var t=n.p,i=this.b.d(n.i),r=this.b.c(n.i);if(!i)return t?$a.k:$a.j;switch(i.b){case 1:return r?this.p(n.i,t,r)||(t?$a.k:$a.j):t?$a.k:$a.j;case 2:return $a.dZ;default:return t?$a.k:$a.j}},M:function(n){var u=String.format("buttonPeoplesWellUser-{0}",n.i),i=n.i,f=this.O(n),r=n.k,t;return t=new Common.bR,t.Id=u,t.Command=this.b.a.e.toString(),t.LabelText="{0}",t.Image32by32=this.b.a.i.a,t.Image32by32Class=this.b.a.i.b,t.MenuItemId=i,t.CommandValueId=i,t.Alt=r,t.DisplayMode=this.r(),t.LabelCss="display:block; max-width:160px; padding:0px; white-space:normal; word-wrap:break-word",t.Description=f,t.ImageBackColor=n.l,t.LabelTextUserGeneratedPlaceholderReplacements=CommandUI.b.w([r]),t},r:function(){return this.H()?"Initials":"Menu32"},N:function(n){for(var u,f,i=[],r=n,e=r.length,t=0;t<e;++t)u=r[t],f=this.M(u),Array.add(i,f);return i},Q:function(){return this.c.a()>0},S:function(n){if(!this.f)return!0;this.e||(n[CommandUI.Controls.d.Visible]=!0);var i,t,r,e,u,f,o,s,h,c,l,a;return this.J(o={val:i},s={val:t},h={val:r},c={val:e},l={val:u},a={val:f}),i=o.val,t=s.val,r=h.val,e=c.val,u=l.val,f=a.val,n[CommandUI.Controls.d.LabelText]=i,t&&t.length&&(n[CommandUI.Controls.d.LabelTextUserGeneratedPlaceholderReplacements]=t),n.ImageIsVisible=r,n[CommandUI.Controls.d.Image16by16Class]=u,n.ImageBackColor=f,this.f=!1,!0},R:function(n){if(this.c.a()<=0)return!1;var f=this.W(this.c.b()),e=this.N(f),i,u=(i=new Common.ds,i.Id="menuCoauthors",i.MaxWidth="220px",i.MenuSectionList=[],i),t,r=(t=new Common.ce,t.Id="msCoauthors",t.ControlsId="msCoauthorsControls",t.DisplayMode=this.r(),t.ControlList=e,t);return Common.a.b.a("WordEditorDisplayPeoplesWellLabelIsEnabled")&&(r.Title=$a.dT,r.TitleId="menuCoauthorsTitle",r.Theme="Light"),Array.add(u.MenuSectionList,r),Common.a.a()&&Common.a.a().a().a()?n.MenuItems=u:n.PopulationXML=Common.r.g(u),!0},X:function(n){var t,i;return(Diag.a.a(4482395,325,50,"PeoplesWell: Received user button click"),t=n.MenuItemId,!t)?!1:(i=this.b.c(t),!this.G(t,i,!0))?!1:(this.s(t,i),!0)},T:function(){var n=this.I();this.c.c(n);this.e&&this.c.a()>=1&&(Diag.a.a(6092429,325,50,"PeoplesWell: User is no longer forever alone."),this.e=!1);this.f=!0},I:function(){var n=null,r;n||(n=this.q()||[]);for(var i=n,u=i.length,t=0;t<u;++t)r=i[t],this.V(r);return n},V:function(n){n.i||(n.i=Common.N.a().a);n.k||(n.k="Anonymous user");n.j||(n.j=new Common.cm(0));n.l||(n.l="#cccccc")},W:function(n){var t=[];return Array.addRange(t,n),t.sort(RealtimePresenceUI.b.a),t},U:function(){this.u();this.m()},m:function(){this.T();this.t()},dispose:function(){}};RealtimePresenceUI.a=function(n,t,i,r,u){var f,e;this.a=n;this.b=t;this.e=u;f=this;this.c=i||function(){return null};e=this;this.d=r||function(){return null}};RealtimePresenceUI.a.a=function(n,t,i,r){if(!i)return new RealtimePresenceUI.a(n,t,null,null,r);var u=i,f=i;return new RealtimePresenceUI.a(n,t,u.e||(u.e=Function.createDelegate(u,u.p)),f.f||(f.f=Function.createDelegate(f,f.q)),r)};RealtimePresenceUI.a.prototype={a:null,b:null,c:null,d:null,e:!1};RealtimePresenceUI.g=function(n){this.d=new($$sc.s.$$(Array));this.e=n};RealtimePresenceUI.g.prototype={e:null,f:null,c:function(n){var i,u;this.k();for(var f=n,o=f.length,t=0;t<o;++t)if(i=f[t],i.i===this.e){this.f=i;break}for(var e=n,s=e.length,r=0;r<s;++r)(u=e[r],u.i!==this.e)&&this.h(u)},b:function(){for(var n=new Array(0),t=this.d.k().$$ge(),i,r;t.$$mn();)i=t.$$cu(),r=this.j(i),Array.add(n,r);return n},a:function(){return this.d.i},i:function(n,t){n=n.toUpperCase();var i,r,u;(u=this.d.e(n,r={val:i}),i=r.val,u)||(i=new Array(0),this.d.b(n,i));Array.add(i,t)},k:function(){this.d=new($$sc.s.$$(Array))}};RealtimePresenceUI.e=function(){};RealtimePresenceUI.e.a=function(n,t,i){return i?new RealtimePresenceUI.c(n,t):new RealtimePresenceUI.d(n)};RealtimePresenceUI.c=function(n,t){RealtimePresenceUI.c.initializeBase(this,[n]);this.g=t};RealtimePresenceUI.c.prototype={g:null,h:function(n){if(n.r||!n.m){this.i(n.i,n);return}this.f&&$$sc.g.d().a(this.f.m,n.m)||this.i(n.m,n)},j:function(n){for(var r,t,u=new Date(0),f=n.length>0?n[0]:null,e=n,o=e.length,i=0;i<o;++i)(r=e[i],t=this.g(r.i),t)&&u.getTime()<t.a.getTime()&&(u=t.a,f=r);return f}};RealtimePresenceUI.d=function(n){RealtimePresenceUI.d.initializeBase(this,[n])};RealtimePresenceUI.d.prototype={h:function(n){this.i(n.i,n)},j:function(n){return n[0]}};RealtimePresenceUI.b.registerClass("RealtimePresenceUI.b",null,Sys.IDisposable);RealtimePresenceUI.g.registerClass("RealtimePresenceUI.g");RealtimePresenceUI.c.registerClass("RealtimePresenceUI.c",RealtimePresenceUI.g);RealtimePresenceUI.d.registerClass("RealtimePresenceUI.d",RealtimePresenceUI.g);Type.registerNamespace("_Ewa");_Ewa.Id=function(){};_Ewa.Id.registerInterface("_Ewa.Id");_Ewa.Ie=function(){};_Ewa.Ie.registerInterface("_Ewa.Ie");_Ewa.yA=function(n,t,i){this.a(null);this.d=n;this.g=t;this.h=i;this.e=new _Ewa.lb(_Ewa.c.a(this.g),this.d.User.UserID,this.d.User.UserName,this.d.UserColor,null,i)};_Ewa.yA.prototype={g:null,e:null,d:null,h:null,f:null,a:function(n){return this.f=n,this.f&&this.h.F(this.f.bG()),n},i:null,dispose:function(){this.l();System.a.a(this.e);this.a(null);this.d=null;this.g=null;this.i=null},k:function(n){this.e.K(n.e)},l:function(){this.f&&this.d&&this.d.User&&(this.f.be(!1,this.d.User.UserID,null),this.e.m(!0))},b:function(){this.f&&this.d&&this.d.User&&(this.f.be(!0,this.d.User.UserID,this.d.UserColor),this.e.t())},j:function(n){this.e.r(n);this.e.e(n,!0)},c:function(n,t){this.e.L(null,t?18:17,n)}};_Ewa.yB=function(){_Ewa.yB.initializeBase(this,[!1])};_Ewa.yB.a=function(n,t){var i=n.b.d();System.a.b(n.d());System.a.b([n.b]);n.b=null;n.b=new _Ewa.pw(t);n.p([]);n.y(t);n.q(i)};_Ewa.yB.prototype={b:null,m:null,d:function(){return this.m},p:function(n){return this.m=n,n},n:null,h:function(){return this.n},y:function(n){return this.n=n,n},a:function(){return this.b.d()},q:function(n){return this.b.e(n),n},x:function(){},f:function(){return null},o:function(){return null},i:function(){},j:function(){},z:function(){}};_Ewa.gV=function(n,t){var i,r,u;for(this.t=Function.createDelegate(this,this.y),this.o=Function.createDelegate(this,this.w),this.s=Function.createDelegate(this,this.x),this.q=[!1,!1,!1,!1],this.m=[null,null,null,null],_Ewa.gV.initializeBase(this,[!1]),this.n=n,this.v=n.d(),i=0;i<4;i++)r=t.b(document.createElement("div")),u=n.k(_Ewa.gV.b()[i]).h(),u.insertBefore(r.e(),u.firstChild),r.c(this.s),this.m[i]=r};_Ewa.gV.b=function(){return _Ewa.gV.a||(_Ewa.gV.a=[1,3,2,4])};_Ewa.gV.prototype={n:null,v:!1,p:null,r:!1,c:function(n){this.cG("interactivityChanged",n)},b:function(n){this.cH("interactivityChanged",n)},e:function(){return null},f:function(){return this.m[0].f()},dispose:function(){if(this.m){this.g();for(var n=0;n<4;n++)this.m[n].b(this.s),this.m[n].dispose()}this.n=null;this.m=null;_Ewa.co.prototype.dispose.call(this)},k:function(){for(var n=0;n<4;n++)this.m[n].k()},j:function(){this.u();for(var n=0;n<4;n++)this.m[n].j()},g:function(){this.z();for(var n=0;n<4;n++)this.m[n].g()},a:function(n){for(var t=0;t<4;t++)this.m[t].a(n)},i:function(n){for(var t=0;t<4;t++)this.m[t].i(n)},h:function(n,t){for(var i=0;i<4;i++)if(this.m[i].h(n,t))return!0;return!1},d:function(n){for(var t=0;t<4;t++)if(this.m[t].d(n))return!0;return!1},l:function(n,t){for(var i=0;i<4;i++){var f=_Ewa.gV.b()[i],u=this.n.k(f),r=_Ewa.pv.a(u,new Sys.UI.Point(n,t),!1);r.x<0&&(this.p=new Sys.UI.Point(n,t),r.x+=u.h().scrollLeft);_Ewa.a.v(this.m[i].e(),r.x,r.y,!1,this.v)}},x:function(n,t){var r,u,i;if(t.a===1)this.cE("interactivityChanged",t,null);else{for(r=!1,u=-1,i=0;i<4;i++)this.m[i]===n?u=i:r=!!(r|this.q[i]);t.a===2?(this.q[u]=!0,r||(this.j(),this.cE("interactivityChanged",t,null))):t.a===3?(this.q[u]=!1,r||this.cE("interactivityChanged",t,null)):this.cE("interactivityChanged",t,null)}},w:function(){this.u()},y:function(){this.u()},u:function(){this.p&&(this.l(this.p.x,this.p.y),this.r||(this.r=!0,this.n.b().d(this.o),this.n.b().b(this.o),this.n.f().d(this.t)))},z:function(){this.r&&(this.n.b().g(this.o),this.n.b().a(this.o),this.n.f().c(this.t))}};_Ewa.lb=function(n,t,i,r,u,f){this.G=Function.createDelegate(this,this.O);this.H=Function.createDelegate(this,this.P);this.I=Function.createDelegate(this,this.Q);this.F=Function.createDelegate(this,this.N);this.u={};_Ewa.lb.initializeBase(this,[!1]);this.z=n;this.D=new Common.cx(t,i,r,new Common.cm(0),null,null,null,null,!1,!1,!1);this.E=t;this.C=u;this.y=f};_Ewa.lb.a=function(n,t){return n.toString()+t.toString()};_Ewa.lb.prototype={A:null,C:null,J:0,z:null,y:null,w:null,B:null,i:function(n){this.cG("hidePresenceTooltip",n)},n:function(n){this.cH("hidePresenceTooltip",n)},k:function(n){this.cG("showPresenceTooltip",n)},q:function(n){this.cH("showPresenceTooltip",n)},j:function(n){this.cG("showFullPresenceTooltip",n)},p:function(n){this.cH("showFullPresenceTooltip",n)},g:function(n){this.cG("presenceChanged",n)},o:function(n){this.cH("presenceChanged",n)},E:null,b:function(){return this.E},D:null,a:function(){return this.D},v:0,d:function(){return this.v},h:function(){return this.A||this.B?_Ewa.pv.a(this.z.k(this.v),this.x(this.v).h(),!0):null},c:function(){return this.x(this.v).c()},r:function(n){var i=this.u,t,r;for(t in i)r={key:t,value:i[t]},r.value.r(n);return n},dispose:function(){var t,i,r,n;this.cE("hidePresenceTooltip",null,null);this.cE("presenceChanged",null,null);this.y&&this.y.D(this.E);t=this.u;for(i in t)r={key:i,value:t[i]},n=r.value,n.n(this.F),n.q(this.I),n.p(this.H),n.o(this.G),n.dispose();this.u=null;this.z=null;this.C=null;this.A=null;this.y=null;_Ewa.co.prototype.dispose.call(this)},L:function(n,t,i){n?(this.A=_Ewa.i.b(n),this.v=this.z.j().b(this.A.V())):i?(this.B=i,this.v=i.d().v()):this.v=1;this.J=t;this.x(this.v);this.s(n,i)},s:function(n,t){var r=this.u,i,u;for(i in r)u={key:i,value:r[i]},u.value.s(n,t)},m:function(n){var t,i,r;this.x(this.v).m(n);t=this.u;for(i in t)r={key:i,value:t[i]},r.value.m(!1)},K:function(n){var r=this.u,t,u,i;for(t in r)u={key:t,value:r[t]},i=u.value,i.l(n.x(i.d()))},l:function(n){this.x(n.d()).l(n)},e:function(n,t){var i,r,u;this.y.n(this);this.x(this.v).e(n,t);i=this.u;for(r in i)u={key:r,value:i[r]},u.value.e(n,!1)},f:function(n){var i=this.u,t,r;for(t in i)r={key:t,value:i[t]},r.value.f(n)},t:function(){var t=this.u,n,i;for(n in t)i={key:n,value:t[n]},i.value.t();this.y.n(this)},x:function(n){return this.M(n,this.J)},M:function(n,t){var u=this.C?this.C.g(t,n).a:this.B?this.B.W():null,r=_Ewa.lb.a(t,n),i=_Ewa.p.a(this.u,r,null);return i||(i=new _Ewa.yE(u,this.z,this.D,n),this.u[r]=i,i.i(this.F),i.k(this.I),i.j(this.H),i.g(this.G)),i},N:function(n){this.w&&this.w!==n||(this.w=null,this.m(!1));this.cE("hidePresenceTooltip",null,null)},Q:function(n){this.w&&this.w!==n||(this.w=null,this.e(!0,!1));this.cE("showPresenceTooltip",null,null)},P:function(n){this.w||this.cE("showFullPresenceTooltip",null,null);this.w=n},O:function(){this.m(!1);this.cE("presenceChanged",null,null)}};_Ewa.dB=function(n,t,i){this.bb=Function.createDelegate(this,this.bM);_Ewa.dB.initializeBase(this,[n.User.UserID,t,_Ewa.c.a(t),!0]);_Ewa.dB.a||(_Ewa.dB.a={});this.b=n;this.a=new _Ewa.lb(this.q,this.b.User.UserID,this.b.User.UserName,this.b.UserColor,this,i);this.n(this.bb)};_Ewa.dB.c=function(){return _Ewa.dB.b||(_Ewa.dB.b=[17,18])};_Ewa.dB.prototype={b:null,S:17,e:!1,c:!1,a:null,j:function(){return _Ewa.dB.c()},F:function(){return _Ewa.dB.c()},dispose:function(){var t,i,r,n;this.m(this.bb);System.a.a(this.a);_Ewa.kB.prototype.dispose.call(this);t=_Ewa.dB.a;for(i in t)r={key:i,value:t[i]},n=r.value,n&&!n.children.length&&(_Ewa.a.h(n),_Ewa.dB.a[r.key]=null)},bc:function(n){this.a.K(n.a)},bw:function(n){this.c||(this.a.r(n),this.a.e(n,!0));this.e=n&&this.c},bd:function(n,t){this.a.L(n,t?18:17,null);this.e=!1},bN:function(n){this.S=n;this.ba([n],null,null)},bK:function(n){this.bL();this.z([n])},D:function(n,t,i){var u,e,r,f;i.className="ewr-cell-presence-highlight-all";i.style.borderColor=this.b.UserColor;u=document.createElement("div");n!==17&&(u.style.backgroundColor=this.b.UserColor);i.appendChild(u);e=["ewr-cell-presence-highlight-fill","ewr-cell-presence-highlight-edit"];u.className=e[n-17];r=_Ewa.p.a(_Ewa.dB.a,t.toString(),null);r||(f=this.q.k(t).h(),r=document.createElement("div"),f.insertBefore(r,f.firstChild),_Ewa.dB.a[t.toString()]=r);r.appendChild(i)},bl:function(n,t,i){var u,e;if(this.c=!0,u=[],n.b===18)e=new Common.bm(n.a),e.b(0,1),Array.add(u,e);else if(n.b===17){var o=new Common.bt(n.a),s=new Common.cj(n.a),f=n.a.style,r=this.bu(t,n.b,n);r.a.a!==i.a.a&&o.g(parseInt(f[this.q.be()]),r.a.a,this.q.d());r.a.b!==i.a.b&&o.c(parseInt(f.top),r.a.b);r.c()!==i.c()&&s.f(parseInt(f.width),r.c());r.d()!==i.d()&&s.p(parseInt(f.height),r.d());Array.add(u,o);Array.add(u,s)}return u},R:function(){},P:function(n,t){var r=[],u,i;return n===18&&(u=this.g(n,t),i=new Common.bU(u.a),i.b(1,0),Array.add(r,i)),r},x:function(n,t,i){return _Ewa.kB.prototype.x.call(this,n,t,i)?n===18&&!(Common.c.d()||i===t.f)||n===17&&i&&t.f&&!this.y:!1},H:function(){return!0},Q:function(){return null},K:function(n,t,i,r){var u=this.bu(r,n,t);_Ewa.cK.a(i,this.q.d(),u.a.a+"px");i.width=u.c()+"px";i.top=u.a.b+"px";i.height=u.d()+"px";this.bv(n,t)},bp:function(n){return n!==17},bu:function(n,t,i){var r=n.a.b+this.v(i,!1),u=n.a.a+this.v(i,!0)+_Ewa.K.i(i.a.parentNode.parentNode,this.q.d()),f=n.c(),e=n.d()+1;return u<1&&u>=-1&&t===17&&(f-=1-u,u=1),r<1&&r>=-1&&t===17&&(e-=1-r,r=1),f=Math.max(0,f-1),e=Math.max(0,e-2),new _Ewa.L(u,r,f,e)},bv:function(n,t){var i=t.a,r=i.parentNode;r.removeChild(i);r.appendChild(i);n!==this.S&&this.a.m(!0);this.a.t();this.S=n;this.c=!1;this.e&&this.bw(!0);this.e=!1},bL:function(){this.c||(this.a.m(!0),this.e=!1)},bM:function(n,t){this.bv(t.a,t.d)}};_Ewa.gW=function(n){this.l=Function.createDelegate(this,this.B);this.m=Function.createDelegate(this,this.C);this.g=Function.createDelegate(this,this.z);this.j=Function.createDelegate(this,this.y);this.f=Function.createDelegate(this,this.x);this.k=Function.createDelegate(this,this.A);this.a=_Ewa.c.a(n);this.d=n;this.e={};this.b={};this.c={};this.d.e()&&this.d.e().b(this.k);this.p()};_Ewa.gW.a=function(n,t){n.i(t);n.f().length||n.g()};_Ewa.gW.b=function(n,t){return n.x.toString()+"-"+n.y.toString()+"-"+t.toString()};_Ewa.gW.prototype={e:null,c:null,b:null,h:!1,a:null,d:null,i:null,dispose:function(){this.t();this.o();this.d&&this.d.e()&&this.d.e().c(this.k);this.a=null},t:function(){this.h&&(this.a.b().g(this.f),this.a.b().a(this.f),this.a.f().c(this.j),this.h=!1)},D:function(n){var t=this.c[n],i=this.b[n];t&&this.r(t);i&&_Ewa.gW.a(i,t.a().i);this.b[n]=null;this.c[n]=null},n:function(n){var u=n.c(),r=n.b(),f=this.c[r],t,i;f||this.w(n);t=this.q(n.h(),n.d());i=this.b[r];t&&t!==i&&(n.f(t),this.b[r]=t,this.c[r]=n);i!==t&&i&&_Ewa.gW.a(i,n.a().i);u&&!this.h&&this.a&&(this.a.b().d(this.f),this.a.b().b(this.f),this.a.f().d(this.j),this.h=!0)},r:function(n){n&&(n.n(this.g),n.q(this.m),n.p(this.l),n.o(this.g),n.f(null))},w:function(n){n.i(this.g);n.k(this.m);n.j(this.l);n.g(this.g)},z:function(n){var t=n,i=this.b[t.b()];i&&_Ewa.gW.a(i,t.a().i)},C:function(n){this.s(!1,n)},B:function(n){this.s(!0,n)},s:function(n,t){t.c()||this.n(t);var i=this.b[t.b()];i&&(i.a(t.a()),n?i.j():i.k())},q:function(n,t){if(!n)return null;var r=this.v(n,t),u=_Ewa.gW.b(r,t).toString(),i=_Ewa.p.a(this.e,u,null);return i||(i=new _Ewa.gV(this.a,this.i),i.l(r.x,r.y),this.e[u]=i),i},v:function(n,t){var f=this.a.f().a(),i=this.a.k(t).p(),r=_Ewa.dm.a(t,f.a),e=Math.max(i.a,n.x-18),u;return e=Math.min(Math.max(r.a+i.a,e),r.a+i.a+f.c()-16),u=Math.max(i.b,n.y-15),u=Math.min(Math.max(r.b+i.b,u),r.b+i.b+f.d()-16),new Sys.UI.Point(e,u)},o:function(){var r=this.c,n,u,t,i,f;for(n in r)u={key:n,value:r[n]},this.r(u.value);t=this.e;for(i in t)f={key:i,value:t[i]},f.value.dispose();this.b={};this.c={};this.e={}},x:function(){this.u()},y:function(){this.u()},A:function(){this.p();this.o()},p:function(){var n=new Common.App.CollabControls.g;n.b(0,"ewaboot_presenceheadswhite");n.b(1,"ewaboot_presenceheads");n.b(12,49);n.b(6,16);this.a&&(n.b(4,_Ewa.o.a(3)),n.b(5,_Ewa.o.a(3)),n.b(8,this.a.d()));this.i=new Common.App.CollabControls.f(n)},E:function(n,t){var i=new Common.App.CollabControls.g;i.b(0,n?"ewaboot_presenceheadswhite":t);i.b(1,n===1?t:"ewaboot_presenceheads");i.b(12,n===12?Number.parseInvariant(t.toString()):49);i.b(6,n===6?t:16);this.a&&(i.b(4,n===4?t:_Ewa.o.a(3)),i.b(5,n===5?t:_Ewa.o.a(3)),i.b(8,n===8?t:this.a.d()));this.i=new Common.App.CollabControls.f(i)},F:function(n){this.E(12,n)},u:function(){var u=this.c,r,f,n,i,t;for(r in u)f={key:r,value:u[r]},n=f.value,n&&n.c()&&(i=this.b[n.b()],t=this.q(n.h(),n.d()),t!==i?(i&&_Ewa.gW.a(i,n.a().i),t&&(t.a(n.a()),this.b[n.b()]=t,n.f(t),n.e(!0,!0))):n.e(!0,!0))}};_Ewa.jj=function(n,t,i){this.G=Function.createDelegate(this,this.bh);this.y=Function.createDelegate(this,this.bd);this.x=Function.createDelegate(this,this.bc);this.w=Function.createDelegate(this,this.bb);this.z=Function.createDelegate(this,this.be);this.B=Function.createDelegate(this,this.bg);this.v=Function.createDelegate(this,this.ba);this.u=Function.createDelegate(this,this.Z);this.A=Function.createDelegate(this,this.bf);this.g={};_Ewa.jj.initializeBase(this,[!1]);this.o={};this.p={};this.m={};this.j={};this.f=n;this.k=t;this.h=i;this.S();this.q=new _Ewa.gW(n);this.f.e()&&this.f.e().b(this.A);this.k.c(this.u);this.k.d(this.v);this.i=[];this.k.a();n.a().b(_Ewa.je,25,this);this.n=!1;this.f.L(this.B)};_Ewa.jj.a=function(n,t,i,r){var u;if(!r||!r.a()||!r.a().Object)return!1;for(var e=r.a().Object,o=e.length,f=0;f<o;++f)if(u=e[f],n&&u&&u.ObjectId&&!u.ObjectId.localeCompare(n))return Array.add(u.ObjectPresenceType===1?i:t,r.b.a.User),!0;return!1};_Ewa.jj.prototype={f:null,i:null,q:null,D:null,k:null,n:!1,r:null,O:3e4,m:null,o:null,p:null,l:null,c:function(n){this.cG("pcek",n)},e:function(n){this.cH("pcek",n)},h:null,b:function(){return this.g},j:null,U:function(){return this.f.c(394)},bi:function(n){this.h.b(n);this.D=n.a()},d:function(n,t,i,r){var u,f,o,e;i.val=[];r.val=[];u=this.g;for(f in u)o={key:f,value:u[f]},e=o.value,t?this.M(_Ewa.i.a(n,this.f),i.val,r.val,e):this.L(n,i.val,r.val,e)},a:function(n,t,i,r,u){var f=this.g[u];f&&(t?this.M(n,i,r,f):this.L(n,i,r,f))},dispose:function(){var n,t,i;if(this.bj(),this.f&&(this.f.e()&&this.f.e().c(this.A),this.f.M(this.B)),this.k&&(this.k.e(this.u),this.k.f(this.v)),this.g){n=this.g;for(t in n)i={key:t,value:n[t]},i.value.dispose()}System.a.b([this.h,this.q,this.l]);this.J();this.h=null;this.f=null;this.g=null;Array.clear(this.i);_Ewa.co.prototype.dispose.call(this)},bj:function(){this.h&&(this.h.m(this.z),this.h.l(this.w),this.h.n(this.x),this.h.o(this.y))},bb:function(){var i=this.j,t,r,n;for(t in i)r={key:t,value:i[t]},n=r.key,this.H(n)?(this.s(n,!0),delete this.m[n],delete this.j[n]):Diag.a.a(20303883,0,50,"PresenceView.OnEcsUserListChanged: pending userId=[{0}] still not updated",n)},be:function(n,t){var f=null,e,s,h,c,i,l,u,a,o,v,r,y;if(this.f.r()&&(f=this.f.r().b("ModelUpdate","PresenceRendering"),f.c()),e={},t.b){this.n||(this.F(!0),this.n=!0);s=t.b;for(h in s)(c={key:h,value:s[h]},i=c.key,this.p[i]=_Ewa.B.a().a(),l=c.value,i!==this.D)&&(u=this.g[i],u||(this.H(i)?this.s(i,!0):(i in this.j?Diag.a.a(25187144,0,50,"PresenceView.OnSelectionPresenceChanged: userId=[{0}] already pending update",i):(this.m[i]=_Ewa.B.a().a(),e[i]=1),this.j[i]=!0,a=this.W(i),this.g[i]=this.K(a)),u=this.g[i]),u&&(u.q(l),this.Q(i),this.C(u)))}if(t.a)for(o=0,v=t.a.length;o<v;o++)r=t.a[o],this.o[r]=_Ewa.B.a().a(),r in this.g&&(this.Q(r),y=this.g[r],y.dispose(),delete this.g[r]),r in this.j&&(this.s(r,!1),delete this.m[r],delete this.j[r]);(t.a&&t.a.length>0||$$sc.f.a(e).length>0)&&this.f.b().Y($$sc.f.a(e),t.a);f&&f.a();this.cE("pcek",t,null)},K:function(n){return new _Ewa.jk(n,this.f,this.q)},H:function(n){var t=this.f.b().W(n),i;return t&&(n in this.g?this.g[n].z(t):(i=this.K(t),this.g[n]=i,this.C(i))),!!t},M:function(n,t,i,r){var u,f,o;if((!n||(u=_Ewa.eN.a(n,this.f,1),!u||!_Ewa.jj.a(u.i,t,i,r)))&&(!this.U()||!n||(f=_Ewa.eN.a(n,this.f,2),!f||!_Ewa.jj.a(f.i,t,i,r)))&&r.a().SelectedRange)for(var s=r.a().SelectedRange,h=s.length,e=0;e<h;++e)if(o=s[e],o&&n&&_Ewa.eN.b(n,o)){Array.add(r.a().PresenceType===1?i:t,r.b.a.User);return}},L:function(n,t,i,r){n&&_Ewa.jj.a(this.V(n),t,i,r)},V:function(n){if(n)switch(n.a){case 0:var t=this.f.l().bw(n.b);return t?t.i:null;case 2:return n.y;default:return null}return null},S:function(){this.h.e(this.z);this.h.f(this.x);this.h.d(this.w);this.h.g(this.y)},Q:function(n){for(var t=this.i.length-1;t>=0;t--)this.i[t].User.UserID===n&&(Array.removeAt(this.i,t),this.g[n].i(!1),this.g[n].j(!1,null),this.t())},bd:function(){this.N();this.Y()},Y:function(){this.r&&_Ewa.cb.a(_Ewa.B.a(),this.r)<this.O||(this.r=_Ewa.B.a().a(),this.E(),this.X(),this.n||this.F(!1))},bf:function(){var n,t,i;this.N();n=this.g;for(t in n)i={key:t,value:n[t]},this.C(i.value)},bg:function(){this.E();this.n||this.F(!1);this.n=!1},J:function(){this.E();this.m=null;this.j=null},E:function(){var t=this.j,n,i;for(n in t)i={key:n,value:t[n]},this.s(i.key,!1)},X:function(){var f=this.o,n,t,i,r,u;for(n in f)t={key:n,value:f[n]},this.P(t.key,!0,t.value);i=this.p;for(r in i)u={key:r,value:i[r]},this.P(u.key,!1,u.value);this.o={};this.p={}},s:function(n,t){var i,r;this.f.q()&&(i={},i.a=this.f.f().UserSessionId,i.b=n,i.c=t,i.e=!1,i.d=-1,this.f.b()&&(i.e=this.f.b().v()),r=this.m[n],r&&(i.d=_Ewa.cb.a(_Ewa.B.a(),r)),_Ewa.w.a().a(20,i,!0))},F:function(n){if(this.f.q()){var t={};t.e=-1;t.f=-1;t.c=!1;t.d=!1;t.b=n;t.a=this.f.f().UserSessionId;this.f.b()&&(t.c=this.f.b().bo(),t.d=this.f.b().v(),this.f.b().m()&&(t.e=this.f.b().m().length),this.f.b().F()&&(t.f=_Ewa.cb.a(_Ewa.B.a(),this.f.b().br())));_Ewa.w.a().a(21,t,!0)}},P:function(n,t,i){if(this.f.q()){var r={};r.a=this.f.f().UserSessionId;r.b=n;r.c=t;r.d=i;_Ewa.w.a().a(19,r,!0)}},N:function(){var r=[],u=this.g,i,f,n,t;for(i in u)f={key:i,value:u[i]},n=f.value,this.h.c(n.a())&&(this.I(r,n),Array.remove(this.i,n.b.a),this.h.i().PresenceType===1&&(t={},t.a=n.a().PresenceType===1?"Editing":"Non-Editing",t.b=this.f.f().UserSessionId,t.c=_Ewa.B.a().a(),_Ewa.w.a().a(18,t,!1)));this.R(!1);Array.clear(this.i);this.i=r;this.t()},I:function(n,t){var r=t.b.a,u,i;if(t.a().PresenceType)Array.add(n,r);else{for(u=n.length,i=0;i<u;i++)if(this.g[n[i].User.UserID].a().PresenceType)break;Array.insert(n,i,r)}},bc:function(){var t=this.g,n,i;for(n in t)i={key:n,value:t[n]},i.value.dispose();this.g={};this.J();this.m={};this.j={};Array.clear(this.i);this.t()},Z:function(n,t){this.bi(t.a)},ba:function(){System.a.a(this.l);this.l=null;this.k.b()&&this.k.b().b()&&this.k.b().b()!==1||this.h.b(null)},C:function(n){var u,t,i,r;this.h.c(n.a())&&(this.I(this.i,n),this.t());u=n.b.a.User.UserID;t=this.g;for(i in t)r={key:i,value:t[i]},r.key!==u&&n.x(r.value)},t:function(){this.l=_Ewa.dN.a(this.G,this.i.length?500:1,this.l);this.i.length?this.R(!0):this.q.t()},R:function(n){for(var t,r,i=0,u=this.i.length;i<u;i++)t=this.g[this.i[i].User.UserID],t&&(n?this.h.k(t.a())?t.i(!0):(r=this.h.j(t.a()),r&&t.j(!0,r)):(t.i(!1),t.j(!1,null)))},bh:function(){var u=_Ewa.dg.a(this.f),i,r;if(u){var f=this.i.length,n=!f,e=n?null:this.i[f-1],o=n?"":e.UserColor,t=this.T();t&&(t.style.backgroundColor=o,_Ewa.a.b(t,!n&&this.g[e.User.UserID].a().PresenceType===1));i=u.a().bL();i&&(r=i.style,r.borderColor=o,r.backgroundColor=n?"white":"transparent")}System.a.a(this.l);this.l=null},T:function(){var n=null,t=_Ewa.dg.a(this.f).a().bL(),i;return t&&(n=_Ewa.a.f(t.parentNode,"ewa-fb-presence-cover-internal",!1),n||(i=document.createElement("div"),i.className="ewa-fb-presence-cover",t.parentNode.insertBefore(i,t),n=document.createElement("div"),n.className="ewa-fb-presence-cover-internal",i.appendChild(n))),n},W:function(n){var t={};return t.User={},t.User.UserID=n,t.User.UserName=_Ewa.b.a().c(70),t.UserColor="#AAAAAA",t}};_Ewa.es=function(n){this.D=Function.createDelegate(this,this.X);this.G=Function.createDelegate(this,this.bb);this.H=Function.createDelegate(this,this.bc);this.I=Function.createDelegate(this,this.bd);this.F=Function.createDelegate(this,this.ba);this.C=Function.createDelegate(this,this.W);this.w=Function.createDelegate(this,this.V);this.B=Function.createDelegate(this,this.U);this.E=Function.createDelegate(this,this.Z);this.y=Function.createDelegate(this,this.Y);this.J=Function.createDelegate(this,this.be);this.K=Function.createDelegate(this,this.bf);_Ewa.es.initializeBase(this,[!1]);this.q=n;this.u=_Ewa.c.a(this.q).a();this.q.B(this.K);this.q.L(this.J);this.p={};this.t=new Common.cx;this.s={};this.s.b=0;this.s.c=0};_Ewa.es.a=function(){return _Ewa.es.b||(_Ewa.es.b={ApplyFilter:1,ApplyPivot:0,ApplyPivotSort:0,ApplyPivotSortByValue:1,ApplyWellKnownPivotFilter:0,RemovePivotFilter:0,SetCustomFilter:1,SetTop10Filter:1,TogglePivotDrill:0})};_Ewa.es.d=function(n,t){return!!n&&!!n.ObjectId&&!!t&&!!t.ObjectId&&(!n.ObjectType||n.ObjectType===2)&&n.ObjectType===t.ObjectType&&!n.ObjectId.localeCompare(t.ObjectId)};_Ewa.es.c=function(n,t){return!n.NamedObjectName&&_Ewa.eN.b(n,t)};_Ewa.es.prototype={q:null,u:null,r:null,t:null,v:null,s:null,e:function(n){this.cG("presenceChanged",n)},m:function(n){this.cH("presenceChanged",n)},d:function(n){this.q.b().y(n)},l:function(n){this.q.b().z(n)},g:function(n){this.cG("selectionChanged",n)},o:function(n){this.cH("selectionChanged",n)},f:function(n){this.cG("presenceDisabled",n)},n:function(n){this.cH("presenceDisabled",n)},p:null,i:function(){return this.p},h:function(){return this.t},T:function(){return this.q.c(394)},L:function(){return this.q.c(470)},P:function(){return!this.q.b()||!this.q.b().m()||this.q.b().m().length<2},dispose:function(){this.q&&(this.O(),this.q.D(this.K),this.q.M(this.J));this.r&&this.r.k(this.y);this.r=null;this.q=null;_Ewa.co.prototype.dispose.call(this)},b:function(n){this.r?this.r.k(this.y):this.Q();this.r=n;this.r?(this.r.d(this.y),this.x()):this.O()},Q:function(){var i,t,r,n;this.u.f(this.E);_Ewa.c.a(this.q).E(this.B);i=_Ewa.c.a(this.q).e();i.i(this.w);i.d(this.C);this.q.b().f(this.F);t=this.q.d().a();t.m(this.I);t.e(this.H);t.d(this.G);r=_Ewa.k.b(_Ewa.dz,this.q.a(),16,70);n=this;_Ewa.d.cw(r,function(t){n.v=t.a();n.v.G(n.D);n.v.F(n.w)},$$sc.e.a,3)},O:function(){this.u.g(this.E);_Ewa.c.a(this.q).G(this.B);var n=_Ewa.c.a(this.q).e();n.k(this.w);n.c(this.C);this.q.b().h(this.F);this.v&&(this.v.K(this.D),this.v.J(this.w),this.q.d().a().r(this.I),this.q.d().a().h(this.H),this.q.d().a().g(this.G));this.cE("presenceDisabled",null,null)},c:function(n){return this.k(n)||!!this.j(n)},k:function(n){var f,e,t,i,o,s,r,u;if(this.p.Version===2&&this.p.Object&&n.Version===2&&n.Object&&this.p.Object.length>0&&n.Object.length>0)for(f=this.p.Object.length,e=n.SelectedRange.length,t=0;t<f;t++)for(i=0;i<e;i++)if(this.S(this.p.Object[t],n.Object[i]))return!0;if(this.p.SelectedRange&&n.SelectedRange)for(o=this.p.SelectedRange.length,s=n.SelectedRange.length,r=0;r<o;r++)for(u=0;u<s;u++)if(_Ewa.es.c(this.p.SelectedRange[r],n.SelectedRange[u]))return!0;return!1},j:function(n){var r,u,t,i;if(this.p.Version===2&&this.p.Object&&n.Version===2&&n.Object&&this.p.Object.length>0&&n.Object.length>0)for(r=this.p.Object.length,u=n.Object.length,t=0;t<r;t++)for(i=0;i<u;i++)if(_Ewa.es.d(this.p.Object[t],n.Object[i]))return this.p.Object[t].ObjectId;return null},S:function(n,t){return!!n&&!!t&&n.ObjectType===t.ObjectType&&(n.ObjectType===1||this.T()&&n.ObjectType===3)&&!!n.ObjectId&&!!t.ObjectId&&!n.ObjectId.localeCompare(t.ObjectId)},a:function(){this.x()},x:function(){this.u.c()?this.M(0):this.N(_Ewa.c.a(this.q).e().f()?1:0)},M:function(n){var r={},i,t,u;if(this.q.w(r),this.u.c()){if(i=this.u.c().a(),r.FirstColumn=-1,r.FirstRow=-1,r.LastColumn=-1,r.LastRow=-1,r.NamedObjectName=i?i.i():null,this.p.SelectedRange=[r],this.p.PresenceType=0,t=null,i)switch(i.a){case 0:u=this.q.l().bw(i.b);u&&(t={},t.ObjectType=this.z(0),t.ObjectPresenceType=n,t.ObjectId=u.i);break;case 2:i.b&&(t={},t.ObjectType=this.z(9),t.ObjectPresenceType=n,t.ObjectId=i.y)}this.p.Object=[t]}this.cE("selectionChanged",null,null);this.A()},N:function(n){var t,i,r,u;_Ewa.c.a(this.q).K()||(t={},i=this.u.a(),this.q.w(t),i&&(t.FirstColumn=i.b-1,t.FirstRow=i.a-1,t.LastColumn=i.c-1,t.LastRow=i.d-1,t.NamedObjectName=null),this.p.SelectedRange=[t],r=null,u=_Ewa.eN.a(t,this.q,1),u&&(r={},r.ObjectType=this.z(u.c),r.ObjectPresenceType=this.L()?0:n,r.ObjectId=u.i),this.p.Object=[r],this.p.PresenceType=n,this.cE("selectionChanged",null,null),this.A())},A:function(){this.P()||++this.s.b;this.r&&(this.p.Version=2,this.p.ClientType=1,this.p.ChatThreadId=this.t.o,this.p.ChatThreadDiscoveryUri=this.t.n,this.p.InChat=this.t.q,this.p.Cid=this.t.m,this.p.SupportsChat=!!this.t.j&&this.t.j.a(4),this.r.u(this.p),this.P()||++this.s.c)},U:function(){this.q&&this.M(0)},W:function(){this.p.PresenceType=1;this.cE("selectionChanged",null,null);this.A()},V:function(){this.x();this.R()},X:function(){this.u.c()?this.M(1):this.N(this.L()?0:1)},Y:function(n,t){this.cE("presenceChanged",t,null)},Z:function(){this.N(_Ewa.c.a(this.q).s()?1:0)},ba:function(n,t){_Ewa.hY.a(t)&&(this.p={})},bd:function(n,t){var i,u,r;if(t&&t.c in _Ewa.es.a()){i=null;switch(_Ewa.es.a()[t.c]){case 0:i=t.b.cell;break;case 1:i=t.b.parameters.Location;break;default:return}i.LastColumn=i.FirstColumn;i.LastRow=i.FirstRow;i.NamedObjectName=null;this.p.SelectedRange=[i];this.p.PresenceType=1;u=_Ewa.eN.a(i,this.q,1);r=null;u&&(r={},r.ObjectType=this.z(u.c),r.ObjectPresenceType=this.L()?0:1,r.ObjectId=u.i);this.p.Object=[r];this.cE("selectionChanged",null,null);this.A()}},bb:function(n,t){t.a.b in _Ewa.es.a()&&(this.p.Object=[null],this.x())},bc:function(n,t){t.a.b in _Ewa.es.a()&&(this.p.Object=[null],this.x())},bf:function(n,t){t.a||(this.p={},this.q.q()?this.Q():this.O())},be:function(){this.R()},R:function(){this.q.q()&&(this.s.a=this.q.f().UserSessionId,_Ewa.w.a().a(24,this.s,!0));this.s.b=0;this.s.c=0},z:function(n){switch(n){case 0:return 0;case 1:return 1;case 2:return 3;case 9:return 2;default:return-1}}};_Ewa.yD=function(n){_Ewa.yD.initializeBase(this);this.k=n;this.j()};_Ewa.yD.prototype={k:null,h:null,b:function(){this.i(this.h||(this.h=new _Ewa.es(this.k)))}};_Ewa.yE=function(n,t,i,r){this.N=Function.createDelegate(this,this.bh);this.H=Function.createDelegate(this,this.bf);this.O=Function.createDelegate(this,this.bj);this.M=Function.createDelegate(this,this.bg);this.P=Function.createDelegate(this,this.bb);this.Q=Function.createDelegate(this,this.bk);this.W=Function.createDelegate(this,this.bn);this.J=Function.createDelegate(this,this.bi);this.K=Function.createDelegate(this,this.bl);this.v=[];_Ewa.yE.initializeBase(this,[!1]);this.u=n;this.w=t;this.T=n.id;this.R=r;this.ba(!0);this.S=i;this.F=!1;this.C=null;this.y={};this.y.FirstColumn=0;this.y.FirstRow=0;this.y.LastColumn=0;this.y.LastRow=0};_Ewa.yE.prototype={w:null,u:null,z:null,A:!1,F:!1,D:!1,I:!1,y:null,C:null,G:null,E:null,i:function(n){this.cG("hidePresenceTooltip",n)},n:function(n){this.cH("hidePresenceTooltip",n)},k:function(n){this.cG("showPresenceTooltip",n)},q:function(n){this.cH("showPresenceTooltip",n)},j:function(n){this.cG("showFullPresenceTooltip",n)},p:function(n){this.cH("showFullPresenceTooltip",n)},g:function(n){this.cG("presenceChanged",n)},o:function(n){this.cH("presenceChanged",n)},T:null,b:function(){return this.T},S:null,a:function(){return this.S},R:0,d:function(){return this.R},h:function(){var n,e,u,f;if(!this.u||(n=this.w.f().a(),e=new _Ewa.L(this.u.offsetLeft,this.u.offsetTop,this.u.offsetWidth,this.u.offsetHeight),!n.j(e)))return null;if(u=this.w.d(),f=this.u.offsetWidth,!this.C&&f<=4){if(this.y){var t=this.w.l(),i=this.y.FirstRow,r=u?this.y.FirstColumn:this.y.LastColumn;if(t&&!(i>=t.a&&i<=t.d&&r>=t.b&&r<=t.c))return i=i<=t.a?n.a.b:n.a.b+(i>=t.d?n.d():n.d()/2),r=r<=t.b?n.a.a:n.a.a+(r>=t.c?n.c():n.c()/2),this.G=new Sys.UI.Point(r,i)}return this.G}if(this.C){var h=this.u.offsetTop-2,o=parseInt(this.u.style.left),s=0;return u&&(s=parseInt(this.u.parentNode.style.width)-f-o-(this.w.I().b()&&this.w.I().c()?_Ewa.K.a():0)),this.G=new Sys.UI.Point((u?s:o)+f+4,h)}return this.G=new Sys.UI.Point(parseInt(u?this.u.style.right:this.u.style.left)+f,this.u.offsetTop)},B:!1,c:function(){return this.B},r:function(n){return this.B=n,n},x:null,dispose:function(){this.cE("hidePresenceTooltip",null,null);this.cE("presenceChanged",null,null);this.Z();this.V(!0);this.x&&this.x.b(this.K);System.a.a(this.E);this.w=null;this.u=null;this.x=null;_Ewa.co.prototype.dispose.call(this)},s:function(n,t){var i=!!n&&!_Ewa.i.b(n).f(_Ewa.i.b(this.y)),r=!!t&&(!this.C||this.C.N()!==t.N());(i||r)&&(this.cE("presenceChanged",null,null),this.Z(),this.A=!1,this.B=!1,this.y=n,this.C=t,this.G=null)},m:function(n){this.B=!1;this.I=!1;n&&this.cE("hidePresenceTooltip",null,null)},l:function(n){Array.add(this.v,n);this.ba(!1);n.g(this.J)},Y:function(n){!this.A&&this.L(n.get_clientPoint())&&(this.A=!0,this.cE("showFullPresenceTooltip",null,null),this.D=!0)},X:function(n,t){(t||this.A&&!this.L(n.get_clientPoint()))&&(this.A=!1,this.U(n)||(this.D=!0,this.cE(this.B?"showPresenceTooltip":"hidePresenceTooltip",null,null)))},bd:function(n){this.L(n.get_clientPoint())&&this.cE("showPresenceTooltip",null,null)},be:function(n){this.X(n,!1);this.Y(n)},e:function(n,t){n?(this.I=!0,t&&(this.E=_Ewa.dN.a(this.W,500,this.E))):this.m(t)},f:function(n){this.x&&this.x.b(this.K);this.x=n;this.x&&this.x.c(this.K)},t:function(){if(this.u){this.z=_Ewa.a.q(this.u);var n=Math.floor(this.z.x);this.z.x=n===this.z.x?n:n+1;this.z.y=Math.floor(this.z.y)}},bn:function(){System.a.a(this.E);this.E=null;this.I&&this.cE("showPresenceTooltip",null,null)},Z:function(){for(var n=0,t=this.v.length;n<t;n++)this.v[n].o(this.J);Array.clear(this.v);this.V(!1)},L:function(n){return this.z||this.t(),!!this.z&&Common.f.b(this.z,n)},U:function(n){return!!this.x&&(this.x.d(n)||this.x.h(n.get_clientPoint(),-2))},ba:function(n){this.u&&(n&&(Common.e.a().a("msospPointerOver",this.u,this.Q),Common.e.a().a("msospPointerOut",this.u,this.P),Common.h.a().a("click",this.u,this.M)),!this.F&&this.v.length>=1&&(this.F=!0,Common.e.a().a("msospPointerMove",this.u,this.O),this.w.b().d(this.H),this.w.b().b(this.H),this.w.f().d(this.N)))},V:function(n){this.u&&(n&&(Common.e.a().b("msospPointerOver",this.u,this.Q),Common.e.a().b("msospPointerOut",this.u,this.P),Common.h.a().b("click",this.u,this.M)),this.F&&!this.v.length&&(this.F=!1,Common.e.a().b("msospPointerMove",this.u,this.O),this.w&&(this.w.b().g(this.H),this.w.b().a(this.H),this.w.f().c(this.N))))},bm:function(n){n.o(this.J);Array.remove(this.v,n);this.V(!1)},bi:function(n){var t=n;this.bm(t)},bk:function(n){this.A=!0;this.cE("showFullPresenceTooltip",null,null);this.D=!0;for(var t=0,i=this.v.length;t<i;t++)this.v[t].Y(n);return!1},bj:function(n){this.A=!0;for(var t=0,i=this.v.length;t<i;t++)this.v[t].be(n);return!1},bg:function(n){this.cE("showPresenceTooltip",null,null);for(var t=0,i=this.v.length;t<i;t++)this.v[t].bd(n);return!1},bb:function(n){var i,t,r;for(this.A=!1,i=!0,this.D&&!this.U(n)&&(i=this.L(n.get_clientPoint()),this.cE(this.B?"showPresenceTooltip":"hidePresenceTooltip",null,null)),t=0,r=this.v.length;t<r;t++)this.v[t].X(n,i);return!1},bl:function(n,t){var i,r;t.a===3?(i=t.b,this.D=!0,r=Common.f.b(Common.f.a(this.u),i.get_clientPoint()),(this.I&&r||!r&&!this.U(i))&&this.bb(i)):t.a===2&&(this.D=!1)},bf:function(){this.bc()},bh:function(){this.bc()},bc:function(){this.t();for(var n=0,t=this.v.length;n<t;n++)this.v[n].t()}};_Ewa.pw=function(n){_Ewa.pw.initializeBase(this,[!1]);this.a=n;this.c=null;this.b=null};_Ewa.pw.prototype={c:null,a:null,d:function(){return this.c||{}},e:function(n){return this.b=this.c,this.c=n,this.cE("userPresenceChanged",null,null),n},b:null,dispose:function(){this.cE("userPresenceChanged",null,null);this.cE("userLeft",null,null);this.a=null;this.c=null;this.b=null;_Ewa.co.prototype.dispose.call(this)}};_Ewa.jk=function(n,t,i){this.r=Function.createDelegate(this,this.K);this.s=Function.createDelegate(this,this.L);this.e=new _Ewa.p(!0);_Ewa.jk.initializeBase(this);this.b=new _Ewa.pw(n);this.y(n);this.g=i;this.p([]);this.c=t;this.c.e().b(this.s);_Ewa.c.a(this.c).X(this.r)};_Ewa.jk.a=function(n,t,i,r){var u=n===1?18:17;r&&i&&r.a===i.SheetName?(t.val.bq(_Ewa.i.b(i),[u]),t.val.bN(u)):t.val.bK(u)};_Ewa.jk.prototype={c:null,g:null,k:0,l:0,t:0,a:function(){return this.b.d()},q:function(n){return this.b.e(n),this.w(),n},B:function(){return this.c.c(394)},dispose:function(){this.c&&(this.c.e()&&this.c.e().c(this.s),_Ewa.c.a(this.c).W(this.r));this.A();System.a.b(this.d());System.a.b([this.b]);this.c=null;this.b=null;this.p(null);this.e=null;_Ewa.Es.prototype.dispose.call(this)},A:function(){if(this.e){for(var n=0;n<this.e.a.length;n++)this.e.a[n].dispose();this.e.f()}},x:function(n){this.a().Version===1?this.F(n):this.G(n)},F:function(n){var r,u,t,i;if(n.a().SelectedRange&&this.a().SelectedRange)for(r=this.a().SelectedRange.length,u=n.a().SelectedRange.length,t=0;t<r;t++)for(i=0;i<u;i++)if(_Ewa.eN.b(this.a().SelectedRange[t],n.a().SelectedRange[i])){this.d()[t].bc(n.f(i));return}},G:function(n){var e=0,o=0,p,s,t,i,h,c,r,l,a,w,b,u,f,v,y;if(this.a()&&this.a().Object&&n.a()&&n.a().Object)for(p=this.a().Object.length,s=n.a().Object.length,t=0;t<p;t++)if(this.a().Object[t]&&this.v(this.a().Object[t])){for(e++,i=0;i<s;i++)if(n.a().Object[i]&&this.v(n.a().Object[i])&&(o++,this.E(this.a().Object[t],n.a().Object[i])&&(h=this.f(e),c=n.f(o),h&&c))){h.bc(c);return}}else if(this.a().Object[t]&&(!this.a().Object[t].ObjectType||this.a().Object[t].ObjectType===2))for(r=0;r<s;r++)if(n.a().Object[r]&&(!n.a().Object[t].ObjectType||n.a().Object[t].ObjectType===2)&&this.a().Object[t].ObjectId===n.a().Object[r].ObjectId&&(l=this.o(this.a().Object[t].ObjectId),a=n.o(this.a().Object[t].ObjectId),l&&a)){l.k(a);return}if(n.a().SelectedRange&&this.a().SelectedRange)for(w=this.a().SelectedRange.length,b=n.a().SelectedRange.length,u=0;u<w;u++)for(f=0;f<b;f++)if(_Ewa.eN.b(this.a().SelectedRange[u],n.a().SelectedRange[f])&&(v=this.f(e+u),y=n.f(o+f),v&&y)){v.bc(y);return}},E:function(n,t){return!!n&&!!t&&t.ObjectType===n.ObjectType&&(n.ObjectType===1||this.B()&&n.ObjectType===3)&&!n.ObjectId.localeCompare(t.ObjectId)},f:function(n){return n>=0&&this.d().length>n?this.d()[n]:null},i:function(n){for(var t=0,i=this.d().length;t<i;t++)this.d()[t].bw(n)},o:function(n){return n&&this.e.d(n)?this.e.b[n]||null:null},j:function(n,t){var r,i,u;if(n)r=this.e.b[t]||null,r&&r.j(!0);else for(i=0;i<this.e.a.length;i++)u=this.e.a[i],u&&u.j(!1)},z:function(n){_Ewa.yB.a(this,n)},u:function(n,t){if(n<t)return this.d()[n];if(!this.h()||!this.c||!this.g)return null;var i=new _Ewa.dB(this.h(),this.c,this.g);return Array.add(this.d(),i),i},M:function(){for(var t,f,e,i,r=this.d().length,u=this.a().SelectedRange?this.a().SelectedRange.length:0,o=this.c.e().a(),n=0;n<u;n++)(t=this.u(n,r),t&&this.a().SelectedRange[n])&&(this.a().SelectedRange[n].NamedObjectName?t.z([18,17]):(t.bd(this.a().SelectedRange[n],this.a().PresenceType),_Ewa.jk.a(this.a().PresenceType,f={val:t},this.a().SelectedRange[n],o),t=f.val));for(e=!!this.b&&!!this.b.b&&this.b.b.PresenceType!==this.b.d().PresenceType,i=e?0:u;i<r;i++)this.d()[i].z([this.b.b.PresenceType===1?18:17])},v:function(n){if(n&&n.ObjectId&&(this.C(n.ObjectType)===1||this.B()&&this.C(n.ObjectType)===2)){var t=this.c.l().bk(n.ObjectId);if(t)return _Ewa.i.k(t)}return null},N:function(){for(var u,f,n,e,o,l,i,t,a,v,s,y,h=this.d().length,r=this.c.e().a(),p=this.a().SelectedRange?this.a().SelectedRange.length:0,w=this.a().Object?this.a().Object.length:0,c=0;c<h;c++)this.d()[c].z([18,17]);for(this.H(),u=0,this.k=0,this.l=0,f=0;f<w;f++)n=this.a().Object[f],e=this.v(n),e&&(o=this.u(u,h),n.ObjectType===1?this.k++:n.ObjectType===3&&this.l++,u++,o.bd(e,n.ObjectPresenceType),_Ewa.jk.a(n.ObjectPresenceType,l={val:o},e,r),o=l.val);for(i=0;i<p;i++)if(this.a()&&this.a().SelectedRange&&(t=this.a().SelectedRange[i],!t.NamedObjectName)){if(a=!!r&&t.SheetName===r.a,v=!!_Ewa.eN.a(t,this.c,1),a&&v)continue;s=this.u(u+i,h);s.bd(t,this.a().PresenceType);_Ewa.jk.a(this.a().PresenceType,y={val:s},t,r);s=y.val}(this.t=this.D())>0&&Diag.a.a(25190625,0,50,'{{"SetAllFloatingObjectPresenceHighlights":"Success"}')},H:function(){this.D();this.A()},D:function(){var t=0,n,i;if(this.a()&&this.a().Object)for(n=0;n<this.a().Object.length;n++)i=this.a().Object[n],this.O(i)&&t++;return t},I:function(n,t){var r,i;return this.e.d(t)?(r=this.e.b[t]||null,r.a(n),r):!this.h()||!this.c||!this.g?null:(i=new _Ewa.yA(this.h(),this.c,this.g),i.a(n),this.e.c(t,i),i)},O:function(n){var r=!1,t,i;if(n&&n.ObjectId&&(!n.ObjectType||n.ObjectType===2))try{t=this.J(n);t&&(i=this.I(t,n.ObjectId),i.c(t,n.ObjectPresenceType),i.b(),r=!0)}catch(u){Diag.a.a(25190626,0,10,'{{"UpdatedFloatingObjectPresence":"Fail","Exception":"{0}"}',u.stack);throw u;}return r},J:function(n){var t,r,i;return n?(t=null,n.ObjectType===2?t=_Ewa.V.a(this.c).k(n.ObjectId):n.ObjectType||(r=this.c.l(),i=r.bk(n.ObjectId),i&&i.j&&(t=_Ewa.V.a(this.c).t(i.j))),t):null},w:function(){try{this.a().Version===1?(this.M(),Diag.a.a(25031579,0,50,'{{"SetGridHighlightPass":"V1"}')):(this.N(),Diag.a.a(25031580,0,50,'{{"FloatingObjects":"{0}","PivotTables":"{1}","QueryTables":"{2}"}',this.t,this.k,this.l))}catch(n){Diag.a.a(25031581,0,10,'{{"SetGridHighlight Exception":"{0}"}',n.stack);throw n;}},K:function(){this.w()},L:function(){this.w()},C:function(n){switch(n){case 0:return 0;case 1:return 1;case 3:return 2;case 2:return 9;default:return-1}}};_Ewa.If=function(){};_Ewa.If.a=function(){_Ewa.e.a(function(n){var t=n.a();t.b(_Ewa.GR.$$(_Ewa.hS),154,new _Ewa.yD(n));_Ewa.d.c(_Ewa.k.a(_Ewa.hS,t,154,t.d()),function(i){_Ewa.ds.a(n.a()).a(new _Ewa.jj(n,t.a(_Ewa.fp,26),i.a()))},t.d())})};_Ewa.eN=function(){};_Ewa.eN.b=function(n,t){return!!n&&!!t&&n.SheetName===t.SheetName&&(!!n.NamedObjectName&&n.NamedObjectName===t.NamedObjectName||!n.NamedObjectName&&!t.NamedObjectName&&_Ewa.i.b(n).h(_Ewa.i.b(t)))};_Ewa.eN.a=function(n,t,i){var u,r;if(!t||!t.l())return null;for(u=0;u<t.l().d();u++)if(r=t.l().f(u),r&&r.c===i&&r.b&&r.b.m(_Ewa.i.b(n))&&_Ewa.h.a(r.f,n.SheetName,!0))return r;return null};_Ewa.pv=function(){};_Ewa.pv.a=function(n,t,i){if(!t)return null;var r=n.p();return new Sys.UI.Point(t.x+r.a*(i?1:-1),t.y+r.b*(i?1:-1))};_Ewa.yA.registerClass("_Ewa.yA",null,_Ewa.Id,Sys.IDisposable);_Ewa.yB.registerClass("_Ewa.yB",_Ewa.Es);_Ewa.gV.registerClass("_Ewa.gV",_Ewa.co,Common.App.CollabControls.i,Sys.IDisposable);_Ewa.lb.registerClass("_Ewa.lb",_Ewa.co,_Ewa.Ie,Sys.IDisposable);_Ewa.dB.registerClass("_Ewa.dB",_Ewa.kB);_Ewa.gW.registerClass("_Ewa.gW",null,Sys.IDisposable);_Ewa.jj.registerClass("_Ewa.jj",_Ewa.co,_Ewa.je);_Ewa.es.registerClass("_Ewa.es",_Ewa.co,_Ewa.hS,Sys.IDisposable,Common.fb);_Ewa.yD.registerClass("_Ewa.yD",_Ewa.lg.$$(_Ewa.hS));_Ewa.yE.registerClass("_Ewa.yE",_Ewa.co,_Ewa.Ie,Sys.IDisposable);_Ewa.pw.registerClass("_Ewa.pw",_Ewa.co);_Ewa.jk.registerClass("_Ewa.jk",_Ewa.yB);_Ewa.gV.a=null;_Ewa.dB.b=null;_Ewa.dB.a=null;_Ewa.es.b=null;_Ewa.If.a();Type.registerNamespace("_Ewa");_Ewa.lc=function(n,t,i){this.g=Function.createDelegate(this,this.i);_Ewa.lc.initializeBase(this,[!1]);this.e=t;this.h=n;this.d=i;this.b=[];i.c(this.g);this.e.a().b(_Ewa.jl,225,this)};_Ewa.lc.a=function(n,t){var i,r,u,f;return!n.length&&!t.length?"":t.length?t.length===1?(i=_Ewa.b.a().c(66),String.format(i,t[0].UserName)):(r=_Ewa.b.a().c(67),String.format(r,t.length)):n.length===1?(u=_Ewa.b.a().c(68),String.format(u,n[0].UserName)):(f=_Ewa.b.a().c(69),String.format(f,n.length))};_Ewa.lc.prototype={e:null,h:null,d:null,b:null,f:null,c:null,a:function(n,t){var i,r,u,f;return this.b=[],this.d.d(n,t,u={val:i},f={val:r}),i=u.val,r=f.val,Array.addRange(this.b,i),Array.addRange(this.b,r),_Ewa.lc.a(i,r)},dispose:function(){this.d.e(this.g);this.c&&(System.a.a(this.c),this.c=null);_Ewa.Es.prototype.dispose.call(this)},i:function(n,t){var o,l,a,f,y,p;if(t.b){var i=[],r=[],u=_Ewa.c.a(this.e).a(),e=!(u.d()===2||u.d()===128),h=e?_Ewa.i.a(u.a(),this.e):u.c().a(),c=t.b;for(o in c)l={key:o,value:c[o]},a=l.key,this.d.a(h,e,i,r,a);for(var v=this.b,w=v.length,s=0;s<w;++s)f=v[s],Array.contains(i,f)||Array.contains(r,f)||this.d.a(h,e,i,r,f.UserID);this.b=[];Array.addRange(this.b,i);Array.addRange(this.b,r);this.f&&(System.a.a(this.c),this.c=null,this.f=null);y=_Ewa.lc.a(i,r);this.c=new _Ewa.dU;p=this;this.f=_Ewa.d.cw($$sc.a.b(1),function(){p.h.d(y,"polite")},this.c.a(),3)}}};_Ewa.lc.registerClass("_Ewa.lc",_Ewa.Es,_Ewa.jl);Type.registerNamespace("_Ewa");_Ewa.yF=function(){};_Ewa.yF.b=function(){_Ewa.e.a(_Ewa.yF.a)};_Ewa.yF.a=function(n){var t=n.a(),i=_Ewa.k.b(_Ewa.cy,n.a(),206,207);t.c(_Ewa.je,25,function(r){_Ewa.d.cw(i,function(i){var u=t.a(_Ewa.jl,225)||new _Ewa.lc(i.a(),n,r)},t.d(),3)})};_Ewa.yF.b();Type.registerNamespace("_Ewa");_Ewa.In=function(){};_Ewa.In.a=function(){_Ewa.e.a(function(n){_Ewa.ds.a(n.a()).a(new _Ewa.yN(n,n.a().a(_Ewa.fp,26)))})};_Ewa.yN=function(n,t){this.f=Function.createDelegate(this,this.k);this.d=Function.createDelegate(this,this.n);this.h=Function.createDelegate(this,this.m);this.g=Function.createDelegate(this,this.l);this.i=Function.createDelegate(this,this.o);_Ewa.yN.initializeBase(this,[!1]);this.a=n;this.c=t;this.a.d().d(this.i);this.c.c(this.g);this.c.d(this.h);this.c.a()};_Ewa.yN.prototype={b:null,a:null,c:null,e:!1,j:function(){return!!this.b&&this.b.b()===2},dispose:function(){this.b&&this.b.l(this.d);this.a&&this.a.d().g(this.i);this.c&&(this.c.e(this.g),this.c.f(this.h));this.b=null;this.a=null;_Ewa.Es.prototype.dispose.call(this)},q:function(n){this.b&&this.b.l(this.d);this.b=$$as(AppRealtimeChannel.b,n);this.b.t(this.d)},n:function(n,t){var r,i,s,u,f,e,o,h;if(this.e=!0,t.a===1){if(r=$$as(Array,t.b),!r||this.p(r)){this.a.b().Y(r,null);return}return}if(i=$$as(Object,t.b),i)if(t.a)t.a===4?(e=i.Id,this.a.b().c()&&!!e&&_Ewa.f.u(this.a.d().a(),e,this.f,null,null)):t.a===8&&(o=i.SessionId,h=i.SeqNum,this.a.b().c()&&!!o&&_Ewa.f.v(this.a.d().a(),o,h,this.f,null,null));else{if(s=i.latestStateId,u=null,"sessionSiteIdentifier"in i&&(u=i.sessionSiteIdentifier),f=this.a.b().G(),f!==u){Diag.a.a(22905367,0,50,"RTC ContentUpdate session identifier mismatch. Received: {0}. Expected: {1}. Ignoring this update.",u,f);return}this.a.b().Q(s,"ContentRefreshManager.OnUpdateNotificationReceived");this.a.b().O(3e4)}},k:function(n){var t=n.Errors;_Ewa.g.d(t)&&(this.a.c(197)&&(t=_Ewa.g.f(t,[297,481,513],"ContentRefreshManager")),this.a.b().o(t))},o:function(){this.j()&&this.e&&this.a.b().O(3e4)},m:function(){this.e=!1;this.a.b().O(500)},l:function(n,t){this.q(t.a)},p:function(n){for(var r,u,i=n,f=i.length,t=0;t<f;++t)if(r=i[t],u=this.a.b().W(r),!u)return!0;return!1}};_Ewa.yN.registerClass("_Ewa.yN",_Ewa.Es);_Ewa.In.a();Type.registerNamespace("_Ewa");_Ewa.Ad=function(n,t,i){_Ewa.Ad.initializeBase(this,[t,i]);this.h=n};_Ewa.Ad.prototype={h:null,c:null,g:function(){if(this.c)return this.c.a;this.c=new($$sc.A.$$(String));var n=this;return Common.a.b.e(function(){var t=n.h.j().FullDocumentInfo.Cid;Diag.a.b(9000733,333,!!t,"Cid should not be null for SkypeChat");n.c.b(t)}),this.c.a}};_Ewa.qp=function(n,t,i,r,u,f){_Ewa.qp.initializeBase(this,[t,i,r,u,f]);this.t=n;this.Z=i};_Ewa.qp.prototype={t:null,Z:null,l:function(){var n,t;_Ewa.r.a().a()?(n=_Ewa.hD.a(this.t),n&&n.a()&&n.a().h()):(t=_Ewa.bp.b(this.t),t&&t.h(Common.X.a.a,!0))}};_Ewa.Ae=function(){};_Ewa.Ae.a=function(n){var t=_Ewa.k.a(_Ewa.hS,n.a(),154,$$sc.e.a),i=new($$sc.A.$$(Common.fc)),r=new($$sc.A.$$(Common.dP)),u,f,e,o;return n.a().a(_Ewa.fp,26).h(r.h),t.CW(function(){i.b(t.a().h())}),u=t.CWR(Common.fb,function(n){return n.a()}),f=$$sc.a.a(Common.fa,new _Ewa.Af),Common.Utils.a.a().b(Common.App.SkypeChat.f).a().b(function(){return new _Ewa.Ad(n,Common.Utils.b.a(Common.App.BasicChat.c,Common.Utils.a.a().c(Common.App.BasicChat.c)),Common.Utils.b.a(Common.App.BasicChat.b,Common.Utils.a.a().c(Common.App.BasicChat.b)))}),e=new Common.App.SkypeChat.i(r.a,i.a,u,Common.Utils.a.a().a(Common.App.SkypeChat.f),f),o=$$sc.a.a(Common.fg,new Common.App.SkypeChat.k(r.a,u,i.a,f)),new _Ewa.qp(n,Common.a.c(),Common.Utils.a.a().a(Common.App.SkypeChat.e),o,Common.ec.a(n.r(),null),e)};_Ewa.Af=function(){};_Ewa.Af.prototype={a:function(n){var r=n.key,i=n.value,u=i.SupportsChat?4:0,t;return t=new Common.cx,t.i=r,t.o=i.ChatThreadId,t.n=i.ChatThreadDiscoveryUri,t.q=i.InChat,t.m=i.Cid,t.j=new Common.cm(u),t}};_Ewa.Ag=function(n,t){this.c=n;this.a=t};_Ewa.Ag.prototype={c:null,a:null,b:!1,r:function(){return!1},p:function(n,t,i){var f=!0,u=32,r=t.a,e;return this.b?r===Common.X.a.b?u=this.a.b(Common.X.a.b,2,i):r===Common.X.a.c?u=this.a.b(Common.X.a.c,2,i):r===Common.X.a.d&&(u=this.a.b(Common.X.a.d,2,i)):r===722290388?(e=this,new Common.App.SkypeChat.g(new($$sc.v.$$(Common.App.SkypeChat.h))(function(){return e.c.a()}),Common.Utils.a.a().c(Common.App.BasicChat.c),null).g(),this.b=!0):f=!1,f&&u!==2?$$sc.a.a(Boolean,!0):_Ewa.G.a(r)},o:function(n,t){var r=!1,i=t.a;return i===722290388&&(r=!0),this.b&&(i===1478537812||i===Common.X.a.b||i===Common.X.a.c||i===Common.X.a.d)&&(r=!0),r},q:function(){return!1}};_Ewa.qq=function(n){this.m=Function.createDelegate(this,this.p);_Ewa.qq.initializeBase(this,[n])};_Ewa.qq.a=function(n){_Ewa.Q.a(142,new _Ewa.qq(n))};_Ewa.qq.prototype={k:function(){_Ewa.bp.b(this.h)?this.o():_Ewa.bp.a(this.h).b(this.m)},p:function(){_Ewa.bp.a(this.h).a(this.m);this.o()},o:function(){var n=this,t=new($$sc.v.$$(_Ewa.qp))(function(){return _Ewa.Ae.a(n.h)});this.l([new _Ewa.Ag(t,Common.a.c())],null)}};_Ewa.Ad.registerClass("_Ewa.Ad",Common.App.SkypeChat.q,Common.App.SkypeChat.f);_Ewa.qp.registerClass("_Ewa.qp",Common.App.SkypeChat.u);_Ewa.qq.registerClass("_Ewa.qq",_Ewa.Q);Type.registerNamespace("_Ewa");_Ewa.Jm=function(){};_Ewa.Jm.a=function(){_Ewa.e.a(_Ewa.qq.a)};_Ewa.Jm.a();Type.registerNamespace("_Ewa");_Ewa.pA=function(n){this.p=Function.createDelegate(this,this.t);this.n=Function.createDelegate(this,this.v);_Ewa.pA.initializeBase(this,[!1]);this.m=n;this.m.L(this.n);this.m.b().bk(this.n);var t=this;n.a().c(Common.ff,38,function(n){n.a(t.n)})};_Ewa.pA.a=function(n){n.a().b(_Ewa.fp,26,new _Ewa.pA(n))};_Ewa.pA.prototype={m:null,o:null,r:null,c:function(n){this.cG("connectionCompleted",n)},e:function(n){this.cH("connectionCompleted",n)},i:function(n){this.cG("rtcInitialized",n)},k:function(n){this.cH("rtcInitialized",n)},d:function(n){this.cG("connectionLostEventKey",n)},f:function(n){this.cH("connectionLostEventKey",n)},l:null,b:function(){return this.l},q:!1,j:function(){return this.q},dispose:function(){this.l&&this.l.j(this.p);this.m&&this.m.M(this.n);this.m=null;this.l=null;_Ewa.co.prototype.dispose.call(this)},h:function(n){var t=this;_Ewa.d.c(this.s().a,function(t){n(t.a())},this.cF())},g:function(n,t,i){this.q=i;this.u(n,t)},a:function(){this.l&&(this.cE("rtcInitialized",null,null),this.l.b()===2&&this.o&&this.cE("connectionCompleted",new _Ewa.mE(this.l),this.o))},u:function(n,t){var r=this,i=this;_Ewa.d.cw(_Ewa.d.ts(_Ewa.o.c(36,4,!1),function(){return _Ewa.o.c(10,0,!1)},this.cF(),3,$$sc.c.a),function(){i.l=AppRealtimeChannel.j.b(n,t,i.m.f().UserSessionId,Common.a.cR,Common.a.d,Common.a.m,2,i.m.r(),!1,Common.a.bS,Common.a.cQ,null,null,null,null);i.s().b(i.l);i.cE("rtcInitialized",null,null);var r=$$as(AppRealtimeChannel.b,i.l);r&&(r.g(i.p),r.n())},this.cF(),3)},t:function(n,t){t.a===2?(this.cE("connectionCompleted",new _Ewa.mE(this.l),t),this.o=t):t.b!==2&&t.a||(this.o=null,this.cE("connectionLostEventKey",null,null))},v:function(){if(this.l){var n=$$as(AppRealtimeChannel.b,this.l);n&&(Diag.a.a(36573253,0,50,"RealTimeChannelController.OnWorkbookClosed: disconnecting from RTC"),n.o(),n.j(this.p))}this.l=null},s:function(){return this.r||(this.r=new($$sc.A.$$(Common.dP)))}};_Ewa.pA.registerClass("_Ewa.pA",_Ewa.co,_Ewa.fp,_Ewa.GK);Type.registerNamespace("_Ewa");_Ewa.Im=function(){};_Ewa.Im.a=function(){_Ewa.e.a(_Ewa.pA.a)};_Ewa.Im.a();Type.registerNamespace("_Ewa");_Ewa.yt=function(n,t,i){this.r=Function.createDelegate(this,this.x);this.p=Function.createDelegate(this,this.v);this.q=Function.createDelegate(this,this.w);_Ewa.yt.initializeBase(this,[n,null]);var r="<div id='notificationBody'>\r\n<div class='clip16x16' id='notificationUserImage'><img class='{0}' src='{1}' id='singleUserImage'/><img class='{2}' src='{3}' id='multiUserImage'/><\/div>\r\n<span class='ewa-new-user-notification-text' id='notificationText'><\/span>\r\n<div class='clip16x16' id='notificationImage'><img class='{4}' src='{5}' alt='{6}' title='{6}' /><\/div>\r\n<\/div>\r\n";this.f=t;r=String.format(r,"ewaboot_presenceheads",_Ewa.o.a(3),"ewaother_PlaceContacts_16x16x32",_Ewa.o.a(3),"ewaother_ClosePaneGlyph_16x16x32",_Ewa.o.a(3),this.f.a(482));this.bL().innerHTML=r;this.d=_Ewa.a.a(n,"notificationBody");this.a=_Ewa.a.a(n,"notificationText");this.e=_Ewa.a.a(n,"notificationImage");this.b=_Ewa.a.a(n,"notificationUserImage");this.l=_Ewa.a.a(n,"singleUserImage");this.j=_Ewa.a.a(n,"multiUserImage");_Ewa.a.p(this.a,"alert",null,null,null);this.bR().a("click",this.q);this.i=this.bO.a(this.e);this.i.a("click",this.p);this.o=i};_Ewa.yt.prototype={d:null,a:null,e:null,b:null,l:null,j:null,i:null,m:null,c:null,g:!1,k:null,o:null,f:null,dispose:function(){System.a.b([this.i,this.k]);this.d=this.a=this.e=null;this.b=null;_Ewa.Cv.prototype.dispose.call(this)},h:function(n){n?this.set_visible(!0):(this.set_visible(!1),this.u())},y:function(n){this.bL().className=n?"ewa-popup-rtl ewa-new-user-notification":"ewa-popup-ltr ewa-new-user-notification";this.bL().dir=n?"rtl":"ltr";n?(this.d.insertBefore(this.a,this.b),this.d.insertBefore(this.e,this.a),this.b.style.marginLeft="10px"):(this.d.insertBefore(this.b,this.a),this.d.insertBefore(this.a,this.e),this.b.style.marginRight="10px")},n:function(n){var r,i,t;if(n){for(r=!this.m,i=new($$sc.s.$$(Boolean)),t=0;t<n.length;t++)r?this.s(n[t].User.UserID):this.m.c(n[t].User.UserID)||(this.z(n[t]),this.s(n[t].User.UserID)),i.b(n[t].User.UserID,!0);this.m=i}},s:function(n){var t={};t.a=this.o;t.b=n;t.c="JoiningUser";_Ewa.w.a().a(22,t,!0)},z:function(n){if(this.c){var t=!_Ewa.h.e(this.c.User.UserID,n.User.UserID,!1);t||this.g||(this.g=!0,this.t())}else this.c=n,this.t()},t:function(){var n="";this.g?(n=this.f.a(481),this.b.style.backgroundColor="",_Ewa.a.b(this.l,!1),_Ewa.a.b(this.j,!0)):this.c&&(n=String.format(this.f.c(5),this.c.User.UserName),this.b.style.backgroundColor=this.c.UserColor,_Ewa.a.b(this.l,!0),_Ewa.a.b(this.j,!1));this.a.innerText=n;System.a.a(this.k);this.k=_Ewa.u.a().a(this.r,5e3,!0,!1);this.h(!0)},u:function(){this.c=null;this.g=!1},x:function(){this.h(!1)},w:function(n){this.h(!1);_Ewa.v.a(n,!0)},v:function(n){this.h(!1);_Ewa.v.a(n,!0)}};_Ewa.gT=function(n,t,i,r,u){var o,f,s,e;if(this.i=Function.createDelegate(this,this.F),this.h=Function.createDelegate(this,this.E),_Ewa.gT.initializeBase(this,[n]),this.a=t,this.k=i,this.j=r,this.l=u,this.a.b().y(this.h),this.a.L(this.i),o=document.createElement("div"),_Ewa.c.a(this.a).J().appendChild(o),this.d=new _Ewa.yt(o,u,this.a.f().UserSessionId),this.d.h(!1),this.d.y(this.a.u()),f=this.a.b().m(),this.k.j())for(s=f.length,e=0;e<s;e++)if(f[e].User.UserID===t.j().ClientId){this.d.n([f[e]]);break}this.d.n(f)};_Ewa.gT.a=function(n){var i=null,t;return n&&(t=n.SelectedRange,i=t&&t.length>0?t[0]:null),i};_Ewa.gT.prototype={d:null,v:function(){return this.a.c(394)},w:function(){return!this.Q()&&!this.e},j:null,k:null,l:null,a:null,dispose:function(){var n=this.a;n&&(n.b().z(this.h),n.M(this.i),n.g().t(46),_Ewa.kY.a(n));RealtimePresenceUI.b.prototype.dispose.call(this)},y:function(n){return this.S(n)},z:function(n){return this.X(n)},x:function(n){return this.R(n)},q:function(){var i=this.a.b().m(),r,u,n,t;if(!i)return new Array(0);for(r=i.length,u=new Array(r),n=0;n<r;n++)t=i[n],u[n]=new Common.cx(t.User.UserID,t.User.UserName,t.UserColor,new Common.cm(1),null,null,null,null,!1,!1,!1);return u},u:function(){},s:function(n,t){var i=_Ewa.gT.a(t),r,u;i&&(r=i.SheetName,r&&(u=_Ewa.i.b(i),this.a.e().m(this.a.e().e(r)),_Ewa.c.a(this.a).P(u,u.g(),3)))},o:function(n,t){var i=_Ewa.gT.a(t);return!!i&&!i.NamedObjectName},p:function(n,t,i){var o=i,f=_Ewa.gT.a(o),u,l,g,e,a,v,y,tt;if(!f)return"";var r="",p=f.SheetName,h=$$as(_Ewa.z,this.a.i()),w=!h||p!==h.a;w&&(r=String.format("{0}",p));var b="!",k=w?b.toString():"",s=!1;try{if(!(o.Version===1)&&o.Object){for(var d=o.Object,it=d.length,c=0;c<it;++c)if(u=d[c],l=this.D(u),this.B(u)||this.A(u)||l){if(g=this.a.l(),e=g.bk(u.ObjectId),e){r=h&&h.a!==e.f?String.format("{0}{1}",e.f,b):"";r+=l?e.b.toString():e.a;s=!0;break}}else if(this.C(u)&&(a=_Ewa.V.a(this.a).k(u.ObjectId),a)){r=a.a().h;s=!0;break}Diag.a.a(25031572,0,50,"PresenceObject")}!s&&f.NamedObjectName&&o.Version===1&&(v=_Ewa.V.a(this.a).b(f.NamedObjectName),v&&(r+=k+v.a().h,s=!0));s||f.NamedObjectName||(y=_Ewa.i.b(f),y.v()&&(r+=k+y))}catch(nt){Diag.a.a(25031575,0,10,'{{"ConvertUserPresenceToStatusString Exception":"{0}"}',nt.stack);throw nt;}return tt=this.l.a(872),String.format("{0} {1}",tt,r)},t:function(){if(_Ewa.r.a().a()){var n=_Ewa.hD.a(this.a);n&&n.a()&&n.a().i()}else this.j.h(this.b.a.f,!0)},E:function(){var n,r;Diag.a.a(23643289,0,50,"EwaPeoplesWellControl::OnUserListUpdated");this.m();this.d.n(this.a.b().m());n="";for(var i=this.a.b().m(),u=i.length,t=0;t<u;++t)r=i[t],n+=r.User.UserID+";";_Ewa.h.c(n)||Diag.a.a(25049093,0,50,"EwaPeoplesWellControl.OnUserListUpdated: UserList updated [{0}].",n)},F:function(){this.a.a().e(Sys.IDisposable,45)},B:function(n){return!!n&&!!n.ObjectId&&n.ObjectType===this.g(1)},A:function(n){return!!n&&!!n.ObjectId&&n.ObjectType===this.g(0)},D:function(n){return!!n&&!!n.ObjectId&&this.v()&&n.ObjectType===this.g(2)},C:function(n){return!!n&&!!n.ObjectId&&n.ObjectType===this.g(9)},g:function(n){switch(n){case 0:return 0;case 1:return 1;case 2:return 3;case 9:return 2;default:return-1}}};_Ewa.ys=function(n,t){this.b=n;this.a=t};_Ewa.ys.prototype={b:null,a:null,r:function(n,t){return t===this.a.b.a.a&&this.a.w()},p:function(n,t,i){var u=this.a.b,f=null,r=t.a,e;return Diag.a.a(23643291,0,50,"EwaPeoplesWellControlHandler::ExecuteCommand: {0}",r),r===u.a.a?(e=this,f=_Ewa.d.c($$sc.a.b(0),function(){e.a.U()},this.b.k())):r===u.a.d?this.a.y(i):r===u.a.c?this.q(n,"PopulatePeoplesWellControl",i):r===u.a.e?this.a.z(i):r===u.a.g?this.a.m():f=_Ewa.G.a(r),f||$$sc.a.a(Boolean,!0)},o:function(n,t,i){var r=this.a.b,f=!1,u=t.a;return u===r.a.a||u===r.a.g?f=!0:(u===r.a.d||u===r.a.c||u===r.a.e)&&(f=!!i),f},q:function(n,t,i){return t==="PopulatePeoplesWellControl"?(this.a.x(i),!0):!1},dispose:function(){this.b&&this.b.g()&&this.b.g().e(this);this.b=null}};_Ewa.kY=function(n){this.m=Function.createDelegate(this,this.r);_Ewa.kY.initializeBase(this,[n])};_Ewa.kY.a=function(n){_Ewa.Q.a(46,new _Ewa.kY(n))};_Ewa.kY.prototype={dispose:function(){var n=this.h;n&&n.D(this.m);_Ewa.Q.prototype.dispose.call(this)},k:function(){Diag.a.a(23643293,0,50,"PeoplesWellCommandHandlerFactory::CreateCommandHandlersAsync. SessionAction: {0}, EditMode {1}",this.h.b().c(),this.h.q());this.h.b().c()&&this.h.q()?this.o():this.h.B(this.m)},r:function(n,t){t.b||this.o()},o:function(){var n=this.h.a(),t=this;n.c(_Ewa.fp,26,function(i){n.c(_Ewa.bB,53,function(r){_Ewa.d.cw(_Ewa.k.a(Object,n,151,t.cF()),function(){t.p(i,r)},t.cF(),3)})})},p:function(n,t){var r=null,i=this;r=function(){n.k(r);var f=t.k(_Ewa.o.a(3),"ewaboot_presenceheads",_Ewa.o.a(3),"ewaboot_presenceheads32",_Ewa.o.a(3),"ewaboot_presenceheadswhite"),u=new _Ewa.gT(RealtimePresenceUI.a.a(f,i.h.j().ClientId,$$as(AppRealtimeChannel.b,n.b()),!1),i.h,n,t,_Ewa.b.a());i.h.a().b(Sys.IDisposable,45,u);i.l([new _Ewa.ys(i.h,u)],null)};n.i(r);n.a()}};_Ewa.yt.registerClass("_Ewa.yt",_Ewa.Cv);_Ewa.gT.registerClass("_Ewa.gT",RealtimePresenceUI.b);_Ewa.kY.registerClass("_Ewa.kY",_Ewa.Q);Type.registerNamespace("_Ewa");_Ewa.HU=function(){};_Ewa.HU.a=function(){_Ewa.e.a(_Ewa.kY.a)};_Ewa.HU.a();