/*! Version=16.0.9321.5050 */
function $c(){}Type.registerNamespace("Common.App.InsertFile");Common.App.InsertFile.a=function(n,t){this.Q=Function.createDelegate(this,this.bp);Common.App.InsertFile.a.initializeBase(this);this.O=n;this.bZ=!1;this.y=!1;this.q=this.W();this.k(1,this.R());this.K(this.X(),this.Q);t&&this.bf();this.bI=!1};Common.App.InsertFile.a.a=function(n){var t=document.getElementById("errorText");t.innerText=n;t.style.display="inline-block"};Common.App.InsertFile.a.prototype={O:null,a:null,bQ:function(){this.a.a||Diag.a.a(25798091,322,10,"UploadFrame.FileInputElement is null");var n=this.a.a.value;return n?!0:(Common.App.InsertFile.a.a($a.cA),!1)},bp:function(n){n===1&&this.Y()?(this.cg(),this.O.f(this.a,this.cx)):n||this.j()},bf:function(){this.a=this.be(document.getElementById("uploadFrameContainer"),this.O);this.a.a||Diag.a.a(25798092,322,15,"UploadFrame.FileInputElement is null")},dispose:function(){this.a=null;CommonUI.b.prototype.dispose.call(this)}};Common.App.InsertFile.b=function(n,t,i){this.s=Function.createDelegate(this,this.G);this.r=Function.createDelegate(this,this.Q);this.y=Function.createDelegate(this,this.P);this.z=n;this.E=t;this.d=i;this.e=!1;this.u=!0;this.R();this.t=this.d.a("NativeFileOpenDialogIsEnabled")};Common.App.InsertFile.b.prototype={E:null,z:null,d:null,e:!1,m:null,u:!1,b:null,t:!1,A:0,B:0,C:0,D:0,i:null,Q:function(n){if(this.b=n,!this.e){if(this.u){if(this.t&&Common.c.k()){this.i=n.z(this.y);return}if(this.i=n.z(null),!this.o(this.i,n))return}this.f(n,null)}},P:function(n){this.o(n,this.b)&&((Common.c.k()||Common.c.c())&&(this.i=n),this.f(this.b,null))},n:function(){this.m&&this.m()},R:function(){this.A=0;this.B=this.d.c("Box4UploadRetryCount",20);this.C=this.d.c("Box4UploadRetryDelayStart",200);this.D=this.d.c("Box4UploadRetryDelayMax",3200);this.b&&(this.b.dispose(),this.b=null)}};Common.App.InsertFile.c=function(n,t,i,r,u,f,e,o){this.t=Function.createDelegate(this,this.G);this.$$d_uploadResponseReceived=Function.createDelegate(this,this.uploadResponseReceived);this.u=Function.createDelegate(this,this.H);this.v=Function.createDelegate(this,this.K);this.f=n;this.p=t;this.m=i;this.k=r;this.n=f;this.i=e;this.h=!1;this.b=document.createElement("iframe");this.b.className=u;this.b.id=u;this.k&&(this.b.style.visibility="visible",this.b.style.height="30px",this.b.setAttribute("frameborder","0"));this.g=this.v;Common.j.b(this.b,"load",this.g);o&&this.x()};Common.App.InsertFile.c.prototype={r:"FileUpload.ashx",b:null,l:!1,p:null,m:null,j:null,f:null,c:null,a:null,g:null,d:null,k:!1,n:null,i:null,q:!1,h:!1,o:function(){return Common.a.b?Common.a.b.a("NativeFileOpenDialogIsEnabled"):!1},J:function(){return this.b.contentWindow.location.pathname.endsWith(this.r)},z:function(n){return(Common.a.a().w(),!this.a)?(Diag.a.a(25798093,322,50,"_fileInput is null"),""):(this.o()&&Common.c.k()&&(this.j=n,this.d=this.u,Common.j.b(this.a,"change",this.d)),this.I(),this.a.value)},H:function(){this.j&&this.j(this.a.value)},I:function(){for(var n=!1;!n;)try{Diag.a.a(35939520,322,50,"UploadFrame.FileInputClick - Clicking on File input element.");this.a.click();n=!0}catch(t){Diag.a.a(0,322,10,"UploadFrame.FileInputClick Exception: {0}",t.message)}},L:function(){this.c.submit()},dispose:function(){this.q||(this.f.removeChild(this.b),Common.j.c(this.b,"load",this.g),this.g=null,this.d&&(Common.j.c(this.a,"change",this.d),this.d=null),this.b=null,this.f=null,this.c=null,this.a=null,this.q=!0,Diag.a.a(25798094,322,50,"UploadFrame disposed"))},G:function(){this.dispose()},F:function(n,t){var i=this.b.contentWindow.document.createElement("input");i.type="hidden";i.id=n;i.name=n;i.value=t;this.c.appendChild(i)},K:function(){try{if(!this.b.contentWindow.document.body)return}catch(t){this.B();return}if(this.l||this.o()&&Common.c.k()){if(!(this.o()&&Common.c.k())||this.J()){var n;n=Common.c.a()?this.b.contentWindow.document.body.innerText:this.h?this.b.contentWindow.document.body.firstChild.innerText:this.b.contentWindow.document.body.firstChild.innerHTML;this.C(n)}}else this.A()},A:function(){var n,t,i;if(!this.l){var u=this.s("uploadForm"),r=this.s("fileInput"),f=this.E();this.c=this.b.contentWindow.document.createElement("form");this.c.id=u;this.c.method="post";this.c.encoding="multipart/form-data";this.c.action=f;this.a=this.b.contentWindow.document.createElement("input");this.a.type="file";this.i&&(this.a.accept=this.i);this.a.id=r;this.a.name=r;this.k&&(n=this.b.contentWindow.document.body,n.style.margin="0",n.style.overflow="hidden",t=Common.a.a(),this.a.style.fontFamily=t.G(),this.a.style.fontSize=t.H(),this.a.style.margin="0");i=document.getElementById("__REQUESTDIGEST");i&&this.F("__REQUESTDIGEST",i.value);this.y();this.c.appendChild(this.a);this.b.contentWindow.document.body.appendChild(this.c);this.l=!0;this.p(this)}},x:function(){this.f.appendChild(this.b);this.o()&&Common.c.k()&&this.A()},E:function(){var t=new Common.bu(this.r),n;return Common.a.bI(t),this.D(t),n=t.toString(),(Common.c.c()||Common.c.k()||Common.c.l())&&(n=Common.l.m(n)),n},w:function(){var n=new Common.L(2,1,0,this.t,4);Common.a.e().a(n)}};Common.App.InsertFile.a.registerClass("Common.App.InsertFile.a",CommonUI.b);Common.App.InsertFile.b.registerClass("Common.App.InsertFile.b");Common.App.InsertFile.c.registerClass("Common.App.InsertFile.c",null,Sys.IDisposable);Type.registerNamespace("Common.App.InsertPicture");Common.App.InsertPicture.c=function(n,t){Common.App.InsertPicture.c.initializeBase(this,[n,t])};Common.App.InsertPicture.c.prototype={R:function(){return $a.cE},X:function(){return $a.cH},W:function(){return Common.App.InsertPicture.b.b()},bQ:function(){var n,t;return(this.a.a||Diag.a.a(25798095,322,10,"UploadFrame.FileInputElement is null"),n=Common.App.InsertPicture.a.b(this.a.a.value),n)?(t=Common.App.InsertPicture.a.c(n),Common.App.InsertFile.a.a(t),!1):!0}};Common.App.InsertPicture.a=function(n,t,i){Common.App.InsertPicture.a.initializeBase(this,[n,t,i])};Common.App.InsertPicture.a.c=function(n){switch(n){case 1:return $a.O;case 2:return $a.cI;default:return""}};Common.App.InsertPicture.a.d=function(n){for(var i=n.toLowerCase(),t=0;t<Common.App.InsertPicture.a.a.length;++t)if(i.endsWith(Common.App.InsertPicture.a.a[t]))return!0;return!1};Common.App.InsertPicture.a.b=function(n){return n?Common.App.InsertPicture.a.d(n)?0:2:1};Common.App.InsertPicture.a.prototype={c:null,j:null,T:function(){return Common.a.a().c()},o:function(n,t){var i=Common.App.InsertPicture.a.b(n),r,u;return i?(t.w(),i===2&&(r=Common.App.InsertPicture.a.c(i),u=this.H(i),this.U(u,r)),!1):!0},f:function(n,t){Diag.a.a(0,322,50,"PictureUploader.FinalizeUpload");this.m=t;this.J()&&this.V();Common.PerfMetrics.a(5576);this.j=this.T().a("LoadResource","PictureUploadTime");var i=this.K();i?this.F(n):this.n()},U:function(n,t){var i=new CommonUI.d;i.g(0);i.e(n,$a.cG,t,null)},n:function(){Diag.a.a(0,322,50,"PictureUploader.OnUploadComplete");Common.App.InsertFile.b.prototype.n.call(this);this.j&&(this.j.a(),this.j=null);this.I()&&this.S()},V:function(){this.c=new CommonUI.f;this.c.N=$a.cJ;this.c.g(5);this.c.C=!1;this.c.e(null,null,null)},S:function(){return this.c?(this.c.a(),this.c=null,!0):!1}};Common.App.InsertPicture.b=function(){};Common.App.InsertPicture.b.b=function(){return CommonUI.b.a(Common.App.InsertPicture.b.a,$a.cF,$a.O)};Common.App.InsertPicture.c.registerClass("Common.App.InsertPicture.c",Common.App.InsertFile.a);Common.App.InsertPicture.a.registerClass("Common.App.InsertPicture.a",Common.App.InsertFile.b);Common.App.InsertPicture.a.a=[".jpg",".jpeg",".png",".gif",".bmp",".tif",".tiff"];Common.App.InsertPicture.b.a="<div class='WACDialogRow' id='block1'> <label id='labelText' class='WACDialogLabel' >{0}<\/label> <\/div> <div class='WACDialogRowNoBreak' id='block2'> <div id='uploadFrameContainer'><\/div> <div class='WACDialogError' id='errorText' role='alert'>{1}<\/div> <\/div>";Type.registerNamespace("_Ewa");_Ewa.uc=function(){_Ewa.uc.initializeBase(this)};_Ewa.uc.prototype={d:function(n,t){var i,u=this,r=(i=new $c,i.onBeforeElUpdated=function(n,t){return _Ewa.a.bi(n),_Ewa.a.bb(n,t),!0},i),f=window.morphdom(t,n,r);return t},c:function(n,t){var i,u=this,r=(i=new $c,i.childrenOnly=!0,i.onBeforeElUpdated=function(n,t){return _Ewa.a.bi(n),_Ewa.a.bb(n,t),!0},i);return window.morphdom(t,n,r),t}};_Ewa.nf=function(){_Ewa.nf.initializeBase(this);this.j()};_Ewa.nf.a=function(n){n.a().b(_Ewa.GR.$$(_Ewa.eC),255,new _Ewa.nf)};_Ewa.nf.prototype={b:function(){var n=this;_Ewa.d.cw(_Ewa.o.c(41,4,!1),function(){n.i(new _Ewa.uc)},this.cF(),3)}};$c.prototype={getNodeKey:null,onBeforeNodeAdded:null,onNodeAdded:null,onBeforeElUpdated:null,onElUpdated:null,onBeforeNodeDiscarded:null,onNodeDiscarded:null,onBeforeElChildrenUpdated:null,childrenOnly:!1};_Ewa.uc.registerClass("_Ewa.uc",_Ewa.DQ);_Ewa.nf.registerClass("_Ewa.nf",_Ewa.lg.$$(_Ewa.eC));Type.registerNamespace("_Ewa");_Ewa.DR=function(){};_Ewa.DR.a=function(){_Ewa.e.a(_Ewa.nf.a)};_Ewa.DR.a();Type.registerNamespace("_Ewa");_Ewa.wZ=function(n,t){this.e=Function.createDelegate(this,this.br);_Ewa.wZ.initializeBase(this,[n,!1]);this.P=t;this.d=n;this.b=Common.q.a();Common.App.InsertFile.a.prototype.bf.call(this);this.bq()};_Ewa.wZ.prototype={P:null,d:null,c:null,N:!1,b:null,be:function(n,t){return new _Ewa.kE(n,t.r,t.s,!0,this.P)},dispose:function(){this.bg();this.d=null;this.b=null;Common.App.InsertFile.a.prototype.dispose.call(this)},bQ:function(){var i=this.d.N(this.a),n=this.d.O(this.a.a.value,i),t;return n?(t=this.d.w(n).Description,this.c.innerHTML=t,this.bs(),!1):!0},Y:function(){return!0},bq:function(){this.c=document.getElementById("errorText");this.c.style.display="inline-block";this.N=!1;this.c.innerHTML="";this.bB().style.maxWidth=this.bB().currentStyle.minWidth},bs:function(){this.b.a("click",this.a.a,this.e);this.b.a("keydown",this.a.a,this.e);this.N=!0},bg:function(){this.N&&(this.b.b("click",this.a.a,this.e),this.b.b("keydown",this.a.a,this.e),this.N=!1)},br:function(){return this.c.innerHTML="",this.bg(),!1}};_Ewa.xa=function(n){this.a=n};_Ewa.xa.prototype={a:null,p:function(n,t,i){return new _Ewa.jc(this.a,t,Common.C.a(),Common.a.b,i),$$sc.a.a(Boolean,!0)},o:function(n,t){return t.a===1403967063&&this.a.q()},q:function(){return!1},r:function(){return!1}};_Ewa.oJ=function(n){_Ewa.oJ.initializeBase(this,[n])};_Ewa.oJ.a=function(n){_Ewa.Q.a(86,new _Ewa.oJ(n))};_Ewa.oJ.prototype={k:function(){this.l([new _Ewa.xa(this.h)],null)}};_Ewa.jc=function(n,t,i,r,u){this.L=Function.createDelegate(this,this.Z);_Ewa.jc.initializeBase(this,[null,i,r]);this.a=n;this.p=t;this.l=n.r().b("WebServiceCall","InsertPictureOperation");this.g=_Ewa.u.a().a(this.L,1e5,!1,!1);this.h=!1;this.k=this.a.f().InsertPictureMaxFileSizeBytes;u&&(this.x="TestOnly"in u);this.ba()};_Ewa.jc.c=function(n){return!n||_Ewa.h.a(n,"UnknownError",!0)?2:_Ewa.h.a(n,"NoFileSelectedError",!0)?1:_Ewa.h.a(n,"FileTooBig",!0)?3:_Ewa.h.a(n,"MaxConnectionsReached",!0)?5:0};_Ewa.jc.b=function(n,t,i,r){return _Ewa.bd.a(1,0,0,n,t,i,r)};_Ewa.jc.a=function(n){switch(n){case 1:return 1;case 2:return 6}return 0};_Ewa.jc.prototype={a:null,l:null,p:null,q:null,v:null,g:null,h:!1,k:0,x:!1,W:function(){return this.k/1048576},G:function(n){var t,u,i,r;this.l.a();this.g.a();t=n;u=!_Ewa.kE.a(t);u?(i=_Ewa.jc.c(t),i?(Diag.a.a(34193863,0,50,"Server returned error, response: {0}",t),this.M(i)):this.X(t)):(this.h?this.M(4):(r=new Common.dX(0,2,null,null,!1,null,null,null),r.a=8,this.v(new Common.dW(r),null,"InsertPictureWebMethod")),Diag.a.a(33863624,0,50,"Http Error occurred, isTimeoutError: {0}",this.h));Common.App.InsertPicture.a.prototype.n.call(this);this.dispose()},dispose:function(){System.a.a(this.g);this.b.w();this.a=null;this.g=null;this.b=null},f:function(n,t){Common.App.InsertPicture.a.prototype.f.call(this,n,t);var i=this,r=function(t,r){return i.q=t,i.v=r,i.l.c(),i.g.b(),i.h=!1,n.L(),$$sc.a.a(Boolean,!0)},u=this,f=function(n){var t=new _Ewa.bf(0,n,16);return t.E=!0,t.r=u.p,t};_Ewa.P.a(this.a.h(),r,f,this.p)},N:function(n){var i=-1,t=n.a;return t&&t.files&&t.files.length>0&&(i=t.files[0].size),i},O:function(n,t){var i=_Ewa.jc.a(Common.App.InsertPicture.a.b(n));return i?i===6&&this.Y(n):t!==-1&&(Diag.a.a(34193864,0,50,"Validating picture, pictureSize: {0}, maxAllowedSize: {1}, remainingWorkbookSize: {2}",t,this.k,this.a.b().T()),t>this.k?i=3:t>this.a.b().T()&&(i=7)),Diag.a.a(34193865,0,50,"Validated file on client, validation result: {0}",i),i},H:function(){return 0},K:function(){return!0},J:function(){return!0},I:function(){return!0},F:function(){},o:function(n,t){var r=this.N(t),i=this.O(n,r);return i?(this.e||i===1||this.bb(i),!1):!0},w:function(n){var u=0,t=1,i=1,r="InsertPictureUnknownError",f=null,e;switch(n){case 1:u=1205;t=0;i=502;r="InsertPictureNoFileSelected";break;case 3:t=0;i=504;r="InsertPicturePictureTooBig";f=String.format(_Ewa.b.a().c(100),this.W().toLocaleString());break;case 6:u=1209;t=0;i=508;r="InsertPictureUnsupportedFormat";break;case 7:u=1206;t=0;i=506;r="InsertPictureExceedWorkbookSize";break;case 4:u=1207;t=0;i=507;r="InsertPictureExceedUploadTimeout";break;case 5:u=1208;t=0;i=505;r="InsertPictureServiceNonDeterministicError"}return e=_Ewa.jc.b(u,t,i,r),f&&(e.Description=f),e},ba:function(){if(Diag.a.a(34193866,0,50,"Showing Insert Picture dialog"),!this.x&&(Common.c.m()||!this.a.c(336)&&Common.c.k()))this.e=!1,this.b=new _Ewa.kE(this.a.p(),this.r,this.s,!1,this.a);else{this.e=!0;var n=new _Ewa.wZ(this,this.a);this.b=n.a}},X:function(n){var t={},i;try{t=_Ewa.t.b(n);_Ewa.w.a().b(this.l.b(),t.ServerCorrelationId,_Ewa.F.toString(0),"ServerActions");!_Ewa.g.b(t.Errors)&&t.Result&&(this.a.b().Q(t.StateId,"PictureUploaderWrapper.UploadResponseReceived"),i=t.Result,_Ewa.V.a(this.a).d(1,i,!1),Diag.a.a(34193867,0,50,"Insert picture completed successfully :)"))}catch(r){Diag.a.a(25801035,0,50,"PictureUploaderWrapper.HandleSuccessCallback: got exception while try to JSON.Parse string length: {0}, errror: {1}",n?n.length:-1,r)}this.q(t,null,"InsertPictureWebMethod")},M:function(n){var i=this.w(n),t={};t.Errors=[i];this.q(t,null,"InsertPictureWebMethod")},bb:function(n){var t=this.w(n),i=new _Ewa.dQ(this.a,t);i.v(!1)},Z:function(){this.h=!0},Y:function(n){for(var i=this.a.f().InsertPicturUnsupportedExtensionsForLogging,r=n.toLowerCase(),t=0;t<i.length;++t)if(r.endsWith(i[t])){Diag.a.a(34193868,0,50,"Insert picture blocked invalid extension: {0}",i[t]);return}}};_Ewa.kE=function(n,t,i,r,u){_Ewa.kE.initializeBase(this,[n,t,i,r,"UploadFrame",u.b().e(),"image/*",!1]);this.e=u;this.h=!0;Common.App.InsertFile.c.prototype.x.call(this)};_Ewa.kE.a=function(n){return!n||_Ewa.h.a(n,"ServerUploadError",!1)};_Ewa.kE.prototype={e:null,s:function(n){return n},D:function(n){Diag.a.b(33863626,0,!!this.n,"SessionId shouldn't be null.");_Ewa.t.l(n,this.e.f());n.b("sessionId",this.n);var i=_Ewa.c.a(this.e).a(),t=_Ewa.i.c(i.D(),this.e);n.b("sheetName",this.e.e().a().a);n.b("row",t.FirstRow.toString());n.b("col",t.FirstColumn.toString())},y:function(){},B:function(){this.m("ServerUploadError")},C:function(n){this.m(n)}};_Ewa.wZ.registerClass("_Ewa.wZ",Common.App.InsertPicture.c);_Ewa.oJ.registerClass("_Ewa.oJ",_Ewa.Q);_Ewa.jc.registerClass("_Ewa.jc",Common.App.InsertPicture.a,Sys.IDisposable);_Ewa.kE.registerClass("_Ewa.kE",Common.App.InsertFile.c);Type.registerNamespace("_Ewa");_Ewa.Gw=function(){};_Ewa.Gw.a=function(){_Ewa.e.a(function(n){_Ewa.oJ.a(n)})};_Ewa.Gw.a();Type.registerNamespace("_Ewa");_Ewa.nA=function(){};_Ewa.nA.a=function(n){if(!n.clipboardItems)return!1;var t=n.clipboardItems.getItem("metadata/is-last-copy-was-external");return t?t==="1":!1};_Ewa.ec=function(){};_Ewa.ec.prototype={range:0,art:1};_Ewa.ec.registerEnum("_Ewa.ec",!1);_Ewa.CT=function(){};_Ewa.jT=function(){};_Ewa.jT.b=function(n){return CommonUI.b.a(_Ewa.jT.a,_Ewa.b.a().a(16),_Ewa.b.a().a(n?18:17),_Ewa.b.a().a(19))};_Ewa.iA=function(n,t,i,r){var u,f;this.M=Function.createDelegate(this,this.X);this.N=Function.createDelegate(this,this.Z);this.O=Function.createDelegate(this,this.ba);this.L=Function.createDelegate(this,this.V);this.P=Function.createDelegate(this,this.bd);this.E=Function.createDelegate(this,this.bc);this.D=Function.createDelegate(this,this.bb);this.C=Function.createDelegate(this,this.Y);this.w=Function.createDelegate(this,this.W);_Ewa.iA.initializeBase(this,[!1]);this.e=n;u=n.c();this.I=String.format("url({0}), auto",_Ewa.o.b.b(67));u.e().b(this.w);u.e().x(this.C);u.l().b(this.w);u.h().d(this.D);n.e().d(this.E);u.B(this.P);this.n=u.b();this.i=t;this.B=r;this.s=new _Ewa.iA.b;this.m=new _Ewa.iA.e;this.x=!1;f=this;this.l=new($$sc.v.$$($$sc.z.$$(_Ewa.dA)))(function(){return _Ewa.k.a(_Ewa.dA,u.a(),18,f.cF())});this.F=i;this.h=new _Ewa.cW(this.e.c(),this.e)};_Ewa.iA.c=function(n,t){return n<=1?n:Math.min(t,Math.ceil(Math.log(n)/Math.LN2))};_Ewa.iA.a=function(n,t){t.e=2;t.h=_Ewa.iA.c(n.length,31)};_Ewa.iA.prototype={n:null,B:null,I:null,j:0,t:null,g:null,A:null,f:null,z:null,e:null,G:!1,K:null,s:null,m:null,x:!1,h:null,c:function(){return!!(387&this.j)},b:function(){var n=this.e.a().a(),t=this.S(n);return t?this.K:null},l:null,y:function(){return this.c()?this.g:null},u:function(){return this.e.a().q()},bh:function(n){return this.e.a().r(n),n},i:null,F:null,dispose:function(){if(this.e){var n=this.e.c();n.e().c(this.w);n.e().A(this.C);n.l().c(this.w);n.h().f(this.D);this.e.e().c(this.E)}!this.l.b&&_Ewa.bT.a(this.l.a())&&System.a.a(this.l.a().a());this.e=null;this.g=null;this.A=null;this.z=null;this.f=null;_Ewa.Es.prototype.dispose.call(this)},p:function(n,t,i){var o=this.e.c(),y=t.a,s=!1,f=this.d(t,i),h=i.cutCopyText,c=i.inLoadedRange,l=i.duplicateCopy,e=i.pasteText,u=null,r,a,p,w,v;f&&(u=i.event);r=this.e.a().a();a=!0;switch(y){case-893975939:f||this.u()!==4?this.H(r,1,!f,c,l,t,h):(p=this.e.a().i(),this.H(p,i.cutCopyPasteFlag,!0,c,l,t,h));break;case 1902045020:this.H(r,2,!f,c,l,t,h);break;case 1696566924:this.T(t,o,f,r,u,e);break;case 1804571062:Diag.a.a(20821018,0,50,"PasteFormatting was clicked from ribbon");this.v(r,36,!0,t,u,e,!1);break;case 1766348718:this.v(r,68,!0,t,u,e,!1);break;case-958589048:Diag.a.a(22374108,0,50,"PasteTranspose was clicked from ribbon");this.v(r,516,!0,t,u,e,!1);break;case-185374993:this.v(r,20,!0,t,u,e,!1);break;case-617905554:case 808159687:w=o.F().a(1);!w&&o.T(r)?(v=0,this.u()===4&&(v=i.cutCopyPasteFlag),this.v(r,v,!f,t,u,e,!1)):(_Ewa.v.a(u,!0),s=!0);break;case 1872288872:s=!0;break;default:a=!1}return s&&this.k(!1),a?$$sc.a.a(Boolean,!0):_Ewa.G.a(y)},T:function(n,t,i,r,u,f){var e=this.e.a(),o,s;return(Diag.a.a(21303497,0,50,"FormatPainter was clicked, fromKeyboardShortcut = {0}",i),!r)?(Diag.a.a(22856003,0,10,"selctedRange should not be null during format paint"),null):(this.g=r.e(),Diag.a.a(22856004,0,50,"FormatPainter was clicked, fromKeyboardShortcut = {0}, SourceRange = {1}, this.gridControl.IsFormatPainterOn = {2}.",i,this.g,this.e.U()),this.e.U()?(Diag.a.a(21303500,0,50,"FormatPainter toggle off"),e.n(this.t),this.k(!1),this.e.bb(!1)):(o=this,this.t=function(){r=e.a();Diag.a.a(21303498,0,50,"FormatPainter handler, SourceRange = {0}, DestinationRange = {1}.",o.g,r.toString());o.v(r,36,!0,n,u,f,!0);o.k(!1)},this.g=r.e(),this.j=2,s=new _Ewa.bt(t.e()),s.e(r,this.e)&&this.h.c(r,2),this.f=this.n.j(),Diag.a.a(21303499,0,50,"FormatPainter toggle on"),e.l(this.t),e.t(this.I),this.e.bb(!0)),r)},o:function(n,t,i){var r=n===1&&!!i&&(!this.d(t,i)||!this.e.s());if(r)switch(t.a){case-893975939:case 1902045020:case 1804571062:case 1766348718:case-185374993:case-617905554:case 808159687:case 1872288872:case 1696566924:break;case-958589048:r=this.e.c().c(128);break;default:r=!1}return r},r:function(){return!1},q:function(){return!1},a:function(){this.k(!1)},d:function(n,t){return this.h.g(n,t)},J:function(n){return(n?this.z:this.f)===this.n.j()},v:function(n,t,i,r,u,f,e){t||(t=this.j);var o=this.e.c(),s=new _Ewa.bt(o.e());(o.T(null)||36===t&&s.a(4))&&(this.m.f(this.e.c(),this.i,this.c(),i,r.a,t),this.x=!1,this.c()||e?this.bf(n,t,r,u,e):this.be(n,t,i,r,f),this.x||this.m.c())},be:function(n,t,i,r,u){var o=this.e.c(),e,f;t!==36&&t!==68&&t!==516&&(e=i?this.i.c(!0):$$sc.a.a(String,u),this.x=!0,f=this,e.CWCT(function(t){var c=f.i.b(),o=t.a(),u=o===c,e=!f.i.a()&&(i||u),s=Common.c.e(),h=e&&i&&s;f.m.e(u,e,h);e?f.i.i(i,h,s,f.L):(u||f.bg(n,o,r),f.m.c())},o.k(),3,this.B||$$sc.c.a))},bf:function(n,t,i,r,u){var f=this.e.c(),o,s,a,e,h,c,l;if(!this.g||!n){Diag.a.a(22856005,0,10,"source range/destination range should not be null on PasteFromRange");return}if(o=this.h.f(t,this.g,n),!o){Diag.a.a(22856006,0,10,"paste range should not be null");return}if(s=_Ewa.i.a(this.y(),f),!s){Diag.a.a(22856007,0,10,"source should not be null");return}this.f&&(s.SheetName=this.f.d());a=_Ewa.i.a(n,f);e=this.j;e&=3;e|=-5&t;var p=this.J(!1)&&!!o.k(this.y())||!!(this.j&1)||this.u()===4,w=new _Ewa.iA.d(n.e(),o.e(),p,e),b=f.d().a().b(),v=this,k=function(n,t){return f.E(),_Ewa.ho.a(f.d().a(),s,a,e,_Ewa.l.a(n,v.O),_Ewa.l.b(t,v.N),w,b,null)},y=new _Ewa.bf(0,k,0);y.q=1;f.h().a(y,i);u&&this.l&&_Ewa.bT.a(this.l.a())&&(h=this.y().k(this.e.l()),c=n.k(this.e.l()),h&&c&&this.f&&(l=_Ewa.i.a(h,f),l.SheetName=this.f.d(),this.l.a().a().c(this.e,l,_Ewa.i.a(c,f),null,!0,!1)));_Ewa.v.a(r,!0)},V:function(n,t){this.m.d(n,t);this.m.c();this.e.o()},bg:function(n,t,i){var r,h,c,f;if(!t||(t=_Ewa.h.g(t,"\n","\r")),r=this.e.c(),!!t&&!this.U(n,t))if(_Ewa.iA.a(t,i),t.length>102400)alert(_Ewa.b.a().b(6));else{var u,e=_Ewa.i.a(n,r),s=!this.n.a()&&t.indexOf("\n")===-1&&t.indexOf("\t")===-1&&_Ewa.h.j(t),o=r.d().a().b();s?(_Ewa.bT.a(this.l.a())&&this.l.a().a().d(r,_Ewa.c.a(r).i(n.g()),t,!0,null,!1),h=this,u=function(i,u){return r.E(),_Ewa.f.c(r.d().a(),e,t,_Ewa.N.b(t,!0),!1,!1,63,i,u,n,o,null)}):(c=this,u=function(n,i){return r.E(),_Ewa.ho.b(r.d().a(),e,t,n,i,null,o,null)});f=new _Ewa.bf(0,u,0);f.q=1;r.h().a(f,i)}},U:function(n,t){var i=this.F.a(n);try{return n.f(this.A)&&this.J(!0)&&_Ewa.h.a(t,i.toString().replace(new RegExp("\r\n","g"),"\n"),!1)}finally{i&&i.dispose()}},S:function(n){return this.G&&!!this.y()&&this.y().f(n)&&this.n.j()===this.f},H:function(n,t,i,r,u,f,e){var h=this.e.c(),s,o;this.k(!0);this.j=t;this.g=n.e();this.f=this.n.j();s=new _Ewa.bt(h.e());o=this.u()===4;this.s.f(this.e.c(),this.i,i,r,u,f.a,t,o);!o&&s.e(n,this.e)&&this.h.c(n,this.j);r||u?(this.Q(e,f,o),this.s.e(e)):this.h.h(n,f,this.M,null,null)},k:function(n){this.c()&&(this.j=0,this.A=this.g,this.g=null,this.z=this.f,this.f=null,n||this.i.g(),this.h.a());this.e.U()&&this.R()},R:function(){this.e.bb(!1);var n=this.e.a();n.t("default");n.n(this.t);this.t=null;this.e.c().H()},bi:function(){this.e.c().A(237279923,2,0,{cutCopyPasteFlag:this.j})},ba:function(n,t,i){var u=this.u()===4,r=t,f;Diag.a.a(22374109,0,50,"ClipboardManager.OnPasteRangeSuccess: Paste range completed. AreServerMessagesPresent: [{0}]. AreNonStatusMessagesPresent: [{1}] proxyFlags: [{2}] methodName: [{3}]",_Ewa.g.d(n.Errors),_Ewa.g.b(n.Errors),r.a,i);_Ewa.g.d(n.Errors)&&u&&!_Ewa.g.c(n.Errors,[156])?this.h.e(this.e.a().i()):u&&this.bh(-1);f=r.c;f&&this.k(!1);!_Ewa.g.b(n.Errors)&&r.b.f(this.e.a().a())&&this.e.a().e(r.b,r.d,0,!0)},Z:function(n,t,i){var r=t;Diag.a.a(22374110,0,50,"ClipboardManager.OnPasteRangeFailed: Paste range failed. proxyFlags: [{0}] methodName: [{1}]",r.a,i)},X:function(n,t){var r=this.u()===4,f=t,i,u;n.Errors&&n.Errors.length?(r&&this.h.e(this.e.a().i()),this.i.h(),this.k(!1),this.s.e("")):(this.G=!0,i=n.Result,this.K=i,this.Q(i,f,r),u=this,this.i.d(i,!0).CWCT(function(){u.s.e(i)},this.e.c().k(),3,this.B||$$sc.c.a))},Q:function(n,t,i){_Ewa.iA.a(n,t);i&&this.bi()},W:function(n,t){t.a&&t.a===this.f?this.h.c(this.g,this.j):this.h.a()},bb:function(n,t){t.b===1&&t.a.a.b()&2&&this.k(!1)},bc:function(){this.k(Common.c.n())},bd:function(n,t){t.a||this.k(!1)},Y:function(){this.c()&&this.J(!1)&&this.k(!1)}};_Ewa.iA.b=function(){};_Ewa.iA.b.prototype={a:null,c:null,d:null,b:0,f:function(n,t,i,r,u,f,e,o){this.b++;this.c=t;this.d=n;this.a={};this.a.a=n.f().UserSessionId;this.a.b=Common.c.j();this.a.c=Common.c.p();this.a.d=i;this.a.e=r;this.a.f=u;this.a.g=t.a();this.a.h=t.f();this.a.i=f;this.a.j=e;this.a.k=o;this.a.l=t.e();this.a.m="N/A";this.a.n="N/A"},e:function(n){if(this.b++,this.b!==2&&Diag.a.a(17154648,0,15,"ClipboardManager.CopyTelemetry.Log: Invalid Call Count:{0}. Expecting:{1}",this.b,2),this.a.o=this.b,this.b=0,this.c.a()&&!this.c.e()){var t=this;this.c.c(!0).CWCT(function(i){var r=i.a(),u,f;Common.c.j()&&(r=r.replace(new RegExp("\n","g"),"\r\n"));u=n===r||!n;f=r===t.c.b();t.a.m=u.toString();t.a.n=f.toString();_Ewa.w.a().a(4,t.a,!0);(!u||f)&&Diag.a.a(17154649,0,15,"ClipboardManager.CopyTelemetry.Log: Failure to Copy to clipboard. IsPasteMatchCopy: {0}. WaitMessageInClipboard: {1} ",t.a.m,t.a.n)},this.d.k(),3,$$sc.c.a)}else this.a.m="N/A",this.a.n="N/A",_Ewa.w.a().a(4,this.a,!0)}};_Ewa.iA.e=function(){};_Ewa.iA.e.prototype={a:null,b:0,f:function(n,t,i,r,u,f){this.b++;this.a={};this.a.a=n.f().UserSessionId;this.a.b=Common.c.j();this.a.c=Common.c.p();this.a.d=i;this.a.e=r;this.a.f=t.a();this.a.g=t.f();this.a.h=u;this.a.i=f;this.a.j="N/A";this.a.k="N/A";this.a.l="N/A";this.a.m="N/A";this.a.n="N/A"},e:function(n,t,i){this.b++;this.a.j=n.toString();this.a.k=t.toString();this.a.l=i.toString()},d:function(n,t){this.b++;this.a.m=n;this.a.n=t.toString()},c:function(){this.b++;(this.b<2||this.b>4)&&Diag.a.a(17154650,0,15,"ClipboardManager.PasteTelemetry.Log: Invalid Call Count:{0} Expecting in range [{1}, {2}]",this.b,2,4);this.a.o=this.b;this.b=0;_Ewa.w.a().a(5,this.a,!0)}};_Ewa.iA.d=function(n,t,i,r){this.d=n;this.b=t;this.c=i;this.a=r};_Ewa.iA.d.prototype={c:!1,d:null,b:null,a:0};_Ewa.iz=function(n){this.c=n};_Ewa.iz.b=function(n,t,i,r,u,f,e,o){var h=n.d().a().b(),c=function(t,s){n.E();var c={};return c.ShadowWorkbookBase64=i.shadowWorkbookBase64,c.FloatingObjectId=u,c.DestinationRange=r,c.CopyPasteTargetType=2,_Ewa.hs.b(n.d().a(),c,_Ewa.l.a(t,f),_Ewa.l.b(s,e),null,h,o)},s=new _Ewa.bf(0,c,0);s.q=1;n.h().a(s,t)};_Ewa.iz.a=function(n){return String.format("{0}.{{{1}}}",n.length+2,n.toUpperCase())};_Ewa.iz.prototype={c:null,a:function(n,t,i,r,u,f){var o=this.c.d().a().b(),e=this,s=function(s,h){var c={};return c.CopyPasteTargetType=2,c.FloatingObjectId=n,r===2?_Ewa.hs.a(e.c.d().a(),c,_Ewa.l.a(s,i),u?_Ewa.l.b(h,u):h,t,o,f):(e.c.E(),_Ewa.hs.c(e.c.d().a(),c,_Ewa.l.a(s,i),u?_Ewa.l.b(h,u):h,t,o,f))};this.c.h().a(new _Ewa.bf(0,s,0),t)},b:function(n,t,i,r,u,f,e,o){var s=this;return new Promise(function(r,h){var c=function(n){var i,u;_Ewa.g.h(n.Errors)?(o&&(o.encounteredDeploymentErrors=!0),Diag.a.a(36538328,0,15,"ArtCopyPasteUtils.PasteArt: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: {0}",_Ewa.g.a(n.Errors))):_Ewa.g.d(n.Errors)?(Diag.a.a(36459652,0,10,"ArtCopyPasteUtils.PasteArt: PasteArt failed. errors: {0}",_Ewa.g.a(n.Errors)),h(new _Ewa.bY(7,n.Errors))):n.Result?(i=n.Result,t||(t=_Ewa.i.a(_Ewa.c.a(s.c).a().a(),s.c)),_Ewa.c.a(s.c).bq(_Ewa.i.b(t),1)?_Ewa.V.a(s.c).d(e.b,_Ewa.iz.a(i.FloatingObjectId),!0):(u=_Ewa.c.a(s.c).a().B(t,_Ewa.iz.a(i.FloatingObjectId),e.b),u.CW(function(n){var t=n.a();t?Diag.a.a(36459653,5,50,"ArtCopyPasteUtils.PasteArt: Selection succeeded in async manner for object's ID [{0}]",i.FloatingObjectId):Diag.a.a(36459654,5,10,"ArtCopyPasteUtils.PasteArt: Selection failed in async manner for object's ID [{0}]",i.FloatingObjectId)})),Diag.a.a(36229124,0,50,"ArtCopyPasteUtils.PasteArt: PasteArt succeed."),r(!0)):(Diag.a.a(36229125,0,10,"ArtCopyPasteUtils.PasteArt: PasteArt failed, result returned from server is null."),h(new _Ewa.bY(7,n.Errors)))},l=function(n){var t=_Ewa.t.c(n.b);Diag.a.a(36229126,0,10,"ArtCopyPasteUtils.PasteArt: PasteArt failed. errors: {0}",_Ewa.g.a(t));h(new _Ewa.bY(7,t))};_Ewa.iz.b(s.c,n,f,t,i,c,l,u)})}};_Ewa.hn=function(n,t,i,r,u,f){_Ewa.hn.initializeBase(this,[n,t,i,r,u,f])};_Ewa.hn.a=function(n,t,i){return t.a.o()&&t.a.j()===i.j()||t.a.n()&&t.a.i()===i.i()?n.commandParameters.expandDestination:i};_Ewa.hn.c=function(n,t){return(t.val=null,!n||!n.ShadowWorkbookBase64||!n.SourceRange)?!1:(t.val={},t.val.shadowWorkbookBase64=n.ShadowWorkbookBase64,t.val.rangeRowStart=n.SourceRange.FirstRow,t.val.rangeRowEnd=n.SourceRange.LastRow,t.val.rangeColumnStart=n.SourceRange.FirstColumn,t.val.rangeColumnEnd=n.SourceRange.LastColumn,!0)};_Ewa.hn.d=function(n,t){t.val=null;var i=n.getItem("data/shadow-workbook");return i?(t.val=JSON.parse(i),_Ewa.hn.b(t.val)):!1};_Ewa.hn.b=function(n){return!!n&&!!n.shadowWorkbookBase64&&!isUndefined(n.rangeRowStart)&&!isUndefined(n.rangeRowEnd)&&!isUndefined(n.rangeColumnStart)&&!isUndefined(n.rangeColumnEnd)};_Ewa.hn.prototype={serialize:function(n){var r=n.sourceItem,t={},i=this.d.b(r),u,f;if(i)t.synchronousResult=i,n.isFromCache=!0,n.clientSideCopyTime=n.commandParameters.stopwatch.d();else{if(this.l(r.a)){Diag.a.a(26035413,0,50,"AcrossSessionRangeCopyPasteHandler.Serialize: All data is loaded prepare the data in the client side.");u=this.f.a(r.a);try{f=u.toString();i=this.c.a();i.setItem("text/plain",f);this.d.a(r,i);t.synchronousResult=i;n.clientSideCopyTime=n.commandParameters.stopwatch.d()}finally{u&&u.dispose()}}else n.isAsyncCopy=!0,t.synchronousResult=this.c.a(),t.synchronousResult.setItem("text/plain",this.h());t.asynchronousResult=this.m(n,r)}return t},deserialize:function(n){var r,t,f,i,u,e,o;return _Ewa.iB.a(n,1),n.pasteResult="Undefined",n.isClipboardDataContainShadowWorkbook=!isNullOrUndefined(n.clipboardItems.getItem("data/shadow-workbook")),r=n.environment.getLastSuccessfulCopyOperation(),t=this.b.b(r),t&&(f=t.c(this.a),n.isSameSession=f,n.activeSelectionType=n.isSameSession?"SameSession":"CrossSession"),_Ewa.nA.a(n)?(n.isExternalPaste=!0,n.commandParameters.commandType!==516&&n.commandParameters.commandType!==36?this.k(n):Promise.reject(new _Ewa.bY(4,null))):(i=n.commandParameters.originalDestination,t&&(i=_Ewa.hn.a(n,t,i),n.isSameSession))?(n.commandParameters.ribbonCommandInfo.a===1804571062&&this.g.b(n,t.a,t.b,n.commandParameters.expandDestination,this.a.b().j().d(),r.commandParameters.commandType===1),this.o(n,t,_Ewa.i.a(i,this.a),r.commandParameters.commandType)):n.commandParameters.commandType!==516&&n.commandParameters.commandType!==36&&n.commandParameters.commandType!==20&&n.commandParameters.commandType!==68?(u=null,o=_Ewa.hn.d(n.clipboardItems,e={val:u}),u=e.val,o)?(n.isShadowWorkbookParsedSuccessfully=!0,this.n(n,_Ewa.i.a(i,this.a),u)):n.isClipboardInaccessible?Promise.reject(new _Ewa.bY(6,null)):this.k(n):Promise.reject(new _Ewa.bY(4,null))},o:function(n,t,i,r){var u=_Ewa.i.a(t.a,this.a);return u.SheetName=t.b,n.pasteResult="SameSessionPaste",Diag.a.a(26035414,0,50,"AcrossSessionRangeCopyPasteHandler.PasteSameSession: trigger PasteRange request..."),this.b.d(n.commandParameters.ribbonCommandInfo,u,i,r,n.commandParameters.commandType,[n.commandParameters.stopwatch],n)},n:function(n,t,i){return Diag.a.b(33863617,0,!!i,"AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: shadowWorkbookPayload shouldn't be null"),Diag.a.b(33863618,0,!!i.shadowWorkbookBase64,"AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: ShadowWorkbookBase64 shouldn't be null"),n.pasteResult="CrossSessionPaste",n.shadowWorkbookPayloadSize=i.shadowWorkbookBase64.length,n.shadowWorkbookPayloadSize>4194304?(Diag.a.a(34415003,0,15,"AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: shadow workbook length({0}) is over the limit({1}). reject the paste request.",n.shadowWorkbookPayloadSize,4194304),Promise.reject(new _Ewa.bY(0,null))):(Diag.a.a(33863619,0,50,"AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: trigger Paste request..."),this.b.k(n.commandParameters.ribbonCommandInfo,t,i,[n.commandParameters.stopwatch],n))},k:function(n){var t=n.clipboardItems.getItem("text/plain"),i=t===this.h();return i?Promise.reject(new _Ewa.bY(5,null)):(isNullOrUndefined(t)||(n.plainTextPayloadSize=t.length),n.isPlainTextPaste=!0,n.pasteResult="SystemClipboardPaste",Diag.a.a(26035416,0,50,"AcrossSessionRangeCopyPasteHandler.PasteByPlainText: trigger ProcessPasteText request..."),this.b.i(n.commandParameters.originalDestination,t,n.commandParameters.ribbonCommandInfo,[n.commandParameters.stopwatch],n))},m:function(n,t){var i=this;return new Promise(function(r,u){var f=function(f){var h,o,e,s,c,l,a;if(_Ewa.g.d(f.Errors))_Ewa.g.h(f.Errors)?(n.encounteredDeploymentErrors=!0,Diag.a.a(36538326,0,15,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: {0}",_Ewa.g.a(f.Errors))):(Diag.a.a(26035419,0,10,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: {0}",_Ewa.g.a(f.Errors)),u(new _Ewa.ff(1,f.Errors)));else{if(Diag.a.a(26035418,0,50,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer succeed."),n.markForCancellation){u(new _Ewa.ff(2,f.Errors));return}h=f.Result;o=h.PlainTextResult;isNullOrUndefined(o)||(n.plainTextPayloadSize=o.length);e=i.c.a();(l=_Ewa.hn.c(h,c={val:s}),s=c.val,l)&&(n.shadowWorkbookPayloadSize=s.shadowWorkbookBase64.length,a=JSON.stringify(s),e.setItem("data/shadow-workbook",a));e.setItem("text/plain",o);i.d.a(t,e);r(e)}},e=function(n){var t=_Ewa.t.c(n.b);Diag.a.a(26035420,0,10,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: {0}",_Ewa.g.a(t));u(new _Ewa.ff(1,t))};Diag.a.a(26035421,0,50,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: issue request to the server to get the copied data...");i.b.j(t.a,n.commandParameters.ribbonCommandInfo,f,e,[n.commandParameters.stopwatch])})}};_Ewa.sH=function(n,t,i,r){this.a=n;this.c=t;this.e=i;this.b=_Ewa.c.a(n).a();this.d=r||new _Ewa.mk(this.c)};_Ewa.sH.prototype={b:null,a:null,e:null,c:null,d:null,getSourceItem:function(){return Diag.a.b(36227297,0,!!this.b.o(),"Expecting a floating object to be currently selected for copy"),new _Ewa.ft(this.b.o(),this.a.b().j().d(),this.a.b().g(),this.a.f().UserSessionId,this.b.c().a().a)},beforeSerialize:function(n){if(!n||!n.commandParameters){Diag.a.a(36227298,0,10,"ArtCopyPasteHandler.BeforeSerialize: copyContext or copyContext.CommandParameters is null.");return}_Ewa.iB.b(n);n.commandParameters.copyPasteTargetType=2},serialize:function(n){var i=n.sourceItem,t={},r,u;return i?(r=this.d.b(i),r?(t.synchronousResult=r,n.isFromCache=!0,n.isAsyncCopy=!1,n.clientSideCopyTime=n.commandParameters.stopwatch.d()):(n.isFromCache=!1,n.isAsyncCopy=!0,u=this.c.a(),u.setItem("text/plain",""),t.synchronousResult=u,t.asynchronousResult=this.g(n,i)),t):(Diag.a.a(36227299,0,10,"ArtCopyPasteHandler.Serialize: artSourceItem should not be null"),t)},deserialize:function(n){var f,i,e,t,r,u;return(_Ewa.iB.a(n,2),n.activeSelectionType=this.f(),f=n.environment.getLastSuccessfulCopyOperation(),i=f.sourceItem,i)?(n.isSameSession=i.c(this.a),!i.c(this.a))?(Diag.a.a(36229120,0,50,"User attempted to copy-paste art of type"+i.b+" between sessions."),Promise.reject(new _Ewa.bY(7,null))):(e=n.clipboardItems.getItem("data/shadow-workbook"),t=JSON.parse(e),!t||!t.floatingObjectId||t.floatingObjectId!==i.a||!t.shadowWorkbookBase64||!t.shadowWorkbookBase64)?Promise.reject(new _Ewa.bY(7,null)):(n.isShadowWorkbookParsedSuccessfully=!0,n.shadowWorkbookPayloadSize=t.shadowWorkbookBase64.length,n.shadowWorkbookPayloadSize>4194304)?(Diag.a.a(36304156,0,15,"ArtCopyPasteHandler.Deserialize: shadow workbook length({0}) is over the limit({1}). reject the paste request.",n.shadowWorkbookPayloadSize,4194304),Promise.reject(new _Ewa.bY(0,null))):(r=_Ewa.i.a(n.commandParameters.originalDestination,this.a),u=null,_Ewa.c.a(this.a).a().o()&&(r=null,u=_Ewa.c.a(this.a).a().o()),this.e.b(n.commandParameters.ribbonCommandInfo,r,u,n.commandParameters.commandType,[n.commandParameters.stopwatch],t,i,n)):Promise.reject(new _Ewa.bY(7,null))},f:function(){return _Ewa.c.a(this.a).a().d()&214?"FloatingObject":_Ewa.c.a(this.a).a().d()===1?"Cells":"Other"},g:function(n,t){var i=this;return new Promise(function(r,u){var f=function(f){var o,e,h,s;_Ewa.g.d(f.Errors)?_Ewa.g.h(f.Errors)?(n.encounteredDeploymentErrors=!0,Diag.a.a(36538327,0,15,"ArtCopyPasteHandler.GetCopiedDataFromServer: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: {0}",_Ewa.g.a(f.Errors))):(Diag.a.a(36229122,0,10,"ArtCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: {0}",_Ewa.g.a(f.Errors)),u(new _Ewa.ff(3,f.Errors))):(Diag.a.a(36229121,0,50,"ArtCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer succeed."),o=f.Result,o?(e={},e.shadowWorkbookBase64=o?o.ShadowWorkbookBase64:null,e.floatingObjectId=t.a,n.shadowWorkbookPayloadSize=e.shadowWorkbookBase64?e.shadowWorkbookBase64.length:0,h=JSON.stringify(e),s=i.c.a(),s.setItem("data/shadow-workbook",h),n.commandParameters.commandType===1&&i.b.s(i.b.c(),!0),i.d.a(t,s),r(s)):(Diag.a.a(36508684,0,50,"ArtCopyPasteHandler.GetCopiedDataFromServer: Result form server returned null, copied item id: {0}",t.a),r(i.d.b(t))))},e=function(n){var t=_Ewa.t.c(n.b);Diag.a.a(36229123,0,10,"ArtCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: {0}",_Ewa.g.a(t));u(new _Ewa.ff(3,t))};i.e.a(t.a,n.commandParameters.ribbonCommandInfo,f,n.commandParameters.commandType,e,[n.commandParameters.stopwatch])})}};_Ewa.CQ=function(n,t,i,r,u,f){this.a=n;this.g=t;this.j=u;this.c=r;this.d=f||new _Ewa.mk(this.c);this.e=_Ewa.c.a(n);this.b=i;this.i=this.e.a();this.f=n.a().a(_Ewa.jW,164)};_Ewa.CQ.prototype={e:null,i:null,f:null,a:null,g:null,d:null,b:null,c:null,j:null,h:function(){return this.j.b(5)},getSourceItem:function(){return new _Ewa.hU(this.i.a(),this.a.b().j().d(),this.a.b().g(),this.a.f().UserSessionId)},beforeSerialize:function(n){n.isSellectionAllowed=!1;n.isAsyncCopy=!1;n.isFromCache=!1;n.encounteredDeploymentErrors=!1;n.plainTextPayloadSize=0;n.shadowWorkbookPayloadSize=0;n.clientSideCopyTime=0;var i=new _Ewa.bt(this.a.e()),t=n.sourceItem;i.e(t.a,this.e)&&(n.isSellectionAllowed=!0,this.b.c(t.a,n.commandParameters.commandType))},l:function(n){var t=this.e.H();return this.e.b().h()&&n.f(n.k(t))}};_Ewa.mj=function(n){_Ewa.mj.initializeBase(this,[n])};_Ewa.mj.a=function(n){_Ewa.Q.a(5,new _Ewa.mj(n))};_Ewa.mj.prototype={k:function(){var n=this;_Ewa.d.cw(_Ewa.k.a(_Ewa.dA,this.h.a(),18,this.cF()),function(){n.l([_Ewa.c.a(n.h).cd()],null)},this.h.k(),3)}};_Ewa.jS=function(){};_Ewa.jS.prototype={a:function(){return clipboardPlatform.createClipboardItems()}};_Ewa.ho=function(){};_Ewa.ho.a=function(n,t,i,r,u,f,e,o,s){var h=n.a(9,o);return h.sourceRange=t,h.destinationRange=i,h.flags=r,_Ewa.f.a(n,"PasteRange",h,u,f,e,64,s)};_Ewa.ho.b=function(n,t,i,r,u,f,e,o){var s=n.a(9,e);return s.destinationRange=t,s.source=i,_Ewa.f.a(n,"PasteString",s,r,u,f,64,o)};_Ewa.ho.c=function(n,t,i,r,u,f,e){var o=n.a(1,f);return o.sourceRange=t,_Ewa.f.a(n,"GetRangeForClipboard",o,i,r,u,4,e)};_Ewa.iB=function(){};_Ewa.iB.b=function(n){if(!n){Diag.a.a(36701969,0,10,"CommonCopyPasteUtils.InitializeCopyContext: copyContext is null.");return}n.isAsyncCopy=!1;n.isSellectionAllowed=!1;n.isFromCache=!1;n.plainTextPayloadSize=0;n.shadowWorkbookPayloadSize=0;n.clientSideCopyTime=0;n.encounteredDeploymentErrors=!1};_Ewa.iB.a=function(n,t){if(!n){Diag.a.a(36701970,0,10,"CommonCopyPasteUtils.InitializePasteContext: pasteContext is null.");return}n.commandParameters&&(n.commandParameters.copyPasteTargetType=t);n.isSameSession=!1;n.isShadowWorkbookParsedSuccessfully=!1;n.activeSelectionType="None";n.encounteredDeploymentErrors=!1};_Ewa.mk=function(n){this.d=n};_Ewa.mk.prototype={c:null,e:null,d:null,b:function(n){return this.c&&this.c.g(n)?this.f(this.e):null},a:function(n,t){this.c=n;this.e=this.f(t)},f:function(n){var t=this.d.a(),r=n.getItem("text/plain"),i;return r&&t.setItem("text/plain",r),i=n.getItem("data/shadow-workbook"),i&&t.setItem("data/shadow-workbook",i),t}};_Ewa.sI=function(n,t,i){this.h=Function.createDelegate(this,this.l);this.i=Function.createDelegate(this,this.m);this.d=_Ewa.bj.a().b(null);this.c=t;this.g=n;this.f=i;this.e=!0;this.d.a("focus",this.i);this.d.a("blur",this.h);var r=this;this.a=_Ewa.u.a().a(function(){r.j(!0)},1e3,!1,!1)};_Ewa.sI.prototype={d:null,c:null,g:null,f:null,b:null,a:null,e:!1,dispose:function(){this.d.b("focus");this.d.b("blur");this.a&&(System.a.a(this.a),this.a=null)},j:function(n){var t=this;return this.c.makeSureSync().then(function(){t.k()?(t.b=null,t.f.a(),Diag.a.a(25216980,0,50,"CopyPasteEnvironmentSyncAgent.OnEnvironmentSyncTimerTick: found that cut/copy operation was preformed in another session therefore cleared the cut/copy state in this session.")):n&&t.a.b()})},k:function(){var n,t,i;return this.b?(n=this.c.getLastSuccessfulCopyOperation(),this.b&&!n)?!0:(t=n.sourceItem,i=this.b.sourceItem,!t||!i)?(Diag.a.b(25216982,0,!1,"CopyPasteEnvironmentSyncAgent.IsClearHighlightNeeded: expect that both currentSourceItem and cachedSourceItem will not be null"),!0):!t.g(i):(Diag.a.b(25216981,0,!1,"CopyPasteEnvironmentSyncAgent.IsClearHighlightNeeded: IsClearHighlightNeeded isn't expected to be called when lastSuccessfulCopyOperationInThisDocument is null"),!1)},m:function(){var t;if(this.a.a(),this.e=!0,this.b){Diag.a.a(25216984,0,50,"CopyPasteEnvironmentSyncAgent.OnWindowFocus: calling to OnEnvironmentSyncTimerTick...");var i=this,n=this,r=this;this.j(!1).catch(function(){return Diag.a.b(25216986,0,!1,"CopyPasteEnvironmentSyncAgent.OnWindowFocus: OnEnvironmentSyncTimerTick returned unexpected rejected promise"),Promise.resolve(null)}).then(function(){n.e&&(n.b=null)},function(){})}else t=this,this.c.makeSureSync().catch(function(n){Diag.a.a(25216987,0,10,"CopyPasteEnvironmentSyncAgent.OnWindowFocus: failed to sync environment with the following error: {0}",n)})},l:function(){var n=this.c.getLastSuccessfulCopyOperation(),t;n&&(Diag.a.a(25216989,0,50,"CopyPasteEnvironmentSyncAgent.OnWindowBlur: This session lost the window focus while cut/copy range is active"),t=n.sourceItem,t&&t.d===this.g.f().UserSessionId&&(this.e=!1,this.b=n,this.a.b(),Diag.a.a(25216990,0,50,"CopyPasteEnvironmentSyncAgent.OnWindowBlur: tigger timer for checking if copy operation is preformed in another session.")))}};_Ewa.sK=function(){this.b="CCP_ENVIRONMENT_DATA_VERSION_4";this.c=new _Ewa.mm};_Ewa.sK.prototype={a:null,getLastSuccessfulCopyOperation:function(){return this.a},setSuccessfulCopyOperation:function(n){this.a=n;var t=this.c.v(n);localStorage.setItem(this.b,t)},makeSureSync:function(){var n=localStorage.getItem(this.b);return this.a=this.c.n(n),Promise.resolve(this)},clear:function(){this.a=null;localStorage.removeItem(this.b)}};_Ewa.ml=function(n){_Ewa.ml.initializeBase(this);this.h=n;this.k=_Ewa.b.a();this.j()};_Ewa.ml.a=function(n){n.a().b(_Ewa.GR.$$(_Ewa.cT),249,new _Ewa.ml(n))};_Ewa.ml.prototype={h:null,k:null,b:function(){var i=_Ewa.o.e([44,45],4,!1),t=_Ewa.k.a(_Ewa.dA,this.h.a(),18,this.h.k()),n=this;_Ewa.d.cw(_Ewa.d.ws([t,i],this.cF(),3),function(){var i=null,r,u;if(_Ewa.bC.c(n.h))try{localStorage&&(i=new _Ewa.sK)}catch(f){}i||(i=new _Ewa.sJ);n.h.a().b(_Ewa.vj,263,i);r=new _Ewa.lo;u=null;n.l(r).then(function(f){u=f;var e=copyPasteInfra.createCopyPasteInfra(i,u,new _Ewa.sL(n.h),r);Diag.a.b(24970909,0,!!n.h.f(),"CopyPasteInfrastructureFactory.Create: this.ewaControl.BootstrapContext should not be null");Diag.a.b(24970910,0,!!n.h.f()&&!!n.h.f().DocumentHostInfo,"CopyPasteInfrastructureFactory.Create: this.ewaControl.BootstrapContext.DocumentHostInfo should not be null");n.i(new _Ewa.dO(n.h,t.a(),i,e,new _Ewa.cW(n.h,_Ewa.c.a(n.h)),new _Ewa.sM,n.h.f().DocumentHostInfo.UserId))},function(){})},this.cF(),3)},dispose:function(){_Ewa.co.prototype.dispose.call(this)},l:function(n){var i=clipboardPlatform.getClipboardPlatformEnvironment(),e,r,f,s,h;if(!i)return Diag.a.b(24970911,0,!1,"CopyPasteInfrastructureFactory.ConfigureClipboardPlatformEnvironment: getClipboardPlatformEnvironment should have returned a valid object"),null;var t=this.h.f(),o=[t.OfficeOnlineChromeExtensionId,t.ChromeClipboardAccessExtensionId],u=this.h.F().a(4);return(u&&!_Ewa.bC.e(this.h)&&(u=!1),e=this.k.b(5),i.init(n,u,o,t.SharedClipboardHostingApp,t.SharedClipboardHostingApps,t.SharedClipboardHostingEnvironments,t.SharedClipboardSchemaVersion,t.SharedClipboardExpirationInMinutes,t.ClipboardPromiseTimeoutInMinutes,e,t.MachineCluster),r=i.getSupportedClipboardStrategyTypes(),!r)?(Diag.a.b(24970912,0,!1,"CopyPasteInfrastructureFactory.ConfigureClipboardPlatformEnvironment: supportedClipboardStrategyTypes=null"),null):r.length<1?(Diag.a.b(24970913,0,!1,"CopyPasteInfrastructureFactory.ConfigureClipboardPlatformEnvironment: supportedClipboardStrategyTypes is empty"),null):(f=r[0],Diag.a.a(24970914,0,50,"CopyPasteInfrastructureFactory.ConfigureClipboardPlatformEnvironment: supportedClipboardStrategyTypes contains {0} elements. The first element is {1}",r.length,f),s=this,h=this,i.selectClipboardStrategy(f).then(function(){return Promise.resolve(i)},function(n){return Diag.a.a(25454288,0,10,"ConfigureClipboardPlatformEnvironment: error during call to clipboardPlatformEnvironment.SelectClipboardStrategy(). error: {0}",n?JSON.stringify(n):"null"),Promise.reject(n)}))}};_Ewa.dO=function(n,t,i,r,u,f,e){if(this.z=Function.createDelegate(this,this.ba),this.B=Function.createDelegate(this,this.bb),this.y=Function.createDelegate(this,this.Z),this.x=Function.createDelegate(this,this.W),this.w=Function.createDelegate(this,this.U),_Ewa.dO.initializeBase(this,[!1]),this.n=n,this.v=t,this.p=_Ewa.c.a(n),this.q=u,this.A=f,this.o=i,this.r=r,this.bf(),this.s=this.n.a().a(_Ewa.ms,81),Diag.a.b(24388233,0,!!this.s,"CopyPasteInfrastructure.ctor: this.copyPasteShortcutDialogFactory shouldn't be null."),Diag.a.b(24970908,0,!!e,"CopyPasteInfrastructure.ctor: userId should not be null"),this.t=Common.d.d(e),_Ewa.bC.c(this.n)){this.u=new _Ewa.sI(this.n,this.o,this.q);var o=this;this.o.makeSureSync().catch(function(n){Diag.a.a(33948250,0,10,"CopyPasteInfrastructure.ctor: failed to sync environment with the following error: {0}",n)})}};_Ewa.dO.e=function(n){var t=n.innerError;return t&&t.pasteErrorName?n.innerError:null};_Ewa.dO.d=function(n){var t=n.innerError;return t&&t.copyErrorName?n.innerError:null};_Ewa.dO.prototype={n:null,p:null,o:null,v:null,s:null,r:null,q:null,A:null,t:0,u:null,f:function(n){this.cG("cpiOSC",n)},m:function(n){this.cH("cpiOSC",n)},h:function(n){var i,u,r,t;return n.stopwatch=this.n.r().a("UserAction",_Ewa.w.a().c(n.ribbonCommandInfo.a)+"ClientSide"),i=!!this.o.getLastSuccessfulCopyOperation(),u=this,this.c("Copy/before/"+Common.j.a.toString(n.ribbonCommandInfo.b),!1,!1,!0,n.copyPasteTargetType).catch(function(){}),n.userHash=this.t,n.id=Common.N.a().a,r=this,t=this,this.r.onCopy(n).then(function(t){return t.isAsyncCopy||n.stopwatch.a(),Diag.a.a(24150883,0,50,"CopyPasteInfrastructure.OnCopy: Copy operation finished successfully. {0}",_Ewa.gH.a(n)),r.P(t,i),Promise.resolve(!0)},function(i){var r=i,f=!1,e="none",o=!1,s=-1,h=!1,u;return r&&(s=r.reason,u=_Ewa.dO.d(r),u&&(u.copyErrorName===2?(f=!0,e="Async Copy canceled by the user."):_Ewa.g.d(u.a)&&(_Ewa.g.g(u.a)?(f=!0,e=_Ewa.g.a(u.a)):_Ewa.g.c(u.a,_Ewa.dO.a)&&(f=!0,h=!0))),r.reason===11&&(o=!0)),f?Diag.a.a(36304157,0,15,"CopyPasteInfrastructure.OnCopy: Copy operation failed with an expected error. isSuccessiveCutCopyOverridingPendingCutCopy: {0}, Friendly message: {1}, Error Message: {2}, CommandParameters: {3}",o,e,r?JSON.stringify(r):"null",_Ewa.gH.a(n)):Diag.a.a(24150912,0,10,"CopyPasteInfrastructure.OnCopy: Copy operation failed with an unexpected error. isSuccessiveCutCopyOverridingPendingCutCopy: {0}, Error Message: {1}, CommandParameters: {2}",o,r?JSON.stringify(r):"null",_Ewa.gH.a(n)),o||t.c("Copy/fail/"+Common.j.a.toString(n.ribbonCommandInfo.b),!0,!1,!1,n.copyPasteTargetType).catch(function(){}),t.O(n,f,e,s,h),Promise.reject(i)})},l:function(n){if(n.stopwatch=this.n.r().a("UserAction",_Ewa.w.a().c(n.ribbonCommandInfo.a)+"ClientSide"),n.originalDestination=this.p.a().a(),n.expandDestination=this.C(n.originalDestination,n.commandType),this.g(n.commandType,n.expandDestination)||this.K()){n.userHash=this.t;n.id=Common.N.a().a;var t=this,i=this;return this.r.onPaste(n).then(function(i){return t.Y(i,n)},function(t){return i.X(n,t)})}return Diag.a.a(24150913,0,15,'CopyPasteInfrastructure.OnPaste: paste was triggered but the estimated destination range is not editable, do nothing. ExpandDestination: {0}, CommandType: {1}, copyPasteTargetType="{2}"',n.expandDestination,n.commandType,n.copyPasteTargetType),Promise.resolve(!0)},K:function(){var n=this.o.getLastSuccessfulCopyOperation(),t;return!n||!n.sourceItem||Object.getType(n.sourceItem)!==_Ewa.ft?!1:(t=n.sourceItem,t&&!t.c(this.n))?!1:!!_Ewa.c.a(this.n).a().o()},k:function(){var n=this.o.getLastSuccessfulCopyOperation();return!n||!n.commandParameters?0:n.commandParameters.copyPasteTargetType},c:function(n,t,i,r,u){var e,o,f,s,h,c;try{return(e=u,o=this.N(),!r&&o===2)?(Diag.a.a(36304158,0,50,"CopyPasteInfrastructure.ClearState clipboard won't be cleared as there's art in the clipboard. clearClipboardContent = '{0}', isExplicit = '{1}', isForce = '{2}', Current CCP operation copyPasteTargetType = '{3}', LastCopyPasteTargetType = '{4}'",t,i,r,u,o),Promise.reject(null)):(e||(e=o),f=this.n.r().a("UserAction","ClearCopyState"),s=f.b(),Diag.a.a(24150914,0,50,"CopyPasteInfrastructure.ClearState clear clipboard state. clearClipboardContent = '{0}', isExplicit = '{1}', isForce = '{2}', Current CCP operation copyPasteTargetType = '{3}', LastCopyPasteTargetType = '{4}'",t,i,r,u,o),this.q.a(),this.be(),h=this,c=this,this.r.onCancelCopy(t).then(function(){return f.a(),h.I(n,s,!0,i,t,f.d(),e),Promise.resolve(!0)},function(r){return Diag.a.a(24150915,0,15,"CopyPasteInfrastructure.ClearState: error during call to copyPasteFlowManager.OnClear(). error: {0}",r?JSON.stringify(r):"null"),f.a(),c.I(n,s,!1,i,t,f.d(),e),Promise.reject(r)}))}catch(l){return Promise.reject(null)}},N:function(){var n=this.o.getLastSuccessfulCopyOperation();return!n||!n.sourceItem?0:Object.getType(n.sourceItem)===_Ewa.ft?2:1},i:function(n,t,i,r){var s,e,u,f,o;return n.stopwatch=this.n.r().a("UserAction","DragDropClientSide"),s=this,this.c("DragDrop/before/"+Common.j.a.toString(n.ribbonCommandInfo.b),!1,!1,!1,n.copyPasteTargetType).catch(function(){}),e=r?256:128,u={},u.encounteredDeploymentErrors=!1,n.userHash=this.t,n.id=Common.N.a().a,f=this,o=this,this.q.d(n.ribbonCommandInfo,_Ewa.i.a(t,this.n),_Ewa.i.a(i,this.n),1,e,[n.stopwatch],u).then(function(){return f.p.a().r(-1),f.R(n,t,i,u),Promise.resolve(!0)},function(r){return o.V(r,n,t,i,u)})},j:function(n,t){var r,i,f,c,l,e;if(!_Ewa.bC.d(this.n))return Diag.a.a(25518402,0,50,"InsertCopiedCutCells: Feature is not enabled"),$$sc.a.a(Boolean,!1);if(r=this.o.getLastSuccessfulCopyOperation(),!r)return Diag.a.a(25518403,0,50,"InsertCopiedCutCells: CopyContext must not be null or undefined"),$$sc.a.a(Boolean,!1);if(i=r.sourceItem,!i)return Diag.a.b(25518404,0,!!i,"InsertCopiedCutCells: rangeSourceItem must not be null or undefined"),$$sc.a.a(Boolean,!1);if(!i.c(this.n))return Diag.a.a(34981187,0,50,"InsertCopiedCutCells: rangeSourceItem is from a different session"),$$sc.a.a(Boolean,!1);var u=i.a,a=this.p.a().a(),o=this.C(a,n),s=this.e(),v=i.b,y=this.n.b().j().d(),h=_Ewa.i.a(u,this.n);return h.SheetName=v,f=_Ewa.i.a(o,this.n),f.SheetName=y,c=u.o()?$$sc.a.a(_Ewa.jE,0):o.n()||u.n()?$$sc.a.a(_Ewa.jE,1):this.A.a(this.n,_Ewa.c.a(this.n).d()),l=this,e=this,c.CWR($$sc.a,function(n){return l.L(h,f,s,n.a(),t)}).CW(function(){s?e.q.a():e.c("InsertCopiedCutCells/success/"+Common.j.a.toString(t.b),!0,!1,!1,0)})},e:function(){return this.H(-911352779)},a:function(){return this.H(-1985798686)},g:function(n,t){var i=new _Ewa.bt(this.n.e()),r=n===36,u=i.a(4),f=r&&u;return f||this.n.T(t)},d:function(n,t){return this.q.g(n,t)},dispose:function(){_Ewa.co.prototype.dispose.call(this);this.bh();_Ewa.bC.c(this.n)&&this.u&&this.u.dispose()},b:function(n,t,i,r,u,f){var s,h,c,e,o,l;if(n.commandParameters.commandType!==516){if(i===u&&(s=t.k(this.p.l()),h=r.k(this.p.l()),s&&h)){c=_Ewa.i.a(s,this.n);c.SheetName=i;e=!0;o=!1;switch(n.commandParameters.ribbonCommandInfo.a){case 1804571062:e=!0;o=!1;break;case 237279923:case 808159687:e=!0;o=!0;break;case 1766348718:case-185374993:e=!1;o=!0}l=this.v.c(this.p,c,_Ewa.i.a(h,this.n),n.commandParameters.stopwatch,e,o);f&&this.v.f(s,!1);l&&(this.J(n.commandParameters.expandDestination),this.D("DoPasteClientEstimation/"+Common.j.a.toString(n.commandParameters.ribbonCommandInfo.b),n))}}else Diag.a.a(24417763,0,50,"RangeCopyPasteHandler.DoPasteClientEstimation: client estimation support only paste formatting.")},H:function(n){var t=this.o.getLastSuccessfulCopyOperation(),i;return t?(i=t.sourceItem,i&&!i.c(this.n))?(Diag.a.a(34981188,0,50,"CopyPasteInfrastructure.LastOperationWasCopyCut: Last copy operation was from a different session."),!1):t.commandParameters.ribbonCommandInfo.a===n:!1},L:function(n,t,i,r,u){var f={};f.InsertDirection=r;f.SourceRange=n;f.DestRange=t;f.CopyCutOperation=i?0:1;var e=this.n.d().a(),s=this,o=function(n,t){return _Ewa.wX.a(e,f,n,t,null,null)},h=this;return _Ewa.P.a(this.n.h(),o,function(n){return new _Ewa.H(0,n,0)},u)},F:function(n,t,i,r){var u={};return u.a=this.n.f().UserSessionId,u.e=n.stopwatch.b(),u.c=_Ewa.w.a().c(n.ribbonCommandInfo.a),u.b=Common.j.a.toString(n.ribbonCommandInfo.b),u.d=n.id,u.f=t.toString(),u.g=i.toString(),u.j=n.stopwatch.d(),u.k=!1,u.l=n.copyPasteTargetType.toString(),u.m=r.encounteredDeploymentErrors,u},R:function(n,t,i,r){var u=this.F(n,t,i,r);u.h=!0;_Ewa.w.a().a(46,u,!0)},Q:function(n,t,i,r,u,f){var e=this.F(n,t,i,f);e.h=!1;e.i=r;e.k=u;_Ewa.w.a().a(46,e,!0)},I:function(n,t,i,r,u,f,e){var o={};o.a=this.n.f().UserSessionId;o.b=t;o.c=n;o.f=i;o.e=r;o.d=u;o.g=f;o.h=e.toString();_Ewa.w.a().a(47,o,!0)},P:function(n,t){var i=this.E(n.commandParameters);i.g=n.isAsyncCopy;i.h=n.isFromCache;i.j=n.isSellectionAllowed;i.k=!0;i.i=t;i.d=n.sourceItem.toString();i.p=n.plainTextPayloadSize;i.r=n.shadowWorkbookPayloadSize;i.n=n.clientSideCopyTime;i.u=n.encounteredDeploymentErrors;_Ewa.w.a().a(44,i,!0)},O:function(n,t,i,r,u){var f=this.E(n);f.k=!1;f.l=t;f.m=i;f.s=r;f.t=u;_Ewa.w.a().a(44,f,!0)},E:function(n){var t={};return t.a=this.n.f().UserSessionId,t.e=n.stopwatch.b(),t.f=n.id,t.c=_Ewa.w.a().c(n.ribbonCommandInfo.a),t.b=Common.j.a.toString(n.ribbonCommandInfo.b),t.o=n.stopwatch.d(),t.q=n.copyPasteTargetType.toString(),t.t=!1,t},J:function(n){var t=this.p.a().a().bo(n)?this.p.a().b():n.g();this.p.a().e(n,t,0,!0)},G:function(n,t){var i={};return i.a=this.n.f().UserSessionId,i.g=n.stopwatch.b(),i.n=n.stopwatch.d(),i.q=n.copyPasteTargetType.toString(),i.i=n.expandDestination.toString(),i.h=n.originalDestination.toString(),i.e=n.id,i.d=n.commandType,i.c=_Ewa.w.a().c(n.ribbonCommandInfo.a),i.b=Common.j.a.toString(n.ribbonCommandInfo.b),i.x=!1,i.y=!1,t&&(i.f=t.commandParameters.id,i.j=t.sourceItem.toString(),i.y=t.commandParameters.commandType===1),i},S:function(n,t,i,r,u,f,e){var o=this.G(n,e);o.k=!1;o.l=t;o.m=i;o.v=r;o.w=u;o.x=f;_Ewa.w.a().a(45,o,!0)},T:function(n,t){var i=this.G(n.commandParameters,t);i.r=n.isExternalPaste;i.k=!0;i.o=n.plainTextPayloadSize;i.p=n.shadowWorkbookPayloadSize;i.s=n.isClipboardDataContainShadowWorkbook;i.t=n.isShadowWorkbookParsedSuccessfully;i.u=n.activeSelectionType;i.v=n.pasteResult;i.z=n.encounteredDeploymentErrors;_Ewa.w.a().a(45,i,!0)},bf:function(){this.n.e().b(this.w);this.n.e().x(this.x);this.n.h().d(this.y);this.n.B(this.B);_Ewa.c.a(this.n).e().d(this.z)},bh:function(){this.n&&this.n.e()&&(this.n.e().c(this.w),this.n.e().A(this.x));this.n&&this.n.h()&&this.n.h().f(this.y);this.p&&this.p.e()&&this.p.e().c(this.z)},X:function(n,t){var r=null,e=t,u=!1,i=null,f="UnknownFailure",o=-1,s=!1,h=this.o.getLastSuccessfulCopyOperation(),c;return n.clearStateOnFinish&&(c=this,this.c("Paste/fail/"+Common.j.a.toString(n.ribbonCommandInfo.b),!0,!1,!1,n.copyPasteTargetType).catch(function(){})),e&&(o=e.reason,r=_Ewa.dO.e(e),r&&r.pasteErrorName!=null&&(r.pasteErrorName?r.pasteErrorName===5?(u=!0,_Ewa.bC.c(this.n)?(f="No-Op",i="The shadow workbook is not ready yet and an async copy failed to populate the clipboard. Do nothing (by the spec)",Diag.a.a(33948251,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',i,n.copyPasteTargetType)):(f="AsyncCopyFailurePopup",i="An async copy was unable to populate the clipboard. Popup a dialog to the user.",Diag.a.a(25216993,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',i,n.copyPasteTargetType),this.bc())):r.pasteErrorName===6?(u=!0,f="UseShortcutsPopup",i="Unable to paste content from the system clipboard. Popup dialog to the user.",Diag.a.a(25216994,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',i,n.copyPasteTargetType),this.bd()):r.pasteErrorName===4?(u=!0,f="No-Op",i="Paste Formatting/Transpose is not yet a supported operation on System Clipboard based content",Diag.a.a(36263241,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',i,n.copyPasteTargetType)):_Ewa.g.d(r.a)&&(_Ewa.g.g(r.a)||_Ewa.g.c(r.a,_Ewa.g.m())?(u=!0,f="CommunicationError",i=_Ewa.g.a(r.a),Diag.a.a(36304159,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',i,n.copyPasteTargetType)):_Ewa.g.c(r.a,_Ewa.dO.c)?(u=!0,f="SavingWorkbookError",i=_Ewa.g.a(r.a),Diag.a.a(36304160,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',i,n.copyPasteTargetType)):_Ewa.g.c(r.a,_Ewa.dO.a)&&(u=!0,s=!0,f="OperationSucceededWithAlert",i=_Ewa.g.a(r.a),Diag.a.a(36304161,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',i,n.copyPasteTargetType))):(u=!0,f="CopyPasteLengthTooLongPopup",i="The pasted content is too long. Popup a dialog to the user.",Diag.a.a(25216992,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',i,n.copyPasteTargetType),alert(_Ewa.b.a().b(6))))),u||Diag.a.a(24150916,0,10,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',e?JSON.stringify(e):"null",n.copyPasteTargetType),this.S(n,u,i,f,o,s,h),Promise.reject(t)},Y:function(n,t){Diag.a.a(24150917,0,50,'CopyPasteInfrastructure.OnPasteSuccess: paste succeed. copyPasteTargetType="{0}"',t.copyPasteTargetType);t.copyPasteTargetType===1&&this.bg(n.isExternalPaste,t.originalDestination,t.expandDestination);var i=this.o.getLastSuccessfulCopyOperation();return this.D("Paste/success/"+Common.j.a.toString(t.ribbonCommandInfo.b),n),this.T(n,i),Promise.resolve(!0)},D:function(n,t){var i,r,u,f;(u=this.M(t,r={val:i}),i=r.val,u)&&(f=this,this.c(n,i,!1,!1,t.commandParameters.copyPasteTargetType).catch(function(){}))},bc:function(){var n=this.s.a();n.a(!1,!1,!1,null)},bd:function(){var n=this.s.a();n.a(!0,!1,!1,null)},V:function(n,t,i,r,u){Diag.a.a(24150918,0,10,"CopyPasteInfrastructure.OnDragAndDropCellsFailed: {0}",n?JSON.stringify(n):"null");var e=!1,f=!1;return n&&_Ewa.g.d(n.a)&&(_Ewa.g.c(n.a,_Ewa.dO.a)&&(e=!0),_Ewa.g.c(n.a,_Ewa.dO.b)&&(f=!0)),f?this.p.a().r(-1):this.q.e(r),this.Q(t,i,r,f,e,u),Promise.reject(n)},C:function(n,t){var r=n,i=this.o.getLastSuccessfulCopyOperation(),u;return i&&_Ewa.pz.a(i.sourceItem)&&(u=i.sourceItem,r=this.q.f(t,u.a,n)),r},be:function(){this.cE("cpiOSC",null,null)},bg:function(n,t,i){if(!n){var r=this.p.a().a()===t;r?(this.J(i),Diag.a.a(24150919,0,50,"CopyPasteInfrastructure.SelectPastedRangeIfNeeded: select paste range, range: {0}",i)):Diag.a.a(24150920,0,50,"CopyPasteInfrastructure.SelectPastedRangeIfNeeded: user change his selection during paste operation. don't change selection. originalPasteDestination: {0}",t)}},M:function(n,t){var i,r;if(t.val=!0,n.isPlainTextPaste)return t.val=!1,!0;if(i=n.environment.getLastSuccessfulCopyOperation(),n.commandParameters.clearStateOnFinish)return!0;if(i&&_Ewa.pz.a(i.sourceItem)){if(r=i.sourceItem,!r.c(this.n))return!1;var u=i.commandParameters.ribbonCommandInfo.a===-1985798686,f=r.a,e=n.commandParameters.expandDestination,o=this.n.b().j().d(),s=r.b,h=s===o&&!!e.k(f);return u||h}return!1},bb:function(n,t){if(!t.a&&!t.c){var i=this;this.c("OnWorkbookOpened",!1,!1,!1,0).catch(function(){})}},U:function(n,t){var r=this.o.getLastSuccessfulCopyOperation(),i=this.q.b(r);i&&(t.a&&t.a.d()===i.b&&i.c(this.n)?this.q.c(i.a,r.commandParameters.commandType):this.q.a())},W:function(n,t){var r=this.o.getLastSuccessfulCopyOperation(),i=this.q.b(r),u;i&&t.a&&t.a.d()===i.b&&i.c(this.n)&&(u=this,this.c("OnItemDeleting",!1,!1,!1,0).catch(function(){}))},ba:function(n,t){var r=this.o.getLastSuccessfulCopyOperation(),i=this.q.b(r),u;i&&i.c(this.n)&&t.a.a().h(i.a)&&(u=this,this.c("OnStartEdit",!0,!1,!1,0).catch(function(){}))},Z:function(n,t){if(t.b===1&&t.a.a.b()&2){var i=this;this.c("OnQueueItemChanged/ItemRemoved",!1,!1,!1,0).catch(function(){})}}};_Ewa.sJ=function(){};_Ewa.sJ.prototype={a:null,getLastSuccessfulCopyOperation:function(){return this.a},setSuccessfulCopyOperation:function(n){this.a=n},makeSureSync:function(){return Promise.resolve(this)},clear:function(){this.a=null}};_Ewa.cW=function(n,t){this.l=n;this.m=t};_Ewa.cW.d=function(n,t,i,r,u,f,e,o,s){var h=n.d().a().b(),c=function(t,c){return n.E(),_Ewa.ho.a(n.d().a(),i,r,u,_Ewa.l.a(t,e),_Ewa.l.b(c,o),f,h,s)},l=new _Ewa.bf(0,c,1);n.h().a(l,t)};_Ewa.cW.b=function(n,t,i,r,u){_Ewa.g.d(n.Errors)?_Ewa.g.h(n.Errors)?(t&&(t.encounteredDeploymentErrors=!0),Diag.a.a(36538329,0,15,"CopyPasteUtils.HandlePasteServerResponse: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: {0}",_Ewa.g.a(n.Errors))):r(new _Ewa.bY(3,n.Errors)):i(u?u:!0)};_Ewa.cW.e=function(n,t,i,r,u,f,e,o){var s=n.d().a().b(),h=function(t,h){n.E();var c=_Ewa.cW.c(i,r);return _Ewa.hs.b(n.d().a(),c,_Ewa.l.a(t,f),_Ewa.l.b(h,e),u,s,o)},c=new _Ewa.bf(0,h,1);n.h().a(c,t)};_Ewa.cW.c=function(n,t){var i={};return i.ShadowWorkbookBase64=n.shadowWorkbookBase64,i.SourceRange={},i.SourceRange.FirstRow=n.rangeRowStart,i.SourceRange.LastRow=n.rangeRowEnd,i.SourceRange.FirstColumn=n.rangeColumnStart,i.SourceRange.LastColumn=n.rangeColumnEnd,i.DestinationRange=t,i.CopyPasteTargetType=1,i};_Ewa.cW.a=function(n,t,i){var r=i.e();return r.i()<t&&(r.d=Math.min(1048576,r.a+t-1)),r.j()<n&&(r.c=Math.min(16384,r.b+n-1)),r};_Ewa.cW.prototype={l:null,m:null,h:function(n,t,i,r,u){var f=_Ewa.i.a(n,this.l),e=this.l.d().a().b(),o=this,s=function(n,s){return _Ewa.ho.c(o.l.d().a(),f,_Ewa.l.a(n,i),r?_Ewa.l.b(s,r):s,t,e,u)};this.l.h().a(new _Ewa.bf(0,s,0),t)},j:function(n,t,i,r,u){var f=_Ewa.i.a(n,this.l),e=this.l.d().a().b(),o=this,s=function(n,s){var h={};return h.CopyPasteTargetType=1,h.SourceRange=f,_Ewa.hs.a(o.l.d().a(),h,_Ewa.l.a(n,i),r?_Ewa.l.b(s,r):s,t,e,u)};this.l.h().a(new _Ewa.bf(0,s,0),t)},k:function(n,t,i,r,u){var f=this;return new Promise(function(e,o){var s=function(n){_Ewa.cW.b(n,u,e,o,null)},h=function(n){var t=_Ewa.t.c(n.b);o(new _Ewa.bY(3,t))};_Ewa.cW.e(f.l,n,i,t,null,s,h,r)})},d:function(n,t,i,r,u,f,e){var o=this;return new Promise(function(s,h){var c=function(n){_Ewa.cW.b(n,e,s,h,null)},l=function(n){var t=_Ewa.t.c(n.b);h(new _Ewa.bY(3,t))},a=r,v=-5&u,y=a|v;_Ewa.cW.d(o.l,n,t,i,y,null,c,l,f)})},i:function(n,t,i,r,u){var f=this;return new Promise(function(e,o){var l;if(!t||(t=_Ewa.h.g(t,"\n","\r")),!t)e("");else if(t.length>102400)Diag.a.a(24150921,0,15,"CopyPasteInfrastructure.ProcessPasteText copy paste length too long. clipboardText.Length: {0}, MaxCopyPasteLength: {1}",t.length,102400),o(new _Ewa.bY(0,null));else{var s,h=_Ewa.i.a(n,f.l),a=!f.l.b().a()&&t.indexOf("\n")===-1&&t.indexOf("\t")===-1&&_Ewa.h.j(t),c=f.l.d().a().b();s=a?function(i,u){var s=_Ewa.l.a(i,function(n){n.Errors&&n.Errors.length>0?o(new _Ewa.bY(1,n.Errors)):e(t)}),l=_Ewa.l.b(u,function(n){var t=_Ewa.t.c(n.b);o(new _Ewa.bY(1,t))});return f.l.E(),_Ewa.f.c(f.l.d().a(),h,t,_Ewa.N.b(t,!0),!1,!1,63,s,l,n,c,r)}:function(n,i){f.l.E();var s=_Ewa.l.a(n,function(n){_Ewa.cW.b(n,u,e,o,t)}),l=_Ewa.l.b(i,function(n){var t=_Ewa.t.c(n.b);o(new _Ewa.bY(2,t))});return _Ewa.ho.b(f.l.d().a(),h,t,s,l,null,c,r)};l=new _Ewa.bf(0,s,1);f.l.h().a(l,i)}})},c:function(n,t){if(this.m.c().s()&16){var i=[t===1?5:6];this.m.g().c(i,null,null);this.m.g().b(n,i);this.m.g().h(!0,!0)}},a:function(){var n=[5,6];this.m.g().a(n);this.m.g().b(null,n);this.m.a().d()===1&&this.m.cu(!1)},f:function(n,t,i){var r;if(this.l.c(101)){if(36===n)return i.l()?_Ewa.cW.a(t.j(),t.i(),i):i.e();if(n===516){t=t.e();var u=t.i(),f=t.j(),e=t.a,o=t.b;t.d=Math.min(1048576,e+f-1);t.c=Math.min(16384,o+u-1)}var s=!(i.j()%t.j())&&!(i.i()%t.i()),h=i.G()&&!(i.j()%t.j()),c=i.F()&&!(i.i()%t.i());return t.o()&&t.j()===i.j()?(r=i.e(),r.a=1,r.d=1048576):t.n()&&t.i()===i.i()?(r=i.e(),r.b=1,r.c=16384):h||c?r=_Ewa.cW.a(t.j(),t.i(),i):s?r=i.e():(r=i.e(),r.d=Math.min(1048576,r.a+t.i()-1),r.c=Math.min(16384,r.b+t.j()-1)),r}return 516===n?_Ewa.cW.a(t.i(),t.j(),i):36!==n||i.l()?_Ewa.cW.a(t.j(),t.i(),i):i.e()},e:function(n){var t=this.m.a();this.m.g().e();t.e(n,n.g(),0,!0);t.r(-1)},b:function(n){if(n&&n.sourceItem){var t=n.sourceItem;if(t&&t.a)return t}return null},g:function(n,t){return(Diag.a.b(33863620,0,!!n,"CopyPasteUtils.IsFromKeyboardShortcut: commandInfo shouldn't be null"),t&&"SourceControlId"in t)?!1:n.c?!1:n.b===1}};_Ewa.mm=function(){this.k={"SourceItemType.Range":0,"SourceItemType.Art":1};this.d={};this.h={"FloatingObjectType.Unknown":99,"FloatingObjectType.CardView":6,"FloatingObjectType.Chart":0,"FloatingObjectType.Group":7,"FloatingObjectType.Image":1,"FloatingObjectType.InteractiveReport":4,"FloatingObjectType.ModernOfficeExtension":3,"FloatingObjectType.Shape":5,"FloatingObjectType.Slicer":2,"FloatingObjectType.Unsupported":100};this.e={"99":"FloatingObjectType.Unknown","6":"FloatingObjectType.CardView","0":"FloatingObjectType.Chart","7":"FloatingObjectType.Group","1":"FloatingObjectType.Image","4":"FloatingObjectType.InteractiveReport","3":"FloatingObjectType.ModernOfficeExtension","5":"FloatingObjectType.Shape","2":"FloatingObjectType.Slicer","100":"FloatingObjectType.Unsupported"};this.j={"RibbonCommand.Copy":-911352779,"RibbonCommand.Cut":-1985798686};this.f={"-911352779":"RibbonCommand.Copy","-1985798686":"RibbonCommand.Cut"};this.i={"InputManager.InputMethod.NotDefined":-1,"InputManager.InputMethod.Unknown":0,"InputManager.InputMethod.Keyboard":1,"InputManager.InputMethod.Mouse":2,"InputManager.InputMethod.Touch":3,"InputManager.InputMethod.CrossSlide":9};this.b={};this.g={"FrameMode.None":0,"FrameMode.Reading":1,"FrameMode.Edit":2};this.c={};this.m={"UILocation.Unknown":0,"UILocation.UpperRibbon":1,"UILocation.Ribbon":2,"UILocation.QAT":3,"UILocation.Jewel":4,"UILocation.NavigationPane":5,"UILocation.KeyboardShortcut":6,"UILocation.StatusBar":7,"UILocation.Dialog":8,"UILocation.Floatie":9,"UILocation.NotificationBar":10,"UILocation.StandaloneCuiRoot":11,"UILocation.TaskPane":12,"UILocation.HeroDock":13,"UILocation.ContextMenu":19,"UILocation.DialogMenu":20,"UILocation.Toolbar":26,"UILocation.Canvas":30};this.a={};this.b[Common.j.a.toString(-1)]="InputManager.InputMethod.NotDefined";this.b[Common.j.a.toString(0)]="InputManager.InputMethod.Unknown";this.b[Common.j.a.toString(1)]="InputManager.InputMethod.Keyboard";this.b[Common.j.a.toString(2)]="InputManager.InputMethod.Mouse";this.b[Common.j.a.toString(3)]="InputManager.InputMethod.Touch";this.b[Common.j.a.toString(9)]="InputManager.InputMethod.CrossSlide";this.c[Common.bf.toString(0)]="FrameMode.None";this.c[Common.bf.toString(1)]="FrameMode.Reading";this.c[Common.bf.toString(2)]="FrameMode.Edit";this.a[Common.B.toString(0)]="UILocation.Unknown";this.a[Common.B.toString(1)]="UILocation.UpperRibbon";this.a[Common.B.toString(2)]="UILocation.Ribbon";this.a[Common.B.toString(3)]="UILocation.QAT";this.a[Common.B.toString(4)]="UILocation.Jewel";this.a[Common.B.toString(5)]="UILocation.NavigationPane";this.a[Common.B.toString(6)]="UILocation.KeyboardShortcut";this.a[Common.B.toString(7)]="UILocation.StatusBar";this.a[Common.B.toString(8)]="UILocation.Dialog";this.a[Common.B.toString(9)]="UILocation.Floatie";this.a[Common.B.toString(10)]="UILocation.NotificationBar";this.a[Common.B.toString(11)]="UILocation.StandaloneCuiRoot";this.a[Common.B.toString(12)]="UILocation.TaskPane";this.a[Common.B.toString(13)]="UILocation.HeroDock";this.a[Common.B.toString(19)]="UILocation.ContextMenu";this.a[Common.B.toString(20)]="UILocation.DialogMenu";this.a[Common.B.toString(26)]="UILocation.Toolbar";this.a[Common.B.toString(30)]="UILocation.Canvas";this.d[_Ewa.ec.toString(0)]="SourceItemType.Range";this.d[_Ewa.ec.toString(1)]="SourceItemType.Art"};_Ewa.mm.a=function(n){return new _Ewa.n(n.top,n.left,n.bottom,n.right,!1,!1)};_Ewa.mm.prototype={v:function(n){var t,i,r;if(!n)return Diag.a.b(25216995,0,!1,"EnvironmentSerializationHelper.Serialize: copyContext shouldn't be null."),null;if(!n.commandParameters)return Diag.a.b(25217024,0,!1,"EnvironmentSerializationHelper.Serialize: copyContext.CommandParameters shouldn't be null."),null;if(t={},t.id=n.commandParameters.id,t.commandType=n.commandParameters.commandType,t.copyPasteTargetType=n.commandParameters.copyPasteTargetType,n.commandParameters.ribbonCommandInfo&&(t.ribbonCommandName=this.z(n.commandParameters.ribbonCommandInfo.a),t.inputMethodName=this.y(n.commandParameters.ribbonCommandInfo.b),t.frameModeName=this.x(n.commandParameters.ribbonCommandInfo.f),t.uiLocationName=this.A(n.commandParameters.ribbonCommandInfo.d),t.tabName=n.commandParameters.ribbonCommandInfo.c),Object.getType(n.sourceItem)===_Ewa.hU)i=n.sourceItem,t.sheetName=i.b,t.top=i.a.a,t.left=i.a.b,t.bottom=i.a.d,t.right=i.a.c,t.sessionStateId=i.e,t.sessionId=i.d,t.sourceItemType=this.l(0);else if(Object.getType(n.sourceItem)===_Ewa.ft)r=n.sourceItem,t.activeFloatingObjectControlId=r.a,t.sheetName=r.f,t.sessionStateId=r.e,t.sessionId=r.d,t.floatingObjectType=this.w(r.b),t.sourceItemType=this.l(1);else return Diag.a.b(25217025,0,!1,"EnvironmentSerializationHelper.Serialize: sourceItem shouldn't be null."),null;return JSON.stringify(t)},n:function(n){var t,i,r;if(!n)return null;try{if(t=JSON.parse(n),!t)return Diag.a.b(25217026,0,!1,"EnvironmentSerializationHelper.Deserialize: Json.Parse return null result."),null;i={};i.commandParameters={};i.commandParameters.id=t.id;i.commandParameters.ribbonCommandInfo=this.s(t);i.commandParameters.commandType=t.commandType;i.commandParameters.copyPasteTargetType=t.copyPasteTargetType;r=null;switch(this.t(t.sourceItemType)){case 0:r=new _Ewa.hU(_Ewa.mm.a(t),t.sheetName,t.sessionStateId,t.sessionId);break;case 1:r=new _Ewa.ft(t.activeFloatingObjectControlId,t.sheetName,t.sessionStateId,t.sessionId,this.o(t.floatingObjectType))}return i.sourceItem=r,i}catch(u){return Diag.a.a(25217027,0,10,"EnvironmentSerializationHelper.Deserialize: got exception while try to JSON.Parse string length: {0}, errror: {1}",n?n.length:0,u),null}},s:function(n){return new _Ewa.Z(this.r(n.ribbonCommandName),this.q(n.inputMethodName),this.p(n.frameModeName),this.u(n.uiLocationName),n.tabName)},z:function(n){return isNullOrUndefined(n)||!(n.toString()in this.f)?(Diag.a.b(25217028,0,!1,"EnvironmentSerializationHelper.SerializeRibbonCommand expected to get RibbonCommand.Copy({0}) or RibbonCommand.Cut({1}) but got {2}",-911352779,-1985798686,n),this.f["-911352779"]):this.f[n.toString()]},r:function(n){return!n||!(n in this.j)?(Diag.a.b(25217029,0,!1,"EnvironmentSerializationHelper.DeserializeRibbonCommand: expected to get RibbonCommand.Copy({0}) or RibbonCommand.Cut({1}) but got {2}",-911352779,-1985798686,n),-911352779):this.j[n]},y:function(n){return isNullOrUndefined(n)||!(Common.j.a.toString(n)in this.b)?(Diag.a.b(25217030,0,!1,"EnvironmentSerializationHelper.SerializeInputMethod: got unexpected value {0}",n),this.b[Common.j.a.toString(0)]):this.b[Common.j.a.toString(n)]},q:function(n){return!n||!(n in this.i)?(Diag.a.b(25217031,0,!1,"EnvironmentSerializationHelper.DeserializeInputMethod: got unexpected value {0}",n),0):this.i[n]},x:function(n){return isNullOrUndefined(n)||!(Common.bf.toString(n)in this.c)?(Diag.a.b(25217032,0,!1,"EnvironmentSerializationHelper.SerializeFrameMode: got unexpected value {0}",n),this.c[Common.bf.toString(2)]):this.c[Common.bf.toString(n)]},p:function(n){return!n||!(n in this.g)?(Diag.a.b(25217033,0,!1,"EnvironmentSerializationHelper.DeserializeFrameMode: got unexpected value {0}",n),2):this.g[n]},l:function(n){return isNullOrUndefined(n)||!(_Ewa.ec.toString(n)in this.d)?(Diag.a.b(25217034,0,!1,"EnvironmentSerializationHelper.SerializeSourceItemType: got unexpected value {0}",n),this.d[_Ewa.ec.toString(0)]):this.d[_Ewa.ec.toString(n)]},t:function(n){return!n||!(n in this.k)?(Diag.a.b(25217035,0,!1,"EnvironmentSerializationHelper.DeserializeSourceItemType: got unexpected value {0}",n),0):this.k[n]},w:function(n){return isNullOrUndefined(n)||!(n.toString()in this.e)?(Diag.a.b(36229127,0,!1,"EnvironmentSerializationHelper.SerializeArtSourceItemType: got unexpected value {0}",n),this.e["99"]):this.e[n.toString()]},o:function(n){return!n||!(n in this.h)?(Diag.a.b(36229128,0,!1,"EnvironmentSerializationHelper.DeserializeArtSourceItemType: got unexpected value {0}",n),99):this.h[n]},A:function(n){return isNullOrUndefined(n)||!(Common.B.toString(n)in this.a)?(Diag.a.b(36229129,0,!1,"EnvironmentSerializationHelper.SerializeUILocation: got unexpected value {0}",n),this.a[Common.B.toString(2)]):this.a[Common.B.toString(n)]},u:function(n){return!n||!(n in this.m)?(Diag.a.b(36229130,0,!1,"EnvironmentSerializationHelper.DeserializeUILocation: got unexpected value {0}",n),2):this.g[n]}};_Ewa.sL=function(n){this.a=n};_Ewa.sL.prototype={a:null,b:null,c:null,e:function(){if(!this.b){var n=this.a.a().a(_Ewa.cT,248);Diag.a.b(24679105,0,!!n,"ExcelCopyPasteApplicationHost.RangeCopyPasteHandler: copyPasteCallback should be null");this.b=_Ewa.bC.c(this.a)?new _Ewa.hn(this.a,n,new _Ewa.cW(this.a,_Ewa.c.a(this.a)),new _Ewa.jS,_Ewa.b.a(),null):new _Ewa.sN(this.a,n,new _Ewa.cW(this.a,_Ewa.c.a(this.a)),new _Ewa.jS,_Ewa.b.a(),null)}return this.b},d:function(){if(!this.c){var n=new _Ewa.iz(this.a);this.c=new _Ewa.sH(this.a,new _Ewa.jS,n,null)}return this.c},getCopyFlowHandler:function(){return this.f(_Ewa.c.a(this.a).bR())},getPasteFlowHandler:function(n){var t=_Ewa.bC.b(this.a)?n.environment.getLastSuccessfulCopyOperation():null;return!_Ewa.nA.a(n)&&t&&t.sourceItem&&Object.getType(t.sourceItem)===_Ewa.ft?this.d():this.e()},f:function(n){switch(n){case 1:return this.e();case 64:case 4:case 2:return this.d();default:throw Error.invalidOperation("Unsupported selection");}}};_Ewa.sN=function(n,t,i,r,u,f){_Ewa.sN.initializeBase(this,[n,t,i,r,u,f])};_Ewa.sN.prototype={serialize:function(n){var t=n.sourceItem,i={},r=this.d.b(t),u,e,f;if(r)i.synchronousResult=r,n.isFromCache=!0,n.clientSideCopyTime=n.commandParameters.stopwatch.d();else if(this.l(t.a)){Diag.a.a(24150922,0,50,"RangeCopyPasteHandler.Serialize: All data is loaded prepare the data in the client side.");u=this.f.a(t.a);try{e=u.toString();r=this.c.a();r.setItem("text/plain",e);this.d.a(t,r);i.synchronousResult=r;n.clientSideCopyTime=n.commandParameters.stopwatch.d()}finally{u&&u.dispose()}}else n.isAsyncCopy=!0,i.synchronousResult=this.c.a(),i.synchronousResult.setItem("text/plain",this.h()),f=this,i.asynchronousResult=new Promise(function(i,r){var u=function(u){var e,o;if(_Ewa.g.d(u.Errors))Diag.a.a(24150924,0,10,"RangeCopyPasteHandler.Serialize: LoadClipboardFromServer failed. errors: {0}",_Ewa.g.a(u.Errors)),r(new _Ewa.ff(0,u.Errors));else{if(Diag.a.a(24150923,0,50,"RangeCopyPasteHandler.Serialize: LoadClipboardFromServer succeed."),n.markForCancellation){r(new _Ewa.ff(2,u.Errors));return}e=u.Result;isNullOrUndefined(e)||(n.plainTextPayloadSize=e.length);o=f.c.a();o.setItem("text/plain",e);f.d.a(t,o);i(o)}},e=function(n){var t=_Ewa.t.c(n.b);Diag.a.a(24150925,0,10,"RangeCopyPasteHandler.Serialize: LoadClipboardFromServer failed. errors: {0}",_Ewa.g.a(t));r(new _Ewa.ff(0,t))};Diag.a.a(24150926,0,50,"RangeCopyPasteHandler.Serialize: issue request to the server to get the copied data...");f.b.h(t.a,n.commandParameters.ribbonCommandInfo,u,e,[n.commandParameters.stopwatch])});return i},deserialize:function(n){var u,t,f,i,r,e;return _Ewa.iB.a(n,1),u=n.environment.getLastSuccessfulCopyOperation(),t=this.b.b(u),t?(n.isSameSession=!0,Diag.a.a(24150927,0,50,"RangeCopyPasteHandler.Deserialize: trigger PasteRange request..."),f=_Ewa.i.a(t.a,this.a),f.SheetName=t.b,n.commandParameters.ribbonCommandInfo.a===1804571062&&this.g.b(n,t.a,t.b,n.commandParameters.expandDestination,this.a.b().j().d(),u.commandParameters.commandType===1),i=n.commandParameters.originalDestination,(t.a.o()&&t.a.j()===i.j()||t.a.n()&&t.a.i()===i.i())&&(i=n.commandParameters.expandDestination),this.b.d(n.commandParameters.ribbonCommandInfo,f,_Ewa.i.a(i,this.a),u.commandParameters.commandType,n.commandParameters.commandType,[n.commandParameters.stopwatch],n)):n.isClipboardInaccessible?Promise.reject(new _Ewa.bY(6,null)):n.commandParameters.commandType!==516&&n.commandParameters.commandType!==36?(Diag.a.a(24150928,0,50,"RangeCopyPasteHandler.Deserialize: trigger ProcessPasteText request..."),r=n.clipboardItems.getItem("text/plain"),e=r===this.h(),e?Promise.reject(new _Ewa.bY(5,null)):(isNullOrUndefined(r)||(n.plainTextPayloadSize=r.length),this.b.i(n.commandParameters.originalDestination,r,n.commandParameters.ribbonCommandInfo,[n.commandParameters.stopwatch],n))):Promise.reject(new _Ewa.bY(4,null))}};_Ewa.mn=function(n){this.d=Function.createDelegate(this,this.Q);_Ewa.mn.initializeBase(this,[n,null])};_Ewa.mn.a=function(){return{ShiftCellsRight:!1,ShiftCellsDown:!0}};_Ewa.mn.prototype={a:null,e:null,N:null,O:function(n){this.q=_Ewa.jT.b(n);this.a=new($$sc.A.$$(_Ewa.jE));var t=_Ewa.b.a().a(15),i=_Ewa.mn.a();return this.t(t,this.d,i),this.P(),this.a.a},Q:function(n,t){if(n===1){var i=1;t.ShiftCellsRight&&(i=0);Diag.a.a(25518408,0,50,"InsertCopiedCutDialog OK button pressed with valid input, shift direction = {0}",i?"Vertical":"Horizontal");this.a.b(i)}else Diag.a.a(25518409,0,50,"ColorSheetDialog cancel button pressed"),this.j(),this.a.d()},P:function(){this.e=document.getElementById("ShiftCellsDown");this.N=document.getElementById("ShiftCellsRight")}};_Ewa.sM=function(){};_Ewa.sM.prototype={a:function(n,t){var i=new _Ewa.mn(n);return i.O(t)}};_Ewa.wX=function(){};_Ewa.wX.a=function(n,t,i,r,u,f){var e=n.a(9,f);return e.insertCopiedCutCellsParameters=t,_Ewa.f.a(n,"InsertCopiedCutCells",e,i,r,u,4,null)};_Ewa.hs=function(){};_Ewa.hs.a=function(n,t,i,r,u,f,e){var o=n.a(1,f);return o.copyParameters=t,_Ewa.f.a(n,"Copy",o,i,r,u,0,e)};_Ewa.hs.c=function(n,t,i,r,u,f,e){var o=n.a(1,f);return o.copyParameters=t,_Ewa.f.a(n,"Cut",o,i,r,u,0,e)};_Ewa.hs.b=function(n,t,i,r,u,f,e){var o=n.a(1,f);return o.pasteParameters=t,_Ewa.f.a(n,"Paste",o,i,r,u,64,e)};_Ewa.iA.registerClass("_Ewa.iA",_Ewa.Es,_Ewa.gP,_Ewa.hN,Sys.IDisposable);_Ewa.iA.d.registerClass("_Ewa.iA.d");_Ewa.CQ.registerClass("_Ewa.CQ");_Ewa.hn.registerClass("_Ewa.hn",_Ewa.CQ);_Ewa.mj.registerClass("_Ewa.mj",_Ewa.Q);_Ewa.sI.registerClass("_Ewa.sI",null,Sys.IDisposable);_Ewa.ml.registerClass("_Ewa.ml",_Ewa.lg.$$(_Ewa.cT));_Ewa.dO.registerClass("_Ewa.dO",_Ewa.co,_Ewa.cT,_Ewa.FY,Sys.IDisposable);_Ewa.sN.registerClass("_Ewa.sN",_Ewa.CQ);_Ewa.mn.registerClass("_Ewa.mn",_Ewa.DL);_Ewa.jT.a="<div class='WACDialogRow' id='labelRow'> <label id='labelId' class='WACDialogLabel' >{0}<\/label> <\/div> <div class='WACDialogRowNoBreak' id='RightRow'> <input type='radio' id='ShiftCellsRight' name='ShiftOptions' class='WACDialogRadio' alt='{1}' title='{1}'><\/input> <label id='ShiftRight' class='WACDialogLabel' for='ShiftCellsRight' >{1}<\/label> <\/div> <div class='WACDialogRowNoBreak' id='DownRow'> <input type='radio' id='ShiftCellsDown' name='ShiftOptions' class='WACDialogRadio' alt='{2}' title='{2}'><\/input> <label id='ShiftDown' class='WACDialogLabel' for='ShiftCellsDown' >{2}<\/label> <\/div>";_Ewa.dO.c=[308];_Ewa.dO.a=[313];_Ewa.dO.b=[156];Type.registerNamespace("_Ewa");_Ewa.CR=function(){};_Ewa.CR.a=function(){_Ewa.e.a(function(n){_Ewa.bC.a(n)?_Ewa.ml.a(n):(n.a().b(_Ewa.hN,6,new _Ewa.iA(_Ewa.c.a(n),n.a().a(_Ewa.mr,7),n.a().a(_Ewa.jW,164),null)),n.H(),_Ewa.mj.a(n))})};_Ewa.CR.a();